<!DOCTYPE html>
<!-- this file is auto-generated from webgl/lessons/ko/webgl-3d-perspective.md. Do not edited directly -->
<!--
Copyright 2021 GFXFundamentals.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are
met:

*   Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.

*   Redistributions in binary form must reproduce the above
    copyright notice, this list of conditions and the following disclaimer
    in the documentation and/or other materials provided with the
    distribution.

*   Neither the name of GFXFundamentals. nor the names of his
    contributors may be used to endorse or promote products derived from
    this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-->
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="WebGL에서 3D로 원근을 표시하는 방법">
<meta name="keywords" content="webgl graphics">
<meta name="thumbnail" content="https://webglfundamentals.org/webgl/lessons/screenshots/webgl-3d-perspective_ko.jpg">

<meta property="og:title" content="WebGL 3D 원근법">
<meta property="og:type" content="website">
<meta property="og:image" content="https://webglfundamentals.org/webgl/lessons/screenshots/webgl-3d-perspective_ko.jpg">
<meta property="og:description" content="WebGL에서 3D로 원근을 표시하는 방법">
<meta property="og:url" content="https://webglfundamentals.org/webgl/lessons/ko/webgl-3d-perspective.html">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@greggman">
<meta name="twitter:creator" content="@greggman">
<meta name="twitter:domain" content="webglfundamentals.org">
<meta name="twitter:title" content="WebGL 3D 원근법">
<meta name="twitter:url" content="https://webglfundamentals.org/webgl/lessons/ko/webgl-3d-perspective.html">
<meta name="twitter:description" content="WebGL에서 3D로 원근을 표시하는 방법">
<meta name="twitter:image:src" content="https://webglfundamentals.org/webgl/lessons/screenshots/webgl-3d-perspective_ko.jpg">

<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@graph":[
    {
      "@type":"WebSite",
      "@id":"https://webglfundamentals.org/#website",
      "url":"https://webglfundamentals.org/",
      "name":"WebglFundamentals"
    },
    {
      "@type":"ImageObject",
      "@id":"https://webglfundamentals.org/webgl/lessons/ko/webgl-3d-perspective.html#primaryimage",
      "url":"https://webglfundamentals.org/webgl/lessons/screenshots/webgl-3d-perspective_ko.jpg",
      "width":1200,
      "height":630
    },
    {
      "@type":"WebPage",
      "@id":"https://webglfundamentals.org/webgl/lessons/ko/webgl-3d-perspective.html#webpage",
      "url":"https://webglfundamentals.org/webgl/lessons/ko/webgl-3d-perspective.html",
      "inLanguage":"ko",
      "name":"WebGL 3D 원근법",
      "keywords":"webgl graphics programming",
      "isPartOf":{
        "@id":"https://webglfundamentals.org/#website"
      },
      "primaryImageOfPage":{
        "@id":"https://webglfundamentals.org/webgl/lessons/ko/webgl-3d-perspective.html#primaryimage"
      }
    }
  ]
}
</script>


<title>WebGL 3D 원근법</title>
<link href="/webgl/lessons/resources/webglfundamentals-icon.png" rel="shortcut icon" type="image/png">
<link rel="stylesheet" href="/webgl/lessons/lang.css">
<link rel="stylesheet" href="/webgl/lessons/ko/lang.css">
<link rel="stylesheet" href="/webgl/lessons/resources/lesson.css">

  <link rel="alternate" hreflang="en" href="https://webglfundamentals.org/webgl/lessons/webgl-3d-perspective.html">
  <link rel="alternate" hreflang="fr" href="https://webglfundamentals.org/webgl/lessons/fr/webgl-3d-perspective.html">
  <link rel="alternate" hreflang="ja" href="https://webglfundamentals.org/webgl/lessons/ja/webgl-3d-perspective.html">
  <link rel="alternate" hreflang="ko" href="https://webglfundamentals.org/webgl/lessons/ko/webgl-3d-perspective.html">
  <link rel="alternate" hreflang="pl" href="https://webglfundamentals.org/webgl/lessons/pl/webgl-3d-perspective.html">
  <link rel="alternate" hreflang="pt-br" href="https://webglfundamentals.org/webgl/lessons/pt-br/webgl-3d-perspective.html">
  <link rel="alternate" hreflang="ru" href="https://webglfundamentals.org/webgl/lessons/ru/webgl-3d-perspective.html">
  <link rel="alternate" hreflang="zh_cn" href="https://webglfundamentals.org/webgl/lessons/zh_cn/webgl-3d-perspective.html">




</head>
<body>
<div class="webgl_navbar">
  <div>
    <select class="language">
    <option value="/webgl/lessons/webgl-3d-perspective.html" >English</a>
    <option value="/webgl/lessons/fr/webgl-3d-perspective.html" >Français</a>
    <option value="/webgl/lessons/ja/webgl-3d-perspective.html" >日本語</a>
    <option value="/webgl/lessons/ko/webgl-3d-perspective.html" selected>한국어</a>
    <option value="/webgl/lessons/pl/webgl-3d-perspective.html" >Polski</a>
    <option value="/webgl/lessons/pt-br/webgl-3d-perspective.html" >Portuguese</a>
    <option value="/webgl/lessons/ru/webgl-3d-perspective.html" >Русский</a>
    <option value="/webgl/lessons/zh_cn/webgl-3d-perspective.html" >简体中文</a>
</select>


    <a href="#toc">목차</a>
  </div>
</div>
<div class="webgl_header">
  <h1><a href="/webgl/lessons/ko/">WebGLFundamentals.org</a></h1>
<style>
#forkongithub>div {
    background: #000;
    color: #fff;
    font-family: arial,sans-serif;
    text-align: center;
    font-weight: bold;
    padding: 5px 40px;
    font-size: 0.9rem;
    line-height: 1.3rem;
    position: relative;
    transition: 0.5s;
    display: block;
    width: 400px;
    position: absolute;
    top: 0;
    right: 0;
    transform: translateX(200px) rotate(45deg) translate(10px,70px);
    box-shadow: 4px 4px 10px rgba(0,0,0,0.8);
    pointer-events: auto;
}
#forkongithub a {
  text-decoration: none;
  color: #fff;
}
#forkongithub>div:hover {
    background: #c11;
    color: #fff;
}
#forkongithub .contributors {
  font-size: 0.75rem;
  background: rgba(255,255,255,0.2);
  line-height: 1.2;
  padding: 0.1em;
}
#forkongithub>div::before,#forkongithub>div::after {
    content: "";
    width: 100%;
    display: block;
    position: absolute;
    top: 1px;
    left: 0;
    height: 1px;
    background: #fff;
}
#forkongithub>div::after {
    bottom: 1px;
    top: auto;
}

#forkongithub{
    z-index: 9999;
    /* needed for firefox */
    overflow: hidden;
    width: 300px;
    height: 300px;
    position: absolute;
    right: 0;
    top: 0;
    pointer-events: none;
}
#forkongithub svg{
  width: 1em;
  height: 1em;
  vertical-align: middle;
}
#forkongithub img {
  width: 1em;
  height: 1em;
  border-radius: 100%;
  vertical-align: middle;
}

@media (max-width: 900px) {
    #forkongithub>div {
        line-height: 1.2rem;
    }
}
@media (max-width: 700px) {
  #forkongithub {
    display: none;
  }
}
@media (max-width: 410px) {
    #forkongithub>div {
        font-size: 0.7rem;
        transform: translateX(150px) rotate(45deg) translate(20px,40px);
    }
}

</style>
<div id="forkongithub"><div><div><a href="https://github.com/gfxfundamentals/webgl-fundamentals">Fix, Fork, Contribute <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 136 133" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(3.92891,0,0,3.92891,67.867,129.125)">
        <path d="M0,-31.904C-8.995,-31.904 -16.288,-24.611 -16.288,-15.614C-16.288,-8.417 -11.621,-2.312 -5.148,-0.157C-4.333,-0.008 -4.036,-0.511 -4.036,-0.943C-4.036,-1.329 -4.05,-2.354 -4.058,-3.713C-8.589,-2.729 -9.545,-5.897 -9.545,-5.897C-10.286,-7.779 -11.354,-8.28 -11.354,-8.28C-12.833,-9.29 -11.242,-9.27 -11.242,-9.27C-9.607,-9.155 -8.747,-7.591 -8.747,-7.591C-7.294,-5.102 -4.934,-5.821 -4.006,-6.238C-3.858,-7.29 -3.438,-8.008 -2.972,-8.415C-6.589,-8.826 -10.392,-10.224 -10.392,-16.466C-10.392,-18.244 -9.757,-19.698 -8.715,-20.837C-8.883,-21.249 -9.442,-22.905 -8.556,-25.148C-8.556,-25.148 -7.188,-25.586 -4.076,-23.478C-2.777,-23.84 -1.383,-24.02 0.002,-24.026C1.385,-24.02 2.779,-23.84 4.08,-23.478C7.19,-25.586 8.555,-25.148 8.555,-25.148C9.444,-22.905 8.885,-21.249 8.717,-20.837C9.761,-19.698 10.392,-18.244 10.392,-16.466C10.392,-10.208 6.583,-8.831 2.954,-8.428C3.539,-7.925 4.06,-6.931 4.06,-5.411C4.06,-3.234 4.04,-1.477 4.04,-0.943C4.04,-0.507 4.333,0 5.16,-0.159C11.628,-2.318 16.291,-8.419 16.291,-15.614C16.291,-24.611 8.997,-31.904 0,-31.904" style="fill:white;"/>
    </g>
</svg>
</a></div></div></div>

</div>


<div class="container">
  <div class="lesson-title">
    <h1>WebGL 3D 원근법</h1>
  </div>
  <div class="lesson">
    <div class="lesson-main">
      <p>이 포스트는 WebGL 관련 시리즈에서 이어집니다.
첫 번째는 <a href="webgl-fundamentals.html">기초</a>로 시작했고, 이전에는 <a href="webgl-3d-orthographic.html">3D 기초</a>에 관한 것이었습니다.
아직 읽지 않으셨다면 해당 글들을 먼저 읽어주세요.</p>
<p>지난 포스트에서 어떻게 3D를 하는지 살펴봤지만 해당 3D는 어떤 원근도 가지지 않았는데요.
&quot;직교&quot;라 불리는 방법을 사용했는데 이건 사람들이 &quot;3D&quot;를 말할 때 일반적으로 원하는 게 아닙니다.</p>
<p>대신에 원근을 추가해야 합니다.
원근이란 뭘까요?
기본적으로 더 멀리 있는 것들이 더 작게 보이는 기능입니다.</p>
<p><img class="webgl_center noinvertdark" width="500" src="../resources/perspective-example.svg" /></p>
<p>위 예시를 보면 더 멀리 있는 것들이 더 작게 그려지는 걸 볼 수 있습니다.
주어진 현재 샘플에서 더 멀리 있는 것들이 더 작게 보이도록 만드는 쉬운 방법은 clip space의 X와 Y를 Z로 나누는 겁니다.</p>
<p>(10, 15)에서 (20,15)까지 길이가 10인 선이 있다고 생각해보세요.
현재 샘플에서 이건 10px의 길이로 그려질 겁니다.
하지만 Z로 나눈다면</p>
<pre class="webgl_center">
10 / 1 = 10
20 / 1 = 20
abs(10-20) = 10
</pre>

<p>Z가 1일 경우 길이는 10px이 됩니다.</p>
<pre class="webgl_center">
10 / 2 = 5
20 / 2 = 10
abs(5 - 10) = 5
</pre>

<p>Z가 2일 경우에는 5px이 되죠.</p>
<pre class="webgl_center">
10 / 3 = 3.333
20 / 3 = 6.666
abs(3.333 - 6.666) = 3.333
</pre>

<p>Z가 증가할수록, 멀어질수록, 더 작게 그려지는 걸 볼 수 있습니다.
Clip space에서 나누면 Z가 더 작은 숫자(-1 ~ +1)이기 때문에 더 나은 결과를 얻을 수 있는데요.
나누기 전에 Z를 fudgeFactor와 곱하면 주어진 거리에 따라 얼마나 작게 할지 조정할 수 있습니다.</p>
<p>한 번 해봅시다.
먼저 &quot;fudgeFactor&quot;를 곱한 뒤 Z로 나누도록 vertex shader를 수정합니다.</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">&lt;script id=&quot;vertex-shader-3d&quot; type=&quot;x-shader/x-vertex&quot;&gt;
...
+uniform float u_fudgeFactor;
...
void main() {
  // 위치를 행렬로 곱하기
  vec4 position = u_matrix * a_position;

+  // 나누려는 z 조정
+  float zToDivideBy = 1.0 + position.z * u_fudgeFactor;

*  // x와 y를 z로 나누기
*  gl_Position = vec4(position.xy / zToDivideBy, position.zw);
}
&lt;/script&gt;
</code></pre><p>참고로 Z가 -1에서 +1인 clip space에 있기 때문에, 0에서 +2 * fudgeFactor인 <code class="notranslate" translate="no">zToDivideBy</code>를 얻기 위해 1을 더했습니다.</p>
<p>또한 fudgeFactor를 설정할 수 있도록 코드를 업데이트해야 합니다.</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">  ...
  var fudgeLocation = gl.getUniformLocation(program, &quot;u_fudgeFactor&quot;);

  ...
  var fudgeFactor = 1;
  ...
  function drawScene() {
    ...
    // fudgeFactor 설정
    gl.uniform1f(fudgeLocation, fudgeFactor);

    // Geometry 그리기
    var primitiveType = gl.TRIANGLES;
    var offset = 0;
    var count = 16 * 6;
    gl.drawArrays(primitiveType, offset, count);
</code></pre><p>그리고 여기 결과입니다.</p>
<p><div class="webgl_example_container">
  <iframe class="webgl_example" style=" " src="/webgl/resources/editor.html?url=/webgl/lessons/..%2Fwebgl-3d-perspective.html"></iframe>
  <a class="webgl_center" href="/webgl/lessons/../webgl-3d-perspective.html" target="_blank">새 창을 열려면 여기를 클릭</a>
</div>

</p>
<p>알아보기 힘들다면 Z로 나누는 코드를 추가하기 전 어떤 모습이었는지 보기 위해 &quot;fudgeFactor&quot; 슬라이더를 1.0에서 0.0으로 드래그해보세요.</p>
<p><img class="webgl_center" src="../resources/orthographic-vs-perspective.png" /></p>
<div class="webgl_center">직교법 vs 원근법</div>

<p>WebGL은 vertex shader의 <code class="notranslate" translate="no">gl_Position</code>에 할당한 x,y,z,w 값을 가져와 자동으로 w로 나눕니다.</p>
<p>이는 shader를 변경하여 직접 나누는 대신, <code class="notranslate" translate="no">gl_Position.w</code>에 <code class="notranslate" translate="no">zToDivideBy</code>를 넣어서 쉽게 증명할 수 있습니다.</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">&lt;script id=&quot;vertex-shader-2d&quot; type=&quot;x-shader/x-vertex&quot;&gt;
...
uniform float u_fudgeFactor;
...
void main() {
  // 위치를 행렬로 곱하기
  vec4 position = u_matrix * a_position;

  // 나누려는 z 조정
  float zToDivideBy = 1.0 + position.z * u_fudgeFactor;

  // x, y, z를 zToDivideBy로 나누기
*  gl_Position = vec4(position.xyz, zToDivideBy);

  // Fragment shader로 color 전달
  v_color = a_color;
}
&lt;/script&gt;
</code></pre><p>그리고 얼마나 정확하게 일치하는지 봅시다.</p>
<p><div class="webgl_example_container">
  <iframe class="webgl_example" style=" " src="/webgl/resources/editor.html?url=/webgl/lessons/..%2Fwebgl-3d-perspective-w.html"></iframe>
  <a class="webgl_center" href="/webgl/lessons/../webgl-3d-perspective-w.html" target="_blank">새 창을 열려면 여기를 클릭</a>
</div>

</p>
<p>WebGL이 자동으로 W로 나눈다는 사실이 유용한 이유는 뭘까요? 
그 이유는 이제 더 많은 행렬을 사용하여 z를 w에 복사하기 위해 또 다른 행렬을 사용할 수 있기 때문입니다.</p>
<p>이런 행렬이 z를 w에 복사할 겁니다.</p>
<div class="webgl_math_center"><pre class="webgl_math">
1, 0, 0, 0,
0, 1, 0, 0,
0, 0, 1, 1,
0, 0, 0, 0,
</pre></div>

<p>각 열을 다음과 같이 볼 수 있으며</p>
<div class="webgl_math_center"><pre class="webgl_math">
x_out = x_in * 1 +
        y_in * 0 +
        z_in * 0 +
        w_in * 0 ;

y_out = x_in * 0 +
        y_in * 1 +
        z_in * 0 +
        w_in * 0 ;

z_out = x_in * 0 +
        y_in * 0 +
        z_in * 1 +
        w_in * 0 ;

w_out = x_in * 0 +
        y_in * 0 +
        z_in * 1 +
        w_in * 0 ;
</pre></div>

<p>이를 단순화하면</p>
<div class="webgl_math_center"><pre class="webgl_math">
x_out = x_in;
y_out = y_in;
z_out = z_in;
w_out = z_in;
</pre></div>

<p>우리는 <code class="notranslate" translate="no">w_in</code>이 항상 1.0이라는 걸 알기 때문에 이전에 가졌던 +1을 이 행렬에 추가할 수 있습니다.</p>
<div class="webgl_math_center"><pre class="webgl_math">
1, 0, 0, 0,
0, 1, 0, 0,
0, 0, 1, 1,
0, 0, 0, 1,
</pre></div>

<p>다음과 같이 W 계산이 바뀌고</p>
<div class="webgl_math_center"><pre class="webgl_math">
w_out = x_in * 0 +
        y_in * 0 +
        z_in * 1 +
        w_in * 1 ;
</pre></div>

<p><code class="notranslate" translate="no">w_in</code> = 1.0임을 알기 때문에</p>
<div class="webgl_math_center"><pre class="webgl_math">
w_out = z_in + 1;
</pre></div>

<p>마지막으로 행렬이 다음과 같으면 fudgeFactor을 다시 사용할 수 있는데</p>
<div class="webgl_math_center"><pre class="webgl_math">
1, 0, 0, 0,
0, 1, 0, 0,
0, 0, 1, fudgeFactor,
0, 0, 0, 1,
</pre></div>

<p>이게 의미하는 건</p>
<div class="webgl_math_center"><pre class="webgl_math">
w_out = x_in * 0 +
        y_in * 0 +
        z_in * fudgeFactor +
        w_in * 1 ;
</pre></div>

<p>그리고 단순화해서</p>
<div class="webgl_math_center"><pre class="webgl_math">
w_out = z_in * fudgeFactor + 1;
</pre></div>

<p>이제 행렬만 사용하도록 다시 프로그램을 수정해봅시다.</p>
<p>먼저 vertex shader를 되돌립니다.</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">&lt;script id=&quot;vertex-shader-2d&quot; type=&quot;x-shader/x-vertex&quot;&gt;
uniform mat4 u_matrix;

void main() {
  // 위치를 행렬로 곱하기
  gl_Position = u_matrix * a_position;
  ...
}
&lt;/script&gt;
</code></pre><p>다음으로 Z &rarr; W 행렬을 만드는 함수를 만들어 봅시다.</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">function makeZToWMatrix(fudgeFactor) {
  return [
    1, 0, 0, 0,
    0, 1, 0, 0,
    0, 0, 1, fudgeFactor,
    0, 0, 0, 1,
  ];
}
</code></pre><p>그리고 그걸 사용하도록 코드를 변경할 겁니다.</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">    ...
    // 행렬 계산
*    var matrix = makeZToWMatrix(fudgeFactor);
*    matrix = m4.multiply(matrix, m4.projection(gl.canvas.clientWidth, gl.canvas.clientHeight, 400));
    matrix = m4.translate(matrix, translation[0], translation[1], translation[2]);
    matrix = m4.xRotate(matrix, rotation[0]);
    matrix = m4.yRotate(matrix, rotation[1]);
    matrix = m4.zRotate(matrix, rotation[2]);
    matrix = m4.scale(matrix, scale[0], scale[1], scale[2]);

    ...
</code></pre><p>그리고 다시 말하지만 정확하게 일치합니다.</p>
<p><div class="webgl_example_container">
  <iframe class="webgl_example" style=" " src="/webgl/resources/editor.html?url=/webgl/lessons/..%2Fwebgl-3d-perspective-w-matrix.html"></iframe>
  <a class="webgl_center" href="/webgl/lessons/../webgl-3d-perspective-w-matrix.html" target="_blank">새 창을 열려면 여기를 클릭</a>
</div>

</p>
<p>기본적으로 모든 내용들은 Z로 나누는 게 원근을 준다는 것과 WebGL이 편리하게 Z로 나누는 작업을 해준다는 걸 보여주기 위한 겁니다.</p>
<p>하지만 여전히 몇 가지 문제가 있습니다.
예를 들어 Z를 -100 정도로 설정하면 아래와 같은 애니메이션을 보게 됩니다.</p>
<p><img class="webgl_center" src="../resources/z-clipping.gif" style="border: 1px solid black;" /></p>
<p>어떻게 된거죠?
F가 일찍 사라지는 이유는 뭘까요?
WebGL은 X와 Y 혹은 +1에서 -1까지 자르는 것처럼 Z도 제한하는데요.
여기서 우리가 보고 있는 건 Z &lt; -1 입니다.</p>
<p>이를 해결하기 위해 수학에 대한 자세한 설명을 할 수도 있지만 <a href="https://stackoverflow.com/a/28301213/128511">2D 투영을 했던 것과 같은 방법</a>으로 도출할 수도 있습니다.
Z를 가져오고, 약간을 더하고, 어느정도 크기를 조정해야 하며, 원하는 범위를 -1에서 +1사이로 다시 매핑할 수 있습니다.</p>
<p>멋진 점은 이 모든 단계를 하나의 행렬로 수행할 수 있다는 겁니다.
더 좋은 건 <code class="notranslate" translate="no">fudgeFactor</code>보다는 <code class="notranslate" translate="no">fieldOfView</code>로 결정하고, 이를 위한 올바른 값을 계산하는 겁니다.</p>
<p>다음은 행렬을 만드는 함수입니다.</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">var m4 = {
  perspective: function(fieldOfViewInRadians, aspect, near, far) {
    var f = Math.tan(Math.PI * 0.5 - 0.5 * fieldOfViewInRadians);
    var rangeInv = 1.0 / (near - far);

    return [
      f / aspect, 0, 0, 0,
      0, f, 0, 0,
      0, 0, (near + far) * rangeInv, -1,
      0, 0, near * far * rangeInv * 2, 0
    ];
  },

  ...
</code></pre><p>이 행렬이 모든 변환을 수행할 겁니다.
단위가 clip space 안에 있도록 조정되며, 각도별로 시야각을 선택할 수 있고, Z-clipping space를 선택할 수 있게 되는데요.
원점(0, 0, 0)에 <em>눈</em>이나 <em>카메라</em>가 있다고 가정하고, <code class="notranslate" translate="no">zNear</code>와 <code class="notranslate" translate="no">fieldOfView</code>가 주어지면, <code class="notranslate" translate="no">zNear</code>의 항목이 <code class="notranslate" translate="no">Z = -1</code>이 되는데 필요한 값을 계산하며, 중심에서 위나 아래로 <code class="notranslate" translate="no">fieldOfView</code>의 절반인 <code class="notranslate" translate="no">zNear</code>의 항목은 각각 <code class="notranslate" translate="no">Y = -1</code>과 <code class="notranslate" translate="no">Y = 1</code>로 끝납니다.
전달된 <code class="notranslate" translate="no">aspect</code>를 곱하여 X에 사용할 값을 계산하는데요.
일반적으로 디스플레이 영역의 <code class="notranslate" translate="no">width / height</code>로 설정합니다.
마지막으로 <code class="notranslate" translate="no">zFar</code>의 항목이 <code class="notranslate" translate="no">Z = 1</code>이 되도록 하기 위해 Z에서 얼마나 크기를 조정할지 알아냅니다.</p>
<p>다음은 실행중인 행렬의 다이어그램입니다.</p>
<p><div class="webgl_example_container">
  <iframe class="webgl_example" style="width:  400px; height: 600px;" src="/webgl/resources/editor.html?url=/webgl/lessons/..%2Ffrustum-diagram.html"></iframe>
  <a class="webgl_center" href="/webgl/lessons/../frustum-diagram.html" target="_blank">새 창을 열려면 여기를 클릭</a>
</div>

</p>
<p>내부에서 큐브가 회전하고 있는 4면 원뿔 모양을 &quot;절두체&quot;라고 합니다.
행렬은 절두체 안에 있는 공간을 가져와서 clip space로 변환하는데요.
<code class="notranslate" translate="no">zNear</code>은 물체의 앞쪽이 잘리는 곳을 정의하고, <code class="notranslate" translate="no">zFar</code>은 물체의 뒤쪽이 잘리는 곳을 정의합니다.
<code class="notranslate" translate="no">zNear</code>을 23으로 설정하면 회전하는 큐브의 앞면이 잘리는 걸 볼 수 있죠.
<code class="notranslate" translate="no">zFar</code>을 24로 설정하면 큐브의 뒷면이 잘리는 걸 볼 수 있습니다.</p>
<p>이제 남은 문제는 단 하나입니다.
이 행렬은 0,0,0에 뷰어가 있다고 가정하고, -Z 방향으로 바라보며 +Y가 위를 향하고 있다고 가정하는데요.
지금까지의 행렬은 다른 방식으로 작업을 수행했습니다.</p>
<p>이걸 보이게 하려면 절두체 안으로 옮겨야 합니다.
F를 움직이면 되는데요.
기존에는 (45, 150, 0)에 그리고 있었습니다.
(-150, 0, -360)로 옮기고 오른쪽이 위로 보이도록 rotation을 설정합시다.</p>
<p>이제 이걸 사용하려면 <code class="notranslate" translate="no">m4.projection</code>에 대한 기존 호출을 <code class="notranslate" translate="no">m4.perspective</code>에 대한 호출로 바꾸면 됩니다.</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">var aspect = gl.canvas.clientWidth / gl.canvas.clientHeight;
var zNear = 1;
var zFar = 2000;
var matrix = m4.perspective(fieldOfViewRadians, aspect, zNear, zFar);
matrix = m4.translate(matrix, translation[0], translation[1], translation[2]);
matrix = m4.xRotate(matrix, rotation[0]);
matrix = m4.yRotate(matrix, rotation[1]);
matrix = m4.zRotate(matrix, rotation[2]);
matrix = m4.scale(matrix, scale[0], scale[1], scale[2]);
</code></pre><p>그리고 여기 있습니다.</p>
<p><div class="webgl_example_container">
  <iframe class="webgl_example" style=" " src="/webgl/resources/editor.html?url=/webgl/lessons/..%2Fwebgl-3d-perspective-matrix.html"></iframe>
  <a class="webgl_center" href="/webgl/lessons/../webgl-3d-perspective-matrix.html" target="_blank">새 창을 열려면 여기를 클릭</a>
</div>

</p>
<p>다시 행렬 곱셉으로 돌아가서 시야각을 확보하고 Z space를 선택할 수 있습니다.
아직 끝나지 않았지만 글이 너무 길어지고 있군요.
다음은 <a href="webgl-3d-camera.html">카메라</a>입니다.</p>
<div class="webgl_bottombar">
<h3>지금까지 F를 Z(-360)에서 움직인 이유가 뭔가요?</h3>
<p>
다른 샘플에서는 F가 (45, 150, 0)에 있지만 마지막 샘플에서는 (-150, 0, -360)으로 옮겨졌습니다.
왜 그렇게 멀리 옮겨야 했을까요?
</p>
<p>
그 이유는 마지막 샘플까지 <code class="notranslate" translate="no">m4.projection</code> 함수가 pixel에서 clip space로 투영을 만들었기 때문입니다.
이는 우리가 표시하고 있던 영역이 400x300px을 나타냈다는 걸 의미하는데요.
3D에서 'pixel'을 사용하는 건 정말 의미가 없습니다.
</p>
<p>다시말해 0,0,0에서 F를 그리려고 했지만 회전하지 않는다면</p>
<div class="webgl_center"><img src="../resources/f-big-and-wrong-side.svg" style="width: 500px;"></div>
<p>
F는 원점에 왼쪽 상단 앞 모서리가 있게 됩니다.
투영은 -Z를 향하지만 F는 +Z로 만들어졌죠.
투영은 +Y가 위를 향하지만 F는 +Z가 아래를 향합니다.
</p>
<p>
새로운 투영은 파란 절두체 안에 있는 것만 볼 수 있습니다.
-zNear = 1 그리고 60도의 시야각일 때 Z = -1에서 절두체의 높이는 1.154이고 너비는 1.154 * aspect 입니다.
Z = -2000 (-zFar)에서 높이는 2309입니다.
F의 크기가 150이고, <code class="notranslate" translate="no">-zNear</code>에 무언가가 있을 때 view는 1.154만 볼 수 있기 때문에, 모든 걸 보려면 원점에서 꽤 멀리 이동해야 합니다.
</p>
<p>
Z단위로 -360 움직이면 절두체의 내부로 이동합니다.
또한 오른쪽이 위쪽에 오도록 회전했습니다.
</p>
<div class="webgl_center"><img src="../resources/f-right-side.svg" style="width: 500px;"><div>Scale 없음</div></div>
</div>


    </div>
    <div class="lesson-sidebar">
        <select class="language">
    <option value="/webgl/lessons/webgl-3d-perspective.html" >English</a>
    <option value="/webgl/lessons/fr/webgl-3d-perspective.html" >Français</a>
    <option value="/webgl/lessons/ja/webgl-3d-perspective.html" >日本語</a>
    <option value="/webgl/lessons/ko/webgl-3d-perspective.html" selected>한국어</a>
    <option value="/webgl/lessons/pl/webgl-3d-perspective.html" >Polski</a>
    <option value="/webgl/lessons/pt-br/webgl-3d-perspective.html" >Portuguese</a>
    <option value="/webgl/lessons/ru/webgl-3d-perspective.html" >Русский</a>
    <option value="/webgl/lessons/zh_cn/webgl-3d-perspective.html" >简体中文</a>
</select>


        <div id="toc">
          <ul>  <li>기초</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-fundamentals.html">기초</a></li>
<li><a href="/webgl/lessons/ko/webgl-how-it-works.html">작동 원리</a></li>
<li><a href="/webgl/lessons/ko/webgl-shaders-and-glsl.html">Shader 및 GLSL</a></li>
<li><a href="/webgl/lessons/resources/webgl-state-diagram.html">WebGL 상태 다이어그램</a></li>
        </ul>
  <li>이미지 처리</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-image-processing.html">이미지 처리</a></li>
<li><a href="/webgl/lessons/ko/webgl-image-processing-continued.html">이미지 처리 심화</a></li>
        </ul>
  <li>2D Translation, Rotation, Scale, 행렬 수학</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-2d-translation.html">2D Translation</a></li>
<li><a href="/webgl/lessons/ko/webgl-2d-rotation.html">2D Rotation</a></li>
<li><a href="/webgl/lessons/ko/webgl-2d-scale.html">2D Scale</a></li>
<li><a href="/webgl/lessons/ko/webgl-2d-matrices.html">2D 행렬</a></li>
        </ul>
  <li>3D</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-3d-orthographic.html">3D 직교법</a></li>
<li><a href="/webgl/lessons/ko/webgl-3d-perspective.html">3D 원근법</a></li>
<li><a href="/webgl/lessons/ko/webgl-3d-camera.html">3D 카메라</a></li>
        </ul>
  <li>조명</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-3d-lighting-directional.html">Directional Lighting</a></li>
<li><a href="/webgl/lessons/ko/webgl-3d-lighting-point.html">Point Lighting</a></li>
<li><a href="/webgl/lessons/ko/webgl-3d-lighting-spot.html">Spot Lighting</a></li>
        </ul>
  <li>구조와 구성</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-less-code-more-fun.html">코드는 적게, 재미는 더</a></li>
<li><a href="/webgl/lessons/ko/webgl-drawing-multiple-things.html">여러 물체 그리기</a></li>
<li><a href="/webgl/lessons/ko/webgl-scene-graph.html">Scene Graphs</a></li>
        </ul>
  <li>Geometry</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-3d-geometry-lathe.html">Geometry - Lathe</a></li>
<li><a href="/webgl/lessons/ko/webgl-load-obj.html">Loading .obj files</a></li>
<li><a href="/webgl/lessons/ko/webgl-load-obj-w-mtl.html">Loading .obj w .mtl files</a></li>
        </ul>
  <li>Texture</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-3d-textures.html">Textures</a></li>
<li><a href="/webgl/lessons/ko/webgl-data-textures.html">Data Textures</a></li>
<li><a href="/webgl/lessons/ko/webgl-2-textures.html">2개 이상의 Texture 사용</a></li>
<li><a href="/webgl/lessons/ko/webgl-cors-permission.html">Cross Origin Images</a></li>
<li><a href="/webgl/lessons/ko/webgl-3d-perspective-correct-texturemapping.html">Perspective Correct Texture Mapping</a></li>
<li><a href="/webgl/lessons/ko/webgl-planar-projection-mapping.html">Planar and Perspective Projection Mapping</a></li>
        </ul>
  <li>Texture 렌더링</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-render-to-texture.html">Render to Texture</a></li>
        </ul>
  <li>그림자</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-shadows.html">Shadows</a></li>
        </ul>
  <li>기법</li>
        <ul>
            <li>2D</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-2d-drawimage.html">2D - DrawImage</a></li>
<li><a href="/webgl/lessons/ko/webgl-2d-matrix-stack.html">2D - Matrix Stack</a></li>
<li><a href="/webgl/lessons/ko/webgl-sprites.html">Sprite</a></li>
        </ul>
  <li>3D</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-cube-maps.html">Cubemaps</a></li>
<li><a href="/webgl/lessons/ko/webgl-environment-maps.html">Environment maps</a></li>
<li><a href="/webgl/lessons/ko/webgl-skybox.html">Skyboxes</a></li>
<li><a href="/webgl/lessons/ko/webgl-skinning.html">Skinning</a></li>
<li><a href="/webgl/lessons/ko/webgl-fog.html">Fog</a></li>
<li><a href="/webgl/lessons/ko/webgl-picking.html">Picking (clicking on stuff)</a></li>
        </ul>
  <li>텍스트</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-text-html.html">Text - HTML</a></li>
<li><a href="/webgl/lessons/ko/webgl-text-canvas2d.html">Text - Canvas 2D</a></li>
<li><a href="/webgl/lessons/ko/webgl-text-texture.html">Text - Using a Texture</a></li>
<li><a href="/webgl/lessons/ko/webgl-text-glyphs.html">Text - Using a Glyph Texture</a></li>
        </ul>
  <li>Texture</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-ramp-textures.html">Ramp Textures (Toon Shading)</a></li>
        </ul>
  <li>GPGPU</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-gpgpu.html">GPGPU</a></li>
        </ul>
        </ul>
  <li>Tip</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-smallest-programs.html">Smallest Programs</a></li>
<li><a href="/webgl/lessons/ko/webgl-drawing-without-data.html">Drawing Without Data</a></li>
<li><a href="/webgl/lessons/ko/webgl-shadertoy.html">Shadertoy</a></li>
<li><a href="/webgl/lessons/ko/webgl-pulling-vertices.html">Pulling Vertices</a></li>
        </ul>
  <li>최적화</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-indexed-vertices.html">Indexed Vertices (gl.drawElements)</a></li>
<li><a href="/webgl/lessons/ko/webgl-instanced-drawing.html">Instanced Drawing</a></li>
        </ul>
  <li>Misc</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-setup-and-installation.html">설정 및 설치</a></li>
<li><a href="/webgl/lessons/ko/webgl-boilerplate.html">Boilerplate</a></li>
<li><a href="/webgl/lessons/ko/webgl-resizing-the-canvas.html">캔버스 크기 조정</a></li>
<li><a href="/webgl/lessons/ko/webgl-animation.html">애니메이션</a></li>
<li><a href="/webgl/lessons/ko/webgl-points-lines-triangles.html">점, 선, 삼각형</a></li>
<li><a href="/webgl/lessons/ko/webgl-multiple-views.html">Multiple Views, Multiple Canvases</a></li>
<li><a href="/webgl/lessons/ko/webgl-visualizing-the-camera.html">Visualizing the Camera</a></li>
<li><a href="/webgl/lessons/ko/webgl-and-alpha.html">WebGL Alpha</a></li>
<li><a href="/webgl/lessons/ko/webgl-2d-vs-3d-library.html">2D vs 3D 라이브러리</a></li>
<li><a href="/webgl/lessons/ko/webgl-anti-patterns.html">안티 패턴</a></li>
<li><a href="/webgl/lessons/ko/webgl-matrix-vs-math.html">WebGL 행렬 vs 수학 행렬</a></li>
<li><a href="/webgl/lessons/ko/webgl-precision-issues.html">정밀도 이슈</a></li>
<li><a href="/webgl/lessons/ko/webgl-tips.html#screenshot">스크린샷 찍기</a></li>
<li><a href="/webgl/lessons/ko/webgl-tips.html#preservedrawingbuffer">캔버스 지우기 방지</a></li>
<li><a href="/webgl/lessons/ko/webgl-tips.html#tabindex">캔버스 키보드 입력</a></li>
<li><a href="/webgl/lessons/ko/webgl-tips.html#html-background">WebGL 배경 제작</a></li>
<li><a href="/webgl/lessons/ko/webgl-cross-platform-issues.html">크로스 플랫폼 이슈</a></li>
<li><a href="/webgl/lessons/ko/webgl-qna.html">질문 및 답변</a></li>
        </ul>
  <li>참고</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-attributes.html">Attribute</a></li>
<li><a href="/webgl/lessons/ko/webgl-texture-units.html">Texture Unit</a></li>
<li><a href="/webgl/lessons/ko/webgl-framebuffers.html">Framebuffer</a></li>
<li><a href="/webgl/lessons/ko/webgl-readpixels.html">readPixels</a></li>
<li><a href="/webgl/lessons/ko/webgl-references.html">참고 자료</a></li>
        </ul></ul>
<ul>
  <li><a href="/docs/">도우미 API 문서</a></li>
  <li><a href="https://twgljs.org">TWGL, 가벼운 WebGL 라이브러리</a></li>
  <li><a href="https://github.com/gfxfundamentals/webgl-fundamentals">Github</a></li>
</ul>

        </div>
    </div>
    <div class="lesson-comments">
        
    <div>이슈/버그는? <a href="https://github.com/gfxfundamentals/webgl-fundamentals/issues">Github</a>에 이슈를 만들어주세요.</div>
    <div class="lesson-comment-notes">
      코드 블록은 <b>&lt;pre&gt;&lt;code&gt;</b>여기에 코드 입력<b>&lt;/code&gt;&lt;/pre&gt;</b>를 사용해주세요
    </div>
  

        <div id="disqus_thread"></div>
        <script>
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'webglfundamentals'; // required: replace example with your forum shortname
            var disqus_identifier = 'WebGL 3D 원근법';
            var disqus_title = 'WebGL 3D 원근법';

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                if (window.location.hostname.indexOf("webglfundamentals.org") < 0) {
                    return;
                }
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
  </div>
</div>
</body>
<script>
const settings = {
  contribTemplate: "Thank you <a href=\"${html_url}\"><img src=\"${avatar_url}\"> ${login}</a><br>for <a href=\"https://github.com/${owner}/${repo}/commits?author=${login}\">${contributions} contributions</a>",
  owner: "gfxfundamentals",
  repo: "webgl-fundamentals",
};
</script>
<script src="/contributors.js"></script>
<script src="/3rdparty/jquery-1.11.2.min.js"></script>
<script src="/webgl/lessons/resources/prettify.js"></script>
<script src="/webgl/lessons/resources/lesson.js" type="module"></script>
<script>
(function() {
  if (window.location.hostname.indexOf("webglfundamentals.org") < 0) {
      return;
  }

  function addScript(src, type, fn) {
    const script = document.createElement('script');
    const firstScript = document.getElementsByTagName('script')[0];
    script.async = true;
    script.defer = true;
    script.type = type || 'javascript';
    if (fn) {
      script.addEventListener('load', fn);
    }
    script.src = src;
    firstScript.parentNode.insertBefore(script, firstScript);
  }

  // can't do this because it would eat contexts
  //addScript('//gpustats.org/stats.js', 'module');

  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59804936-1', 'auto');
  ga('send', 'pageview');
}());
</script>


</html>




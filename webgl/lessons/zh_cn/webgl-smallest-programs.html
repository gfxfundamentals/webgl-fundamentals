<!DOCTYPE html>
<!-- this file is auto-generated from webgl/lessons/zh_cn/webgl-smallest-programs.md. Do not edited directly -->
<!--
Copyright 2021 GFXFundamentals.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are
met:

*   Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.

*   Redistributions in binary form must reproduce the above
    copyright notice, this list of conditions and the following disclaimer
    in the documentation and/or other materials provided with the
    distribution.

*   Neither the name of GFXFundamentals. nor the names of his
    contributors may be used to endorse or promote products derived from
    this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-->
<html lang="zh-cn">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="用于测试的最少量的代码">
<meta name="keywords" content="webgl graphics">
<meta name="thumbnail" content="https://webglfundamentals.org/webgl/lessons/screenshots/webgl-smallest-programs_zh-cn.jpg">

<meta property="og:title" content="WebGL 最小的程序">
<meta property="og:type" content="website">
<meta property="og:image" content="https://webglfundamentals.org/webgl/lessons/screenshots/webgl-smallest-programs_zh-cn.jpg">
<meta property="og:description" content="用于测试的最少量的代码">
<meta property="og:url" content="https://webglfundamentals.org/webgl/lessons/zh_cn/webgl-smallest-programs.html">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@greggman">
<meta name="twitter:creator" content="@greggman">
<meta name="twitter:domain" content="webglfundamentals.org">
<meta name="twitter:title" content="WebGL 最小的程序">
<meta name="twitter:url" content="https://webglfundamentals.org/webgl/lessons/zh_cn/webgl-smallest-programs.html">
<meta name="twitter:description" content="用于测试的最少量的代码">
<meta name="twitter:image:src" content="https://webglfundamentals.org/webgl/lessons/screenshots/webgl-smallest-programs_zh-cn.jpg">

<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@graph":[
    {
      "@type":"WebSite",
      "@id":"https://webglfundamentals.org/#website",
      "url":"https://webglfundamentals.org/",
      "name":"WebglFundamentals"
    },
    {
      "@type":"ImageObject",
      "@id":"https://webglfundamentals.org/webgl/lessons/zh_cn/webgl-smallest-programs.html#primaryimage",
      "url":"https://webglfundamentals.org/webgl/lessons/screenshots/webgl-smallest-programs_zh-cn.jpg",
      "width":1200,
      "height":630
    },
    {
      "@type":"WebPage",
      "@id":"https://webglfundamentals.org/webgl/lessons/zh_cn/webgl-smallest-programs.html#webpage",
      "url":"https://webglfundamentals.org/webgl/lessons/zh_cn/webgl-smallest-programs.html",
      "inLanguage":"zh-cn",
      "name":"WebGL 最小的程序",
      "keywords":"webgl graphics programming",
      "isPartOf":{
        "@id":"https://webglfundamentals.org/#website"
      },
      "primaryImageOfPage":{
        "@id":"https://webglfundamentals.org/webgl/lessons/zh_cn/webgl-smallest-programs.html#primaryimage"
      }
    }
  ]
}
</script>


<title>WebGL 最小的程序</title>
<link href="/webgl/lessons/resources/webglfundamentals-icon.png" rel="shortcut icon" type="image/png">
<link rel="stylesheet" href="/webgl/lessons/lang.css">
<link rel="stylesheet" href="/webgl/lessons/resources/lesson.css">

  <link rel="alternate" hreflang="en" href="https://webglfundamentals.org/webgl/lessons/webgl-smallest-programs.html">
  <link rel="alternate" hreflang="fr" href="https://webglfundamentals.org/webgl/lessons/fr/webgl-smallest-programs.html">
  <link rel="alternate" hreflang="ja" href="https://webglfundamentals.org/webgl/lessons/ja/webgl-smallest-programs.html">
  <link rel="alternate" hreflang="ko" href="https://webglfundamentals.org/webgl/lessons/ko/webgl-smallest-programs.html">
  <link rel="alternate" hreflang="pl" href="https://webglfundamentals.org/webgl/lessons/pl/webgl-smallest-programs.html">
  <link rel="alternate" hreflang="pt-br" href="https://webglfundamentals.org/webgl/lessons/pt-br/webgl-smallest-programs.html">
  <link rel="alternate" hreflang="ru" href="https://webglfundamentals.org/webgl/lessons/ru/webgl-smallest-programs.html">
  <link rel="alternate" hreflang="uk" href="https://webglfundamentals.org/webgl/lessons/uk/webgl-smallest-programs.html">
  <link rel="alternate" hreflang="zh_cn" href="https://webglfundamentals.org/webgl/lessons/zh_cn/webgl-smallest-programs.html">




</head>
<body>
<div class="webgl_navbar">
  <div>
    <select class="language">
    <option value="/webgl/lessons/webgl-smallest-programs.html" >English</a>
    <option value="/webgl/lessons/fr/webgl-smallest-programs.html" >Français</a>
    <option value="/webgl/lessons/ja/webgl-smallest-programs.html" >日本語</a>
    <option value="/webgl/lessons/ko/webgl-smallest-programs.html" >한국어</a>
    <option value="/webgl/lessons/pl/webgl-smallest-programs.html" >Polski</a>
    <option value="/webgl/lessons/pt-br/webgl-smallest-programs.html" >Portuguese</a>
    <option value="/webgl/lessons/ru/webgl-smallest-programs.html" >Русский</a>
    <option value="/webgl/lessons/uk/webgl-smallest-programs.html" >Українська</a>
    <option value="/webgl/lessons/zh_cn/webgl-smallest-programs.html" selected>简体中文</a>
</select>


    <a href="#toc">目录</a>
  </div>
</div>
<div class="webgl_header">
  <h1><a href="/webgl/lessons/zh_cn/">WebGLFundamentals.org</a></h1>
<style>
#forkongithub>div {
    background: #000;
    color: #fff;
    font-family: arial,sans-serif;
    text-align: center;
    font-weight: bold;
    padding: 5px 40px;
    font-size: 0.9rem;
    line-height: 1.3rem;
    position: relative;
    transition: 0.5s;
    display: block;
    width: 400px;
    position: absolute;
    top: 0;
    right: 0;
    transform: translateX(200px) rotate(45deg) translate(10px,70px);
    box-shadow: 4px 4px 10px rgba(0,0,0,0.8);
    pointer-events: auto;
}
#forkongithub a {
  text-decoration: none;
  color: #fff;
}
#forkongithub>div:hover {
    background: #c11;
    color: #fff;
}
#forkongithub .contributors {
  font-size: 0.75rem;
  background: rgba(255,255,255,0.2);
  line-height: 1.2;
  padding: 0.1em;
}
#forkongithub>div::before,#forkongithub>div::after {
    content: "";
    width: 100%;
    display: block;
    position: absolute;
    top: 1px;
    left: 0;
    height: 1px;
    background: #fff;
}
#forkongithub>div::after {
    bottom: 1px;
    top: auto;
}

#forkongithub{
    z-index: 9999;
    /* needed for firefox */
    overflow: hidden;
    width: 300px;
    height: 300px;
    position: absolute;
    right: 0;
    top: 0;
    pointer-events: none;
}
#forkongithub svg{
  width: 1em;
  height: 1em;
  vertical-align: middle;
}
#forkongithub img {
  width: 1em;
  height: 1em;
  border-radius: 100%;
  vertical-align: middle;
}

@media (max-width: 900px) {
    #forkongithub>div {
        line-height: 1.2rem;
    }
}
@media (max-width: 700px) {
  #forkongithub {
    display: none;
  }
}
@media (max-width: 410px) {
    #forkongithub>div {
        font-size: 0.7rem;
        transform: translateX(150px) rotate(45deg) translate(20px,40px);
    }
}

</style>
<div id="forkongithub"><div><div><a href="https://github.com/gfxfundamentals/webgl-fundamentals">Fix, Fork, Contribute <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 136 133" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(3.92891,0,0,3.92891,67.867,129.125)">
        <path d="M0,-31.904C-8.995,-31.904 -16.288,-24.611 -16.288,-15.614C-16.288,-8.417 -11.621,-2.312 -5.148,-0.157C-4.333,-0.008 -4.036,-0.511 -4.036,-0.943C-4.036,-1.329 -4.05,-2.354 -4.058,-3.713C-8.589,-2.729 -9.545,-5.897 -9.545,-5.897C-10.286,-7.779 -11.354,-8.28 -11.354,-8.28C-12.833,-9.29 -11.242,-9.27 -11.242,-9.27C-9.607,-9.155 -8.747,-7.591 -8.747,-7.591C-7.294,-5.102 -4.934,-5.821 -4.006,-6.238C-3.858,-7.29 -3.438,-8.008 -2.972,-8.415C-6.589,-8.826 -10.392,-10.224 -10.392,-16.466C-10.392,-18.244 -9.757,-19.698 -8.715,-20.837C-8.883,-21.249 -9.442,-22.905 -8.556,-25.148C-8.556,-25.148 -7.188,-25.586 -4.076,-23.478C-2.777,-23.84 -1.383,-24.02 0.002,-24.026C1.385,-24.02 2.779,-23.84 4.08,-23.478C7.19,-25.586 8.555,-25.148 8.555,-25.148C9.444,-22.905 8.885,-21.249 8.717,-20.837C9.761,-19.698 10.392,-18.244 10.392,-16.466C10.392,-10.208 6.583,-8.831 2.954,-8.428C3.539,-7.925 4.06,-6.931 4.06,-5.411C4.06,-3.234 4.04,-1.477 4.04,-0.943C4.04,-0.507 4.333,0 5.16,-0.159C11.628,-2.318 16.291,-8.419 16.291,-15.614C16.291,-24.611 8.997,-31.904 0,-31.904" style="fill:white;"/>
    </g>
</svg>
</a></div></div></div>

</div>


<div class="container">
  <div class="lesson-title">
    <h1>WebGL 最小的程序</h1>
  </div>
  <div class="lesson">
    <div class="lesson-main">
      <p>这篇文章假设你已经阅读了从 <a href="webgl-fundamentals.html">WebGL 基础</a> 开始的其它文章。
如果你尚未阅读这些文章，则可能需要先阅读这些文章。</p>
<p>我不知道应该吧这篇文章放哪个分类下，因为它主要有两个目的：</p>
<ol>
<li><p>向你展示最小的 WebGL 程序</p>
<p> 这些技巧对于测试一些东西，或者做一个 <a href="https://meta.stackoverflow.com/a/349790/128511">完整最小可验证集 (MCVE for Stack Overflow)</a>
 或者在找 bug 的时候都非常有用。</p>
</li>
<li><p>学着跳出框子思考</p>
<p> 我希望多写几篇这样的文章，来帮助你宏观的思考，而不是一些通用的模板。
 <a href="webgl-drawing-without-data.html">这里有个例子</a>。</p>
</li>
</ol>
<h2 id="-">清除</h2>
<p>这里有个最小的 WebGL 程序：</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">const gl = document.querySelector(&#39;canvas&#39;).getContext(&#39;webgl&#39;);
gl.clearColor(1, 0, 0, 1); // 红色
gl.clear(gl.COLOR_BUFFER_BIT);
</code></pre>
<p>这个程序所做的仅仅是将画布设置成红色，它确实做了一些事。</p>
<p>仔细思考一下，通过这个简单的程序我们确实可以测试一些东西。
例如你在 <a href="webgl-render-to-texture.html">渲染到纹理</a> 时，但有些功能没有正常工作。
就像 <a href="webgl-render-to-texture.html">这篇文章</a> 里的例子，
你在将 1 个或多个 3D 物体渲染到纹理上，然后将纹理渲染到立方体上。</p>
<p>你没有看到任何结果。一个简单的测试方法是，停止使用着色器渲染纹理，
给纹理一个指定的颜色。</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">gl.bindFramebuffer(gl.FRAMEBUFFER, framebufferWithTexture);
gl.clearColor(1, 0, 1, 1); // 品红色
gl.clear(gl.COLOR_BUFFER_BIT);
</code></pre>
<p>现在从帧缓存里渲染纹理，立方体变品红色了吗？
如果没有，那么你的问题出在别的地方，而不是渲染到纹理这部分。</p>
<h2 id="-scissor_test-gl-clear-">使用 <code class="notranslate" translate="no">SCISSOR_TEST</code> 和 <code class="notranslate" translate="no">gl.clear</code></h2>
<p><code class="notranslate" translate="no">SCISSOR_TEST</code> 将绘制和清除区域剪裁到一些小的方形画布中（或者当前帧缓存）。</p>
<p>你可以通过下面代码开启剪裁</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">gl.enable(gl.SCISSOR_TEST);
</code></pre>
<p>然后将剪裁矩形设置到相对于左下角的相对位置，以像素计。它使用和 <code class="notranslate" translate="no">gl.viewport</code> 一样的参数。</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">gl.scissor(x, y, width, height);
</code></pre>
<p>这样就可以使用 <code class="notranslate" translate="no">SCISSOR_TEST</code> 和 <code class="notranslate" translate="no">gl.clear</code> 画一个矩形。</p>
<p>例子：</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">const gl = document.querySelector(&#39;#c&#39;).getContext(&#39;webgl&#39;);

gl.enable(gl.SCISSOR_TEST);

function drawRect(x, y, width, height, color) {
  gl.scissor(x, y, width, height);
  gl.clearColor(...color);
  gl.clear(gl.COLOR_BUFFER_BIT);
}

for (let i = 0; i &lt; 100; ++)) {
  const x = rand(0, 300);
  const y = rand(0, 150);
  const width = rand(0, 300 - x);
  const height = rand(0, 150 - y);
  drawRect(x, y, width, height, [rand(1), rand(1), rand(1), 1]);
}

function rand(min, max) {
  if (max === undefined) {
    max = min;
    min = 0;
  }
  return Math.random() * (max - min) + min;
}
</code></pre>
<p><div class="webgl_example_container">
  <iframe class="webgl_example" style=" " src="/webgl/resources/editor.html?url=/webgl/lessons/..%2Fwebgl-simple-scissor.html"></iframe>
  <a class="webgl_center" href="/webgl/lessons/../webgl-simple-scissor.html" target="_blank">点此在新窗口中浏览</a>
</div>

</p>
<p>不是说这段特定的代码会很有用，但是知道总是好的。</p>
<h2 id="-gl-points-">使用一个大的 <code class="notranslate" translate="no">gl.POINTS</code></h2>
<p>如大部分例子中展示的，在 WebGL 中做的最多的就是创建缓存，
将顶点数据放进缓存，创建带属性的着色器，设置属性从缓存中读取数据。
然后绘制，可能着色器还用到了全局变量和纹理。</p>
<p>但有时候你只是想测试一下。例如你只是想看到有东西绘制出来了。</p>
<p>那这个着色器怎么样：</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-glsl">// 顶点着色器
void main() {
  gl_Position = vec4(0, 0, 0, 1); // 中心
  gl_PointSize = 120.0;
}
</code></pre>
<pre class="prettyprint notranslate" translate="no"><code class="lang-glsl">// 片元着色器
precision mediump float;

void main() {
  gl_FragColor = vec4(1, 0, 0, 1); // 红色
}
</code></pre>
<p>下面是使用：</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">// 设置 GLSL 程序
const program = webglUtils.createProgramFromSources(gl, [vs, fs]);

gl.useProgram(program);

const offset = 0;
const count = 1;
gl.drawArrays(gl.POINTS, offset, count);
</code></pre>
<p>不用创建缓存，不用设置全局变量，我们得到了一个在画布中心的单点。</p>
<p><div class="webgl_example_container">
  <iframe class="webgl_example" style=" " src="/webgl/resources/editor.html?url=/webgl/lessons/..%2Fwebgl-simple-point.html"></iframe>
  <a class="webgl_center" href="/webgl/lessons/../webgl-simple-point.html" target="_blank">点此在新窗口中浏览</a>
</div>

</p>
<blockquote>
<p>注意：Safari 没有通过该特性的 <a href="https://www.khronos.org/registry/webgl/sdk/tests/conformance/rendering/point-no-attributes.html?webglVersion=1&amp;quiet=0">WebGL 一致性测试</a>。
这里有个 <a href="https://bugs.webkit.org/show_bug.cgi?id=197592">提交的 Bug</a>。
请考虑礼貌的要求他们修复这个问题。
越多的人要求就越有可能得到修复。</p>
</blockquote>
<p>关于 <code class="notranslate" translate="no">gl.POINTS</code>: 当你将 <code class="notranslate" translate="no">gl.POINTS</code> 传给 <code class="notranslate" translate="no">gl.drawArrays</code> 时，
你需要在顶点着色器中将 <code class="notranslate" translate="no">gl_PointSize</code> 设置成像素尺寸。
值得注意的是，不同的 GPU 或驱动有不同的可使用的最大 Point 尺寸。
你可以查询最大值：</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">const [minSize, maxSize] = gl.getParameter(gl.ALIASED_POINT_SIZE_RANGE);
</code></pre><p>WebGL 规范只要求最大值为 1.0。幸运的是，<a href="https://web3dsurvey.com/webgl/parameters/ALIASED_POINT_SIZE_RANGE">绝大多数 GPU 和驱动支持更大的值</a>。</p>
<p>在你设置 <code class="notranslate" translate="no">gl_PointSize</code> 后，当顶点着色器退出后，无论你给 <code class="notranslate" translate="no">gl_Position</code> 设置了什么值，
都将被转变成在屏幕/画布中的像素值，然后会以这个位置为中点，
向四个方向延伸 +/- gl_PointSize / 2，生成一个矩形。</p>
<p>好了，我能听到你在说所以呢，谁会想要画一个单点呢。</p>
<p>单点能自动获得 <a href="webgl-3d-textures.html">纹理座标</a>。它们能在片段着色器中通过特殊变量 <code class="notranslate" translate="no">gl_PointCoord</code> 获取到。
所以，让我们在那个单点上绘制纹理。</p>
<p>首先，修改片元着色器。</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-glsl">// 片元着色器
precision mediump float;

+uniform sampler2D tex;

void main() {
-  gl_FragColor = vec4(1, 0, 0, 1);  // red
+  gl_FragColor = texture2D(tex, gl_PointCoord.xy);
}
</code></pre>
<p>为了保持简单，我们将根据 <a href="webgl-data-textures.html">数据纹理</a> 中提到，使用原始数据制作纹理。</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">// 2x2 像素数据
const pixels = new Uint8Array([
  0xFF, 0x00, 0x00, 0xFF,  // 红
  0x00, 0xFF, 0x00, 0xFF,  // 绿
  0x00, 0x00, 0xFF, 0xFF,  // 蓝
  0xFF, 0x00, 0xFF, 0xFF,  // 品红
]);
const tex = gl.createTexture();
gl.bindTexture(gl.TEXTURE_2D, tex);
gl.texImage2D(
    gl.TEXTURE_2D,
    0,                 // 级别
    gl.RGBA,           // 内部格式
    2,                 // 宽度
    2,                 // 高度
    0,                 // 边宽
    gl.RGBA,           // 格式
    gl.UNSIGNED_BYTE,  // 数据类型
    pixels,            // 原始数据
);
gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);
gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);
</code></pre>
<p>因为 WebGL 默认使用纹理单元从 0 开始，全局变量默认为 0，所以不需要其它设置。</p>
<p><div class="webgl_example_container">
  <iframe class="webgl_example" style=" " src="/webgl/resources/editor.html?url=/webgl/lessons/..%2Fwebgl-simple-point-w-texture.html"></iframe>
  <a class="webgl_center" href="/webgl/lessons/../webgl-simple-point-w-texture.html" target="_blank">点此在新窗口中浏览</a>
</div>

</p>
<p>这应该是测试纹理相关问题的一个比较好的方法。
我们没有使用缓存、属性，不用设置和查找全局变量。
比如我们加载了一张图片，但没有显示。如果我们使用上面的着色器，图片显示在单点了吗？
我们渲染到了纹理，如果想要查看纹理，通常我们会通过缓存和属性设置一些几何体。
但我们可以将纹理展示在单点上来渲染纹理。</p>
<h2 id="-points-">使用多个单独的 <code class="notranslate" translate="no">POINTS</code></h2>
<p>这里有另一个对上面例子的简单修改。我们可以将顶点着色器修改成：</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-glsl">// 顶点着色器

+attribute vec4 position;

void main() {
-  gl_Position = vec4(0, 0, 0, 1);
+  gl_Position = position;
  gl_PointSize = 120.0;
}
</code></pre>
<p>属性有默认值 <code class="notranslate" translate="no">0, 0, 0, 1</code>，所以像我们上面的修改还是可以正常工作的。
但现在，我们可以设置我们想要的位置了。</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">+const program = webglUtils.createProgramFromSources(gl, [vs, fs]);
const positionLoc = gl.getAttribLocation(program, &#39;position&#39;);

...

+const numPoints = 5;
+for (let i = 0; i &lt; numPoints; ++i) {
+  const u = i / (numPoints - 1);    // 0 到 1
+  const clipspace = u * 1.6 - 0.8;  // -0.8 到 +0.8
+  gl.vertexAttrib2f(positionLoc, clipspace, clipspace);

*  const offset = 0;
*  const count = 1;
*  gl.drawArrays(gl.POINTS, offset, count);
+}
</code></pre>
<p>在我们运行之前，先让点小一些：</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-glsl">// 顶点着色器

attribute vec4 position;
+uniform float size;

void main() {
  gl_Position = position;
-  gl_PointSize = 120.0;
+  gl_PointSize = 20.0;
}
</code></pre>
<p>让我们把它变成可以修改点的颜色。
（注意：我切换回了没有纹理的代码。）</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-glsl">precision mediump float;

+uniform vec4 color;

void main() {
-  gl_FragColor = vec4(1, 0, 0, 1);   // 红色
+  gl_FragColor = color;
}
</code></pre>
<p>然后我们需要查找颜色的位置：</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">// 设置 GLSL 程序
const program = webglUtils.createProgramFromSources(gl, [vs, fs]);
const positionLoc = gl.getAttribLocation(program, &#39;position&#39;);
+const colorLoc = gl.getUniformLocation(program, &#39;color&#39;);
</code></pre>
<p>然后使用：</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">gl.useProgram(program);

const numPoints = 5;
for (let i = 0; i &lt; numPoints; ++i) {
  const u = i / (numPoints - 1);    // 0 到 1
  const clipspace = u * 1.6 - 0.8;  // -0.8 到 +0.8
  gl.vertexAttrib2f(positionLoc, clipspace, clipspace);

+  gl.uniform4f(colorLoc, u, 0, 1 - u, 1);

  const offset = 0;
  const count = 1;
  gl.drawArrays(gl.POINTS, offset, count);
}
</code></pre>
<p>现在，我们得到了 5 种颜色的 5 个点，而且我们没有设置缓存或者属性。</p>
<p><div class="webgl_example_container">
  <iframe class="webgl_example" style=" " src="/webgl/resources/editor.html?url=/webgl/lessons/..%2Fwebgl-simple-points.html"></iframe>
  <a class="webgl_center" href="/webgl/lessons/../webgl-simple-points.html" target="_blank">点此在新窗口中浏览</a>
</div>

</p>
<p>当然，这 <strong>不是</strong> 你应该在 WebGL 里画多个点的方法。
如果你想画多个点，你应该为每个点设置带位置的属性、颜色，并且在一次绘制调用中绘制所有的点。</p>
<p>但是！为了测试、调试、或编写一个 <a href="https://meta.stackoverflow.com/a/349790/128511">MCVE</a>，
<strong>最小化</strong> 代码是个不错的方式。
再举一个例子，假如我们在为后处理效果绘制到纹理，我们想要显示它们。
我们可以用上面例子的组合，为每个纹理绘制一个大的点。
没有复杂的缓存和属性设置，对于调试来说非常好。</p>

    </div>
    <div class="lesson-sidebar">
        <select class="language">
    <option value="/webgl/lessons/webgl-smallest-programs.html" >English</a>
    <option value="/webgl/lessons/fr/webgl-smallest-programs.html" >Français</a>
    <option value="/webgl/lessons/ja/webgl-smallest-programs.html" >日本語</a>
    <option value="/webgl/lessons/ko/webgl-smallest-programs.html" >한국어</a>
    <option value="/webgl/lessons/pl/webgl-smallest-programs.html" >Polski</a>
    <option value="/webgl/lessons/pt-br/webgl-smallest-programs.html" >Portuguese</a>
    <option value="/webgl/lessons/ru/webgl-smallest-programs.html" >Русский</a>
    <option value="/webgl/lessons/uk/webgl-smallest-programs.html" >Українська</a>
    <option value="/webgl/lessons/zh_cn/webgl-smallest-programs.html" selected>简体中文</a>
</select>


        <div id="toc">
          <ul>  <li>基础概念</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-fundamentals.html">WebGL 基础概念</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-how-it-works.html">WebGL 工作原理</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-shaders-and-glsl.html">WebGL 着色器和GLSL</a></li>
<li><a href="/webgl/lessons/resources/webgl-state-diagram.html">WebGL State Diagram</a></li>
        </ul>
  <li>图像处理</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-image-processing.html">WebGL 图像处理</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-image-processing-continued.html">WebGL 进一步处理图像</a></li>
        </ul>
  <li>二维平移，旋转，缩放和矩阵运算</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-2d-translation.html">WebGL 二维平移</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-2d-rotation.html">WebGL 二维旋转</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-2d-scale.html">WebGL 二维缩放</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-2d-matrices.html">WebGL 二维矩阵</a></li>
        </ul>
  <li>三维</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-3d-orthographic.html">WebGL 三维正射投影</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-3d-perspective.html">WebGL 三维透视投影</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-3d-camera.html">WebGL 三维相机</a></li>
        </ul>
  <li>光照</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-3d-lighting-directional.html">WebGL 三维方向光源</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-3d-lighting-point.html">WebGL 三维点光源</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-3d-lighting-spot.html">WebGL 三维聚光灯</a></li>
        </ul>
  <li>组织和重构</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-less-code-more-fun.html">WebGL 码少趣多</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-drawing-multiple-things.html">WebGL 绘制多个物体</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-scene-graph.html">WebGL 场景图</a></li>
        </ul>
  <li>几何</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-3d-geometry-lathe.html">WebGL 三维几何加工</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-load-obj.html">WebGL 加载 .obj 文件</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-load-obj-w-mtl.html">WebGL 加载带 .mtl 的 .obj 文件</a></li>
        </ul>
  <li>纹理</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-3d-textures.html">WebGL 三维纹理</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-data-textures.html">WebGL 数据纹理</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-2-textures.html">WebGL 使用多个纹理</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-cors-permission.html">WebGL 跨域图像</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-3d-perspective-correct-texturemapping.html">WebGL 纹理映射的透视纠正</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-planar-projection-mapping.html">平面的和透视的投影映射</a></li>
        </ul>
  <li>渲染到纹理</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-render-to-texture.html">WebGL 渲染到纹理</a></li>
        </ul>
  <li>阴影</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-shadows.html">阴影</a></li>
        </ul>
  <li>技术</li>
        <ul>
            <li>二维</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-2d-drawimage.html">WebGL 二维DrawImage</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-2d-matrix-stack.html">WebGL 二维矩阵栈</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-sprites.html">精灵</a></li>
        </ul>
  <li>三维</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-cube-maps.html">WebGL 立方体贴图</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-environment-maps.html">WebGL 环境贴图</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-skybox.html">WebGL 天空盒</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-skinning.html">WebGL 蒙皮</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-fog.html">WebGL 雾</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-picking.html">抓取 (点击的东西)</a></li>
        </ul>
  <li>文字</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-text-html.html">WebGL 文字 - HTML</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-text-canvas2d.html">WebGL 文字 - 二维Canvas</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-text-texture.html">WebGL 文字 - 使用纹理</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-text-glyphs.html">WebGL 文字 - 使用字形纹理</a></li>
        </ul>
  <li>纹理</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-ramp-textures.html">Ramp Textures (Toon Shading)</a></li>
        </ul>
  <li>GPGPU</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-gpgpu.html">GPGPU</a></li>
        </ul>
        </ul>
  <li>建议</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-smallest-programs.html">WebGL 最小的程序</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-drawing-without-data.html">无数据绘图</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-shadertoy.html">Shadertoy</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-pulling-vertices.html">Pulling Vertices</a></li>
        </ul>
  <li>优化</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-indexed-vertices.html">顶点索引 （gl.drawElements)</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-instanced-drawing.html">实例化绘制</a></li>
        </ul>
  <li>杂项</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-setup-and-installation.html">WebGL 设置和安装</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-boilerplate.html">WebGL 样板</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-resizing-the-canvas.html">WebGL 重置画布尺寸</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-animation.html">WebGL 动画</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-points-lines-triangles.html">WebGL 点、线和三角</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-multiple-views.html">Multiple Views, Multiple Canvases</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-visualizing-the-camera.html">可视化相机</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-and-alpha.html">WebGL 和阿尔法通道</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-2d-vs-3d-library.html">WebGL 2D vs 3D 库</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-anti-patterns.html">WebGL 错误模式</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-matrix-vs-math.html">WebGL 矩阵 vs 数学中的矩阵</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-precision-issues.html">Precision Issues</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-tips.html#screenshot">截屏</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-tips.html#preservedrawingbuffer">防止画布被清空</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-tips.html#tabindex">在画布中获取键盘输入</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-tips.html#html-background">将 WebGL 作为 HTML 的背景</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-cross-platform-issues.html">WebGL 跨平台相关问题</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-qna.html">Questions and Answers</a></li>
        </ul>
  <li>参考</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-attributes.html">WebGL 属性</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-texture-units.html">WebGL 纹理单元</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-framebuffers.html">WebGL 帧缓冲</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-readpixels.html">WebGL readPixels</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-references.html">WebGL 参考</a></li>
        </ul></ul>
<ul>
  <li><a href="/docs/">API 帮助文档</a></li>
  <li><a href="https://twgljs.org">TWGL, 一个轻量级WebGL辅助库</a></li>
  <li><a href="https://github.com/gfxfundamentals/webgl-fundamentals">GitHub</a></li>
</ul>
        </div>
    </div>
    <div class="lesson-comments">
        
<div>有疑问? <a href="https://stackoverflow.com/questions/tagged/webgl">在stackoverflow上提问</a>.</div>
<div>Issue/Bug? <a href="https://github.com/gfxfundamentals/webgl-fundamentals/issues">在GitHub上提issue</a>.</div>
<div class="lesson-comment-notes">
   使用 <b>&lt;pre&gt;&lt;code&gt;</b> 代码 <b>&lt;/code&gt;&lt;/pre&gt;</b> 的格式编写代码块
</div>
  

        <div id="disqus_thread"></div>
        <script>
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'webglfundamentals'; // required: replace example with your forum shortname
            var disqus_identifier = 'WebGL 最小的程序';
            var disqus_title = 'WebGL 最小的程序';

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                if (window.location.hostname.indexOf("webglfundamentals.org") < 0) {
                    return;
                }
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
  </div>
</div>
</body>
<script>
const settings = {
  contribTemplate: "感谢 <a href=\"${html_url}\"><img src=\"${avatar_url}\"> ${login}</a><br>的 <a href=\"https://github.com/${owner}/${repo}/commits?author=${login}\">${contributions} 次贡献</a>",
  owner: "gfxfundamentals",
  repo: "webgl-fundamentals",
};
</script>
<script src="/contributors.js"></script>
<script src="/3rdparty/jquery-1.11.2.min.js"></script>
<script src="/webgl/lessons/resources/prettify.js"></script>
<script src="/webgl/lessons/resources/lesson.js" type="module"></script>
<script>
</script>


</html>




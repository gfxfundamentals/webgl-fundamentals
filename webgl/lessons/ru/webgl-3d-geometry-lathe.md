Title: WebGL 3D - –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏
Description: –ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å –≥–µ–æ–º–µ—Ç—Ä–∏—é —Å –ø–æ–º–æ—â—å—é –∫—Ä–∏–≤—ã—Ö –ë–µ–∑—å–µ
TOC: WebGL 3D - –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏


–ü–æ–∂–∞–ª—É–π, —ç—Ç—É —Å—Ç–∞—Ç—å—é –Ω–µ–ª—å–∑—è –Ω–∞–∑–≤–∞—Ç—å —Å–∞–º–æ–π –≤–æ—Å—Ç—Ä–µ–±–æ–≤–∞–Ω–Ω–æ–π, –Ω–æ –º–Ω–µ –æ–Ω–∞ –ø–æ–∫–∞–∑–∞–ª–æ—Å—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–π,
–ø–æ—ç—Ç–æ–º—É —è —Ä–µ—à–∏–ª –µ—ë –Ω–∞–ø–∏—Å–∞—Ç—å. –ù–µ —Ç–æ, —á—Ç–æ–±—ã —è —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –¥–µ–ª–∞—Ç—å —Ç–∞–∫, –∫–∞–∫ –æ–ø–∏—Å–∞–Ω–æ –≤ —Å—Ç–∞—Ç—å–µ,
—Å–∫–æ—Ä–µ–π –º–Ω–µ —Ö–æ—á–µ—Ç—Å—è –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –≤–µ—â–∏, –∫–∞—Å–∞—é—â–∏–µ—Å—è —Å–æ–∑–¥–∞–Ω–∏—è 3D-–º–æ–¥–µ–ª–µ–π –≤ WebGL.

–û–¥–Ω–∞–∂–¥—ã –º–µ–Ω—è –∫—Ç–æ-—Ç–æ —Å–ø—Ä–æ—Å–∏–ª, –∫–∞–∫ —Å–¥–µ–ª–∞—Ç—å –º–æ–¥–µ–ª—å –∫–µ–≥–ª–∏ –¥–ª—è –±–æ—É–ª–∏–Ω–≥–∞ –≤ WebGL.
*–ü—Ä–∞–≤–∏–ª—å–Ω—ã–º* –æ—Ç–≤–µ—Ç–æ–º –±—ã–ª–æ –±—ã "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É –¥–ª—è 3D-–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è,
–Ω–∞–ø–æ–¥–æ–±–∏–µ [Blender](https://blender.org), [Maya](https://www.autodesk.com/products/maya/overview),
[3D Studio Max](https://www.autodesk.com/products/3ds-max/overview),
[Cinema 4D](https://www.maxon.net/en/products/cinema-4d/overview/) –∏ —Ç.–¥.".
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ—ë –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–µ–≥–ª–∏, –∑–∞—Ç–µ–º —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –º–æ–¥–µ–ª—å –∏
–∑–∞–≥—Ä—É–∑–∏—Ç–µ –µ—ë –≤ —Å–≤–æ—ë–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏. ([–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—Å—Ç—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º
—è–≤–ª—è–µ—Ç—Å—è OBJ](https://ru.wikipedia.org/wiki/Obj)).

–ù–æ —Å–ø—É—Å—Ç—è –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è —è –ø–æ–¥—É–º–∞–ª - –∞ —á—Ç–æ, –µ—Å–ª–∏ —á–µ–ª–æ–≤–µ–∫—É –Ω—É–∂–Ω–æ –±—ã–ª–æ
—Å–¥–µ–ª–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è?

–£ –º–µ–Ω—è –ø–æ—è–≤–∏–ª–æ—Å—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–¥–µ–π. –û–¥–Ω–∞ –∏–∑ –Ω–∏—Ö - —Å–¥–µ–ª–∞—Ç—å —Ü–∏–ª–∏–Ω–¥—Ä, –∞ –∑–∞—Ç–µ–º
—Å—É–∑–∏—Ç—å –µ–≥–æ –≤ –Ω—É–∂–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö —á–µ—Ä–µ–∑ —Å–∏–Ω—É—Å–æ–∏–¥—É. –ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ –≤—ã –Ω–µ
–ø–æ–ª—É—á–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–π –ø–ª–∞–≤–Ω–æ—Å—Ç–∏ –≤ –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏. –û–±—ã—á–Ω—ã–π —Ü–∏–ª–∏–Ω–¥—Ä —Å–æ—Å—Ç–æ–∏—Ç
–∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ä–∞–≤–Ω–æ—É–¥–∞–ª—ë–Ω–Ω—ã—Ö –∫–æ–ª–µ—Ü, –Ω–æ –≤ –º–µ—Å—Ç–∞—Ö –∏–∑–≥–∏–±–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ
–±–æ–ª—å—à–µ –∫–æ–ª–µ—Ü, —á—Ç–æ–±—ã –¥–æ—Å—Ç–∏—á—å –Ω—É–∂–Ω–æ–π –ø–ª–∞–≤–Ω–æ—Å—Ç–∏.

–í –ø–∞–∫–µ—Ç–µ –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã –±—ã –Ω–∞—á–∞–ª–∏ —Å —Å–æ–∑–¥–∞–Ω–∏—è –¥–≤—É–º–µ—Ä–Ω–æ–≥–æ —Å–∏–ª—É—ç—Ç–∞,
—Ç–æ—á–Ω–µ–µ —Å –∫—Ä–∏–≤–æ–π –ª–∏–Ω–∏–∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –≥—Ä–∞–Ω–∏ –¥–≤—É–º–µ—Ä–Ω–æ–≥–æ —Å–∏–ª—É—ç—Ç–∞. –ê –∑–∞—Ç–µ–º
—Å–æ–∑–¥–∞–ª–∏ 3D-–æ–±—ä–µ–∫—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∏–ª—É—ç—Ç–∞. –≠—Ç–æ–≥–æ –º–æ–∂–Ω–æ –¥–æ—Å—Ç–∏—á—å, –≤—Ä–∞—â–∞—è —Å–∏–ª—É—ç—Ç
–≤–æ–∫—Ä—É–≥ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π –æ—Å–∏, —Å–æ–∑–¥–∞–≤–∞—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –≤—Ä–∞—â–µ–Ω–∏—è —Ç–æ—á–∫–∏ —Ñ–∏–≥—É—Ä—ã. –≠—Ç–∞
—Ç–µ—Ö–Ω–∏–∫–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ —Å–æ–∑–¥–∞—Ç—å –ª—é–±–æ–π –∑–∞–∫—Ä—É–≥–ª—ë–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç –≤—Ä–æ–¥–µ —à–∞—Ä–∞,
—Å—Ç–∞–∫–∞–Ω–∞, –±–µ–π—Å–±–æ–ª—å–Ω–æ–π –±–∏—Ç—ã, –±—É—Ç—ã–ª–∫–∏, –ª–∞–º–ø–æ—á–∫–∏ –∏ —Ç.–¥.

–ö–∞–∫ –∂–µ –Ω–∞–º —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ? –î–ª—è –Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –∫—Ä–∏–≤—É—é. –ó–∞—Ç–µ–º –Ω–∞–º
–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–ª—É—á–∏—Ç—å —Ç–æ—á–∫–∏ —ç—Ç–æ–π –∫—Ä–∏–≤–æ–π. –ó–∞—Ç–µ–º, –≤—Ä–∞—â–∞—è —ç—Ç–∏ —Ç–æ—á–∫–∏ –≤–æ–∫—Ä—É–≥
–∫–∞–∫–æ–π-—Ç–æ –æ—Å–∏ —Å –ø–æ–º–æ—â—å—é [–º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ –º–∞—Ç—Ä–∏—Ü](webgl-2d-matrices.html),
–º—ã –ø–æ—Å—Ç—Ä–æ–∏–º —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∏.

–°–∞–º–æ–π —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω–æ–π –∫—Ä–∏–≤–æ–π –≤ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–π –≥—Ä–∞—Ñ–∏–∫–µ, –ø–æ—Ö–æ–∂–µ,
—è–≤–ª—è–µ—Ç—Å—è –∫—Ä–∏–≤–∞—è –ë–µ–∑—å–µ. –ï—Å–ª–∏ –≤—ã –∫–æ–≥–¥–∞-–ª–∏–±–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–ª–∏ –∫—Ä–∏–≤—É—é –≤
[Adobe Illustrator](https://www.adobe.com/products/illustrator.html),
–∏–ª–∏ [Inkscape](https://inkscape.org/en/), –∏–ª–∏
[Affinity Designer](https://affinity.serif.com/en-us/designer/),
–∏–ª–∏ –≤ –¥—Ä—É–≥–∏—Ö –ø–æ—Ö–æ–∂–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö, —Ç–æ –≤—ã –∏–º–µ–ª–∏ –¥–µ–ª–æ —Å –∫—Ä–∏–≤–æ–π –ë–µ–∑—å–µ.

–ö—Ä–∏–≤–∞—è –ë–µ–∑—å–µ (–∫—É–±–∏—á–µ—Å–∫–∞—è –∫—Ä–∏–≤–∞—è –ë–µ–∑—å–µ, –µ—Å–ª–∏ –±—ã—Ç—å —Ç–æ—á–Ω—ã–º) —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è
–Ω–∞ –æ—Å–Ω–æ–≤–µ 4 —Ç–æ—á–µ–∫ - 2 –∫–æ–Ω–µ—á–Ω—ã–µ —Ç–æ—á–∫–∏ –∏ 2 "–∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏".

–í–æ—Ç —ç—Ç–∏ 4 —Ç–æ—á–∫–∏:

{{{diagram url="resources/bezier-curve-diagram.html?maxDepth=0" }}}

–í–æ–∑—å–º—ë–º —á–∏—Å–ª–æ –º–µ–∂–¥—É 0 –∏ 1 (–Ω–∞–∑–æ–≤—ë–º –µ–≥–æ `t`), –≥–¥–µ 0 = –Ω–∞—á–∞–ª–æ, –∞ 1 -
–∫–æ–Ω–µ—Ü. –ó–∞—Ç–µ–º –≤—ã—á–∏—Å–ª–∏–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ç–æ—á–∫–∏ `t` –º–µ–∂–¥—É –∫–∞–∂–¥–æ–π –ø–∞—Ä–æ–π
—Ç–æ—á–µ–∫ `P1 P2`, `P2 P3`, `P3 P4`.

{{{diagram url="resources/bezier-curve-diagram.html?maxDepth=1" }}}

–î—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, –ø—Ä–∏ `t = .25`, –≤—ã –≤—ã—á–∏—Å–ª–∏–º 25% –ø—É—Ç–∏ –æ—Ç —Ç–æ—á–∫–∏ `P1`
–¥–æ `P2`, –∑–∞—Ç–µ–º 25% –ø—É—Ç–∏ –æ—Ç —Ç–æ—á–∫–∏ `P2` –¥–æ `P3` –∏, –Ω–∞–∫–æ–Ω–µ—Ü, 25% –ø—É—Ç–∏
–æ—Ç —Ç–æ—á–∫–∏ `P3` –¥–æ `P4`.

–ü–æ—Ç—è–Ω–∏—Ç–µ –∑–∞ —Å–ª–∞–π–¥–µ—Ä –¥–ª—è —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∏ `t`, —Ç–∞–∫–∂–µ —Å –ø–æ–º–æ—â—å—é –º—ã—à–∏ –º–æ–∂–Ω–æ
–ø–µ—Ä–µ–º–µ—â–∞—Ç—å —Ç–æ—á–∫–∏ `P1`, `P2`, `P3` –∏ `P4`.

–î–∞–ª–µ–µ –ø—Ä–æ–¥–µ–ª–∞–µ–º —Ç–æ –∂–µ —Å–∞–º–æ–µ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö —Ç–æ—á–µ–∫ - –≤—ã—á–∏—Å–ª–∏–º `t` –º–µ–∂–¥—É
—Ç–æ—á–∫–∞–º–∏ `Q1 Q2` –∏ `Q2 Q3`.

{{{diagram url="resources/bezier-curve-diagram.html?maxDepth=2" }}}

–ù–∞–∫–æ–Ω–µ—Ü, –Ω–∞—Ö–æ–¥–∏–º `t` –¥–ª—è —Ç–æ—á–µ–∫ `R1 R2`.

{{{diagram url="resources/bezier-curve-diagram.html?maxDepth=3" }}}

–ü–æ–ª–æ–∂–µ–Ω–∏–µ <span style="color: red;">–∫—Ä–∞—Å–Ω–æ–π —Ç–æ—á–∫–∏</span> –∑–∞–¥–∞—ë—Ç –∫—Ä–∏–≤—É—é.

{{{diagram url="resources/bezier-curve-diagram.html?maxDepth=4" }}}

–≠—Ç–æ –∏ –µ—Å—Ç—å –∫—É–±–∏—á–µ—Å–∫–∞—è –∫—Ä–∏–≤–∞—è –ë–µ–∑—å–µ.

–°—Ç–æ–∏—Ç –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ —Ö–æ—Ç—è –æ–ø–∏—Å–∞–Ω–Ω–∞—è –≤—ã—à–µ –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é
3 —Ç–æ—á–µ–∫ –∏–∑ 4, –∑–∞—Ç–µ–º 2 —Ç–æ—á–µ–∫ –∏–∑ 3 –∏, –Ω–∞–∫–æ–Ω–µ—Ü, –æ–¥–Ω–æ–π —Ç–æ—á–∫–∏ –∏–∑ 2 –¥–µ–ª–∞–µ—Ç
—Å–≤–æ—ë –¥–µ–ª–æ, —Ç–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –Ω–µ–ª—å–∑—è –Ω–∞–∑–≤–∞—Ç—å –æ–±—â–µ–ø—Ä–∏–Ω—è—Ç—ã–º. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ
–∫—Ç–æ-—Ç–æ —Ä–∞–∑–æ–±—Ä–∞–ª—Å—è –≤–æ –≤—Å–µ–π –º–∞—Ç–µ–º–∞—Ç–∏–∫–µ –∏ —É–ø—Ä–æ—Å—Ç–∏–ª –≤—Å—ë –¥–æ —Å–ª–µ–¥—É—é—â–µ–π —Ñ–æ—Ä–º—É–ª—ã:

<div class="webgl_center">
<pre class="webgl_math">
invT = (1 - t)
P = P1 * invT^3 +
    P2 * 3 * t * invT^2 +
    P3 * 3 * invT * t^2 +
    P4 * t^3
</pre>
</div>

–≥–¥–µ `P1`, `P2`, `P3`, `P4` - —Ç–æ—á–∫–∏ –∏–∑ –ø—Ä–∏–º–µ—Ä–∞ –≤—ã—à–µ, –∞ `P` -
<span style="color: red;">–∫—Ä–∞—Å–Ω–∞—è —Ç–æ—á–∫–∞</span>.

–í –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö –ø–æ —Ä–∞–±–æ—Ç–µ —Å –≤–µ–∫—Ç–æ—Ä–Ω—ã–º–∏ 2D-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—Ä–æ–¥–µ Adobe Illustrator
–ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –±–æ–ª–µ–µ –¥–ª–∏–Ω–Ω—ã—Ö –∫—Ä–∏–≤—ã—Ö –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ
–º–∞–ª–µ–Ω—å–∫–∏—Ö –∫—Ä–∏–≤—ã—Ö –∏–∑ 4 —Ç–æ—á–µ–∫, —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö –Ω–∞–º–∏ –≤—ã—à–µ. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
–±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ø—Ä–æ–≥—Ä–∞–º–º —Ñ–∏–∫—Å–∏—Ä—É—é—Ç –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ –≤–æ–∫—Ä—É–≥ –æ–±—â–∏—Ö –Ω–∞—á–∞–ª—å–Ω–æ–π
–∏ –∫–æ–Ω–µ—á–Ω–æ–π —Ç–æ—á–∫–∏ —Ç–∞–∫, —á—Ç–æ–±—ã –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ –≤—Å–µ–≥–¥–∞ –±—ã–ª–∏ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã
–¥—Ä—É–≥ –¥—Ä—É–≥—É –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –æ–±—â–µ–π —Ç–æ—á–∫–∏.

–ù–∞ —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–∏–º–µ—Ä–µ –ø—Ä–∏ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–∏ `P3` –∏–ª–∏ `P5` –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–∞—è –∏–º
—Ç–æ—á–∫–∞ –±—É–¥–µ—Ç —Ç–∞–∫–∂–µ —Å–º–µ—â–∞—Ç—å—Å—è.

{{{diagram url="resources/bezier-curve-edit.html" }}}

–ó–∞–º–µ—Ç—å—Ç–µ, —á—Ç–æ –∫—Ä–∏–≤–∞—è `P1,P2,P3,P4` - —ç—Ç–æ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–∞—è –∫—Ä–∏–≤–∞—è, –∫–∞–∫ –∏
–∫—Ä–∏–≤–∞—è `P4,P5,P6,P7`. –ò–º–µ–Ω–Ω–æ –∫–æ–≥–¥–∞ `P3` –∏ `P5` –Ω–∞—Ö–æ–¥—è—Ç—Å—è –Ω–∞ —Å—Ç—Ä–æ–≥–æ
–ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω–∞—Ö –æ—Ç `P4`, –æ–Ω–∏ –≤—ã–≥–ª—è–¥—è—Ç –∫–∞–∫ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞—è –∫—Ä–∏–≤–∞—è.
–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –ø–æ–∑–≤–æ–ª—è—é—Ç –æ—Ç–∫—Ä–µ–ø–∏—Ç—å `P3` –∏ `P5` –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞ –∏
–ø–æ–∑–≤–æ–ª—è—Ç—å —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ—Å—Ç—Ä—ã–µ —É–≥–ª—ã. –°–Ω–∏–º–∏—Ç–µ –ø–æ–º–µ—Ç–∫—É –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è
—Ç–æ—á–µ–∫ –∏ –ø–æ—Ç—è–Ω–∏—Ç–µ –∑–∞ `P3` –∏–ª–∏ `P5`, —Ç–æ–≥–¥–∞ —Å—Ç–∞–Ω–µ—Ç –æ—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ –ø–µ—Ä–µ–¥
–Ω–∞–º–∏ –¥–≤–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫—Ä–∏–≤—ã–µ.

–î–∞–ª–µ–µ –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∫–∞–∫–∏–º-—Ç–æ –æ–±—Ä–∞–∑–æ–º —Å–æ–∑–¥–∞—Ç—å —Ç–æ—á–∫–∏ –ø–æ –Ω–∞—à–µ–π –∫—Ä–∏–≤–æ–π.
–ü–æ —Ñ–æ—Ä–º—É–ª–µ –≤—ã—à–µ –º—ã –º–æ–∂–µ–º —Å–æ–∑–¥–∞—Ç—å —Ç–æ—á–∫—É –¥–ª—è –∑–Ω–∞—á–µ–Ω–∏—è `t` —Å–ª–µ–¥—É—é—â–∏–º
–æ–±—Ä–∞–∑–æ–º:

    function getPointOnBezierCurve(points, offset, t) {
      const invT = (1 - t);
      return v2.add(v2.mult(points[offset + 0], invT * invT * invT),
                    v2.mult(points[offset + 1], 3 * t * invT * invT),
                    v2.mult(points[offset + 2], 3 * invT * t * t),
                    v2.mult(points[offset + 3], t * t * t));
    }

–¢–æ–≥–¥–∞ –º—ã —Å–º–æ–∂–µ–º —Å–æ–∑–¥–∞—Ç—å –Ω–∞–±–æ—Ä —Ç–æ—á–µ–∫ –∫—Ä–∏–≤–æ–π:

    function getPointsOnBezierCurve(points, offset, numPoints) {
      const points = [];
      for (let i = 0; i < numPoints; ++i) {
        const t = i / (numPoints - 1);
        points.push(getPointOnBezierCurve(points, offset, t));
      }
      return points;
    }

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —è –¥–æ–±–∞–≤–∏–ª –Ω–µ–±–æ–ª—å—à–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏-–ø–æ–º–æ—â–Ω–∏–∫–∏ JavaScript
`v2.mult` –∏ `v2.add` –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã —Å —Ç–æ—á–∫–∞–º–∏.

{{{diagram url="resources/bezier-curve-diagram.html?maxDepth=0&showCurve=true&showPoints=true" }}}

–í—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫ –Ω–∞ –ø—Ä–∏–≤–µ–¥—ë–Ω–Ω–æ–π –¥–∏–∞–≥—Ä–∞–º–º–µ. –î–ª—è —Ä–µ–∑–∫–∏—Ö –∏–∑–≥–∏–±–æ–≤
–ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –±–æ–ª—å—à–µ —Ç–æ—á–µ–∫. –ï—Å–ª–∏ –∂–µ –∫—Ä–∏–≤–∞—è –±–æ–ª—å—à–µ –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç —Ä–æ–≤–Ω—É—é –ª–∏–Ω–∏—é,
–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ–Ω—å—à–µ —Ç–æ—á–µ–∫. –û–¥–Ω–æ –∏–∑ —Ä–µ—à–µ–Ω–∏–π - –ø—Ä–æ–≤–µ—Ä—è—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ –∫—Ä–∏–≤–∞—è
–∫—Ä–∏–≤–∞—è. –ï—Å–ª–∏ –ª–∏–Ω–∏—è —Å–ª–∏—à–∫–æ–º –∫—Ä–∏–≤–∞—è, –º–æ–∂–Ω–æ —Ä–∞–∑–±–∏—Ç—å –µ—ë –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏.

–†–∞–∑–±–∏—Ç—å –∫—Ä–∏–≤—É—é —Å–æ–≤—Å–µ–º –Ω–µ—Å–ª–æ–∂–Ω–æ. –ï—Å–ª–∏ —Å–Ω–æ–≤–∞ –≤–∑–≥–ª—è–Ω—É—Ç—å –Ω–∞ —Ä–∞–∑–Ω—ã–µ —É—Ä–æ–≤–Ω–∏
–∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏, —Ç–æ—á–∫–∏ `P1`, `Q1`, `R1` –∏ –ö–†–ê–°–ù–ê–Ø —Ç–æ—á–∫–∞ —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç –æ–¥–Ω—É
–∫—Ä–∏–≤—É—é, –∞ —Ç–æ—á–∫–∏ –ö–†–ê–°–ù–ê–Ø, `R2`, `Q3`, `P4` –æ–±—Ä–∞–∑—É—é—Ç –≤—Ç–æ—Ä—É—é –∫—Ä–∏–≤—É—é –¥–ª—è
–ª—é–±–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è t. –î—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, –º—ã –≤ –ª—é–±–æ–º –º–µ—Å—Ç–µ –º–æ–∂–µ–º —Ä–∞–∑–±–∏—Ç—å
–æ–¥–Ω—É –∫—Ä–∏–≤—É—é –∏ –ø–æ–ª—É—á–∏—Ç—å –∏–∑ –Ω–µ—ë –¥–≤–µ –∫—Ä–∏–≤—ã—Ö.

{{{diagram url="resources/bezier-curve-diagram.html?maxDepth=4&show2Curves=true" }}}

–¢–µ–ø–µ—Ä—å –Ω–∞–º –æ—Å—Ç–∞–ª–æ—Å—å —Ä–µ—à–∏—Ç—å, –Ω—É–∂–Ω–æ –ª–∏ —Ä–∞–∑–¥–µ–ª—è—Ç—å –∫—Ä–∏–≤—É—é –∏–ª–∏ –Ω–µ—Ç. –ü–æ—Å–º–æ—Ç—Ä–µ–≤ –ø–æ
–∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É —è –Ω–∞—à—ë–ª [—Ñ—É–Ω–∫—Ü–∏—é](https://seant23.wordpress.com/2010/11/12/offset-bezier-curves/),
–∫–æ—Ç–æ—Ä–∞—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ä–æ–≤–Ω–∞—è –Ω–∞—à–∞ –∫—Ä–∏–≤–∞—è –ª–∏–Ω–∏—è.

    function flatness(points, offset) {
      const p1 = points[offset + 0];
      const p2 = points[offset + 1];
      const p3 = points[offset + 2];
      const p4 = points[offset + 3];

      let ux = 3 * p2[0] - 2 * p1[0] - p4[0]; ux *= ux;
      let uy = 3 * p2[1] - 2 * p1[1] - p4[1]; uy *= uy;
      let vx = 3 * p3[0] - 2 * p4[0] - p1[0]; vx *= vx;
      let vy = 3 * p3[1] - 2 * p4[1] - p1[1]; vy *= vy;

      if(ux < vx) {
        ux = vx;
      }

      if(uy < vy) {
        uy = vy;
      }

      return ux + uy;
    }

–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–æ–≤–Ω–æ—Å—Ç–∏ –≤ –Ω–∞—à–µ–π —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è
—Å–æ–∑–¥–∞—ë—Ç —Ç–æ—á–∫–∏ –∫—Ä–∏–≤–æ–π. –î–ª—è –Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä–∏–º, —Å–∏–ª—å–Ω–æ –ª–∏ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç
–ø—Ä—è–º–æ–π –ª–∏–Ω–∏–∏ –Ω–∞—à–∞ –∫—Ä–∏–≤–∞—è. –ï—Å–ª–∏ —Å–∏–ª—å–Ω–æ, –º—ã –±—É–¥–µ–º —Ä–∞–∑–±–∏–≤–∞—Ç—å –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ
–ª–∏–Ω–∏–π, –∏–Ω–∞—á–µ –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–∏–º —Ç–æ—á–∫–∏ –≤ –º–∞—Å—Å–∏–≤.

    function getPointsOnBezierCurveWithSplitting(points, offset, tolerance, newPoints) {
      const outPoints = newPoints || [];
      if (flatness(points, offset) < tolerance) {

        // –∫—Ä–∏–≤–∏–∑–Ω–∞ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –¥–æ–ø—É—Å—Ç–∏–º–æ–≥–æ, –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–∏–º —Ç–æ—á–∫–∏ –∫—Ä–∏–≤–æ–π
        outPoints.push(points[offset + 0]);
        outPoints.push(points[offset + 3]);

      } else {

        // –∫—Ä–∏–≤–∏–∑–Ω–∞ –±–æ–ª—å—à–µ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –ø–æ—Ä–æ–≥–∞, —Ä–∞–∑–±–∏–≤–∞–µ–º
        const t = .5;
        const p1 = points[offset + 0];
        const p2 = points[offset + 1];
        const p3 = points[offset + 2];
        const p4 = points[offset + 3];

        const q1 = v2.lerp(p1, p2, t);
        const q2 = v2.lerp(p2, p3, t);
        const q3 = v2.lerp(p3, p4, t);

        const r1 = v2.lerp(q1, q2, t);
        const r2 = v2.lerp(q2, q3, t);

        const red = v2.lerp(r1, r2, t);

        // –ø–µ—Ä–≤–∞—è –ø–æ–ª–æ–≤–∏–Ω–∞
        getPointsOnBezierCurveWithSplitting([p1, q1, r1, red], 0, tolerance, outPoints);
        // –≤—Ç–æ—Ä–∞—è –ø–æ–ª–æ–≤–∏–Ω–∞
        getPointsOnBezierCurveWithSplitting([red, r2, q3, p4], 0, tolerance, outPoints);

      }
      return outPoints;
    }

{{{diagram url="resources/bezier-curve-diagram.html?maxDepth=0&showCurve=true&showTolerance=true" }}}

–° —ç—Ç–∏–º –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º –º—ã –º–æ–∂–µ–º –±—ã—Ç—å —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —É –Ω–∞—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–æ—á–µ–∫,
–æ–¥–Ω–∞–∫–æ, –∞–ª–≥–æ—Ä–∏—Ç–º –Ω–µ –∑–∞–±–æ—Ç–∏—Ç—Å—è –æ —Ç–æ–º, —á—Ç–æ –ø–æ–ª—É—á–∞—Ç—Å—è –ª–∏—à–Ω–∏–µ —Ç–æ—á–∫–∏.

–î–ª—è —ç—Ç–æ–≥–æ –Ω–∞–º –ø–æ–º–æ–∂–µ—Ç –¥—Ä—É–≥–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º, –∫–æ—Ç–æ—Ä—ã–π —è —Ç–∞–∫–∂–µ –Ω–∞—à—ë–ª –Ω–∞ –ø—Ä–æ—Å—Ç–æ—Ä–∞—Ö —Å–µ—Ç–∏ -
[–∞–ª–≥–æ—Ä–∏—Ç–º –†–∞–º–µ—Ä–∞-–î—É–≥–ª–∞—Å–∞-–ü–µ–∫–µ—Ä–∞](https://ru.wikipedia.org/wiki/–ê–ª–≥–æ—Ä–∏—Ç–º_–†–∞–º–µ—Ä–∞_‚Äî_–î—É–≥–ª–∞—Å–∞_‚Äî_–ü–µ–∫–µ—Ä–∞)

–ò—Ç–∞–∫, —É –Ω–∞—Å –µ—Å—Ç—å –º–∞—Å—Å–∏–≤ —Ç–æ—á–µ–∫. –ú—ã –Ω–∞—Ö–æ–¥–∏–º —Ç–æ—á–∫—É –Ω–∞ –∫—Ä–∏–≤–æ–π, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —É–¥–∞–ª—ë–Ω–Ω—É—é
–æ—Ç –æ—Ç—Ä–µ–∑–∫–∞, —Å–æ–µ–¥–∏–Ω—è—é—â–µ–≥–æ –ø–µ—Ä–≤—É—é –∏ –ø–æ—Å–ª–µ–¥–Ω—é—é —Ç–æ—á–∫—É –∫—Ä–∏–≤–æ–π. –ü–æ—Ç–æ–º –º—ã —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º
—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç –æ—Ç—Ä–µ–∑–∫–∞ –¥–æ —ç—Ç–æ–π —Ç–æ—á–∫–∏ —Å —É—Å–ª–æ–≤–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º. –ï—Å–ª–∏ –ø–æ–ª—É—á–µ–Ω–Ω–æ–µ
—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–Ω—å—à–µ —ç—Ç–æ–≥–æ —É—Å–ª–æ–≤–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è, –º—ã –ø—Ä–æ—Å—Ç–æ –æ—Å—Ç–∞–≤–ª—è–µ–º 2 –∫–æ–Ω–µ—á–Ω—ã–µ —Ç–æ—á–∫–∏,
–∞ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ –∏—Å–∫–ª—é—á–∞–µ–º. –ò–Ω–∞—á–µ –º—ã —Å–Ω–æ–≤–∞ –∑–∞–ø—É—Å–∫–∞–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º - –æ–¥–∏–Ω —Ä–∞–∑ –Ω–∞
–ª–∏–Ω–∏–∏, –Ω–∞—á–∏–Ω–∞—é—â–µ–π—Å—è —Å –ø–µ—Ä–≤–æ–π —Ç–æ—á–∫–∏ –∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—â–µ–π—Å—è –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —É–¥–∞–ª—ë–Ω–Ω–æ–π
—Ç–æ—á–∫–µ, –∞ –≤—Ç–æ—Ä–æ–π —Ä–∞–∑ –∑–∞–ø—É—Å–∫–∞–µ–º –Ω–∞ –ª–∏–Ω–∏–∏, –Ω–∞—á–∏–Ω–∞—é—â–µ–π—Å—è –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —É–¥–∞–ª—ë–Ω–Ω–æ–π
—Ç–æ—á–∫–µ –∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—â–µ–π—Å—è –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Ç–æ—á–∫–µ –∫—Ä–∏–≤–æ–π.

    function simplifyPoints(points, start, end, epsilon, newPoints) {
      const outPoints = newPoints || [];

      // –Ω–∞—Ö–æ–¥–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —É–¥–∞–ª—ë–Ω–Ω—É—é —Ç–æ—á–∫—É –æ—Ç –æ—Ç—Ä–µ–∑–∫–∞, —Å–æ–µ–¥–∏–Ω—è—é—â–µ–≥–æ –∫–æ–Ω–µ—á–Ω—ã–µ —Ç–æ—á–∫–∏
      const s = points[start];
      const e = points[end - 1];
      let maxDistSq = 0;
      let maxNdx = 1;
      for (let i = start + 1; i < end - 1; ++i) {
        const distSq = v2.distanceToSegmentSq(points[i], s, e);
        if (distSq > maxDistSq) {
          maxDistSq = distSq;
          maxNdx = i;
        }
      }

      // –µ—Å–ª–∏ —Ç–æ—á–∫–∞ —Å–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ
      if (Math.sqrt(maxDistSq) > epsilon) {

        // —Ä–∞–∑–¥–µ–ª—è–µ–º
        simplifyPoints(points, start, maxNdx + 1, epsilon, outPoints);
        simplifyPoints(points, maxNdx, end, epsilon, outPoints);

      } else {

        // –∏–Ω–∞—á–µ –æ—Å—Ç–∞–≤–ª—è–µ–º –∫–æ–Ω–µ—á–Ω—ã–µ —Ç–æ—á–∫–∏
        outPoints.push(s, e);
      }

      return outPoints;
    }

–§—É–Ω–∫—Ü–∏—è `v2.distanceToSegmentSq` –≤—ã—á–∏—Å–ª—è–µ—Ç –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç —Ç–æ—á–∫–∏ –¥–æ –æ—Ç—Ä–µ–∑–∫–∞.
–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ, —Ç–∞–∫ –∫–∞–∫ –µ–≥–æ –ø—Ä–æ—â–µ –≤—ã—á–∏—Å–ª–∏—Ç—å –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å
–Ω–∞—Å—Ç–æ—è—â–∏–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ–º. –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–∞–º–æ–π –æ—Ç–¥–∞–ª—ë–Ω–Ω–æ–π –æ—Ç –æ—Ç—Ä–µ–∑–∫–∞ —Ç–æ—á–∫–∏ –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–≥–æ
—Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –Ω–∞–º –≤–ø–æ–ª–Ω–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ.

–ù–∏–∂–µ –∏–¥—ë—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è. –†–µ–≥—É–ª–∏—Ä—É—è —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ, –º–æ–∂–Ω–æ –Ω–∞–±–ª—é–¥–∞—Ç—å, –∫–∞–∫
–¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –∏–ª–∏ —É–¥–∞–ª—è—é—Ç—Å—è —Ç–æ—á–∫–∏.

{{{diagram url="resources/bezier-curve-diagram.html?maxDepth=0&showCurve=true&showDistance=true" }}}

–í–µ—Ä–Ω—ë–º—Å—è –∫ –Ω–∞—à–µ–π –∫–µ–≥–ª–µ. –ú—ã –º–æ–≥–ª–∏ –±—ã —Å–¥–µ–ª–∞—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∏–≤–µ–¥—ë–Ω–Ω–æ–≥–æ
–≤—ã—à–µ –∫–æ–¥–∞. –†–µ–¥–∞–∫—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –±—ã –º–æ–≥ –¥–æ–±–∞–≤–ª—è—Ç—å –∏ —É–¥–∞–ª—è—Ç—å —Ç–æ—á–∫–∏, –∑–∞–∫—Ä–µ–ø–ª—è—Ç—å –∏ –æ—Ç–∫—Ä–µ–ø–ª—è—Ç—å
–∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏, –≤—ã–ø–æ–ª–Ω—è—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ –Ω–∞–∑–∞–¥ –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ... –ù–æ –µ—Å—Ç—å —Å–ø–æ—Å–æ–± –ø–æ–ø—Ä–æ—â–µ.
–ú—ã –º–æ–∂–µ–º –ø—Ä–æ—Å—Ç–æ –≤–∑—è—Ç—å –æ–¥–∏–Ω –∏–∑ –∑—Ä–µ–ª—ã—Ö —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–≤, —É–ø–æ–º—è–Ω—É—Ç—ã—Ö –≤—ã—à–µ. [–Ø –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª
—ç—Ç–æ—Ç –æ–Ω–ª–∞–π–Ω-—Ä–µ–¥–∞–∫—Ç–æ—Ä](https://svg-edit.github.io/svgedit/).

–í–æ—Ç —Ç–∞–∫–æ–π –∫–æ–Ω—Ç—É—Ä –∫–µ–≥–ª–∏ —É –º–µ–Ω—è –ø–æ–ª—É—á–∏–ª—Å—è:

<img class="webgl_center" src="resources/bowling-pin-silhouette.svg" width="50%" height="50%" />

–ö–æ–Ω—Ç—É—Ä —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 4 –∫—Ä–∏–≤—ã—Ö –ë–µ–∑—å–µ. –î–∞–Ω–Ω—ã–µ –¥–ª—è —ç—Ç–æ–π –∫—Ä–∏–≤–æ–π –≤—ã–≥–ª—è–¥—è—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

    <path fill="none" stroke-width="5" d="
       m44,434
       c18,-33 19,-66 15,-111
       c-4,-45 -37,-104 -39,-132
       c-2,-28 11,-51 16,-81
       c5,-30 3,-63 -36,-63
    "/>

[–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É—è –¥–∞–Ω–Ω—ã–µ](https://developer.mozilla.org/en/docs/Web/SVG/Tutorial/Paths), –º—ã –ø–æ–ª—É—á–∏–º —Ç–æ—á–∫–∏.

            ___
    44, 371,   |
    62, 338,   | 1-—è –∫—Ä–∏–≤–∞—è
    63, 305,___|__
    59, 260,___|  |
    55, 215,      | 2-—è –∫—Ä–∏–≤–∞—è
    22, 156,______|__
    20, 128,______|  |
    18, 100,         | 3-—è –∫—Ä–∏–≤–∞—è
    31,  77,_________|__
    36,  47,_________|  |
    41,  17,            | 4-—è –∫—Ä–∏–≤–∞—è
    39, -16,            |
     0, -16,____________|

–ò—Ç–∞–∫, —É –Ω–∞—Å –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫—Ä–∏–≤—ã—Ö, —Ç–µ–ø–µ—Ä—å –Ω–∞–º –Ω—É–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å —Ç–æ—á–∫–∏ –¥–ª—è –Ω–∏—Ö.

    // –ø–æ–ª—É—á–∞–µ–º —Ç–æ—á–∫–∏ –≤–¥–æ–ª—å –≤—Å–µ—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤
    function getPointsOnBezierCurves(points, tolerance) {
      const newPoints = [];
      const numSegments = (points.length - 1) / 3;
      for (let i = 0; i < numSegments; ++i) {
        const offset = i * 3;
        getPointsOnBezierCurveWithSplitting(points, offset, tolerance, newPoints);
      }
      return newPoints;
    }

–ü–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ç–æ—á–∫–∏ –Ω–µ –ø–æ–º–µ—à–∞–µ—Ç –ø—Ä–æ—Ä—è–¥–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–µ–π `simplifyPoints`.

–¢–µ–ø–µ—Ä—å –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–Ω—É—Ç—å –Ω–∞—à–∏ —Ç–æ—á–∫–∏ –≤–æ–∫—Ä—É–≥ –æ—Å–∏ –∫–µ–≥–ª–∏. –ú—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ–º, –∏–∑ —Å–∫–æ–ª—å–∫–∏—Ö —á–∞—Å—Ç–µ–π
–±—É–¥–µ—Ç —Å–æ—Å—Ç–æ—è—Ç—å –∫–µ–≥–ª—è, –∏ –¥–ª—è –∫–∞–∂–¥–æ–π —á–∞—Å—Ç–∏ —Å–æ–∑–¥–∞—ë–º —Ç–æ—á–∫–∏, –ø–æ–≤–æ—Ä–∞—á–∏–≤–∞—è –∏—Å—Ö–æ–¥–Ω—É—é –∫—Ä–∏–≤—É—é
–≤–æ–∫—Ä—É–≥ –æ—Å–∏ Y, –∏—Å–ø–æ–ª—å–∑—É—è [–º–∞—Ç–µ–º–∞—Ç–∏–∫—É –º–∞—Ç—Ä–∏—Ü](webgl-2d-matrices.html). –ö–æ–≥–¥–∞ –≤—Å–µ —Ç–æ—á–∫–∏
—Å–æ–∑–¥–∞–Ω—ã, –º—ã —Å–æ–µ–¥–∏–Ω—è–µ–º –∏—Ö —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞–º–∏, –∏—Å–ø–æ–ª—å–∑—É—è –∏–Ω–¥–µ–∫—Å—ã.

    // –ø–æ–≤–æ—Ä–æ—Ç –≤–æ–∫—Ä—É–≥ –æ—Å–∏ Y
    function lathePoints(points,
                         startAngle,   // –Ω–∞—á–∞–ª—å–Ω—ã–π —É–≥–æ–ª (—Ä–∞–≤–µ–Ω 0)
                         endAngle,     // –∫–æ–Ω–µ—á–Ω—ã–π —É–≥–æ–ª (—Ä–∞–≤–µ–Ω Math.PI * 2)
                         numDivisions, // —Å–∫–æ–ª—å–∫–æ —á–∞—Å—Ç–µ–π –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–æ –ø—Ä–∏ –≤—Ä–∞—â–µ–Ω–∏–∏
                         capStart,     // true, —á—Ç–æ–±—ã –∑–∞–º—ã–∫–∞—Ç—å –Ω–∞—á–∞–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏
                         capEnd) {     // true, —á—Ç–æ–±—ã –∑–∞–º—ã–∫–∞—Ç—å –∫–æ–Ω–µ—á–Ω—ã–µ —Ç–æ—á–∫–∏
      const positions = [];
      const texcoords = [];
      const indices = [];

      const vOffset = capStart ? 1 : 0;
      const pointsPerColumn = points.length + vOffset + (capEnd ? 1 : 0);
      const quadsDown = pointsPerColumn - 1;

      // —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ—á–µ–∫
      for (let division = 0; division <= numDivisions; ++division) {
        const u = division / numDivisions;
        const angle = lerp(startAngle, endAngle, u) % (Math.PI * 2);
        const mat = m4.yRotation(angle);
        if (capStart) {
          // –¥–æ–±–∞–≤–ª—è–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ –ø–æ –æ—Å–∏ Y
          positions.push(0, points[0][1], 0);
          texcoords.push(u, 0);
        }
        points.forEach((p, ndx) => {
          const tp = m4.transformPoint(mat, [...p, 0]);
          positions.push(tp[0], tp[1], tp[2]);
          const v = (ndx + vOffset) / quadsDown;
          texcoords.push(u, v);
        });
        if (capEnd) {
          // –¥–æ–±–∞–≤–ª—è–µ–º –∫–æ–Ω–µ—á–Ω—ã–µ —Ç–æ—á–∫–∏ –ø–æ –æ—Å–∏ Y
          positions.push(0, points[points.length - 1][1], 0);
          texcoords.push(u, 1);
        }
      }

      // —Å–æ–∑–¥–∞—ë–º –∏–Ω–¥–µ–∫—Å—ã
      for (let division = 0; division < numDivisions; ++division) {
        const column1Offset = division * pointsPerColumn;
        const column2Offset = column1Offset + pointsPerColumn;
        for (let quad = 0; quad < quadsDown; ++quad) {
          indices.push(column1Offset + quad, column2Offset + quad, column1Offset + quad + 1);
          indices.push(column1Offset + quad + 1, column2Offset + quad, column2Offset + quad + 1);
        }
      }

      return {
        position: positions,
        texcoord: texcoords,
        indices: indices,
      };
    }

–ü—Ä–∏–≤–µ–¥—ë–Ω–Ω—ã–π –∫–æ–¥ —Å–æ–∑–¥–∞—ë—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏ —Ç–µ–∫—Å—Ç—É—Ä–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, –∑–∞—Ç–µ–º —Å–æ–∑–¥–∞—ë—Ç –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è
–¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –∏–∑ –Ω–∏—Ö —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ `capStart` –∏ `capEnd` –æ—Ç–≤–µ—á–∞—é—Ç –∑–∞
—Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–º—ã–∫–∞—é—â–∏—Ö —Ç–æ—á–µ–∫. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –º—ã –±—ã —Å–æ–∑–¥–∞–≤–∞–ª–∏ –∂–µ—Å—Ç—è–Ω—É—é –±–∞–Ω–∫—É. –≠—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
—É–∫–∞–∑—ã–≤–∞–ª–∏ –±—ã, –Ω—É–∂–Ω–æ –ª–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –¥–Ω–æ –∏ –∫—Ä—ã—à–∫—É.

–ò—Å–ø–æ–ª—å–∑—É—è –Ω–∞—à [—É–ø—Ä–æ—â—ë–Ω–Ω—ã–π –∫–æ–¥](webgl-less-code-more-fun.html), –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ —ç—Ç–∏—Ö –¥–∞–Ω–Ω—ã—Ö –º—ã
—Å–æ–∑–¥–∞—ë–º –±—É—Ñ–µ—Ä—ã WebGL:

    const tolerance = 0.15;
    const distance = .4;
    const divisions = 16;
    const startAngle = 0;
    const endAngle = Math.PI * 2;
    const capStart = true;
    const capEnd = true;

    const tempPoints = getPointsOnBezierCurves(curvePoints, tolerance);
    const points = simplifyPoints(tempPoints, 0, tempPoints.length, distance);
    const arrays = lathePoints(points, startAngle, endAngle, divisions, capStart, capEnd);
    const extents = getExtents(arrays.position);
    if (!bufferInfo) {
      bufferInfo = webglUtils.createBufferInfoFromArrays(gl, arrays);

–í–æ—Ç, —á—Ç–æ —É –Ω–∞—Å –ø–æ–ª—É—á–∏–ª–æ—Å—å:

{{{example url="../webgl-3d-lathe-step-01.html" }}}

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –∫–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ–ª–æ–∂–µ–Ω–∏–µ —Å–ª–∞–π–¥–µ—Ä–æ–≤.

–û–¥–Ω–∞–∫–æ, –∑–¥–µ—Å—å –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º–∞. –í–∫–ª—é—á–∏—Ç–µ –≥–∞–ª–∫—É "triangles" –∏ –≤—ã –∑–∞–º–µ—Ç–∏—Ç–µ, —á—Ç–æ —Ç–µ–∫—Å—Ç—É—Ä–∞
–Ω–∞–ª–æ–∂–µ–Ω–∞ –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ. –ü—Ä–∏—á–∏–Ω–∞ –≤ —Ç–æ–º, —á—Ç–æ —Ç–µ–∫—Å—Ç—É—Ä–Ω–∞—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ `v` –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞
–∏–Ω–¥–µ–∫—Å–µ —Ç–æ—á–µ–∫ –∫—Ä–∏–≤–æ–π –ª–∏–Ω–∏–∏. –ï—Å–ª–∏ –±—ã –æ–Ω–∏ –±—ã–ª–∏ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ –ø–æ –∫—Ä–∏–≤–æ–π,
–≤—Å—ë –º–æ–≥–ª–æ –±—ã –ø–æ–ª—É—á–∏—Ç—å—Å—è. –¢–µ–ø–µ—Ä—å –∂–µ –Ω–∞–º –ø—Ä–∏–¥—ë—Ç—Å—è –ø—Ä–∏–¥—É–º–∞—Ç—å —á—Ç–æ-—Ç–æ –µ—â—ë.

–ù–∞–ø—Ä–∏–º–µ—Ä, –º–æ–∂–Ω–æ –ø—Ä–æ–π—Ç–∏—Å—å –ø–æ —Ç–æ—á–∫–∞–º, –≤—ã—á–∏—Å–ª–∏—Ç—å –æ–±—â—É—é –¥–ª–∏–Ω—É –∫—Ä–∏–≤–æ–π –∏ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ
–∫–∞–∂–¥–æ–π —Ç–æ—á–∫–∏ –Ω–∞ —ç—Ç–æ–π –∫—Ä–∏–≤–æ–π. –ó–∞—Ç–µ–º –¥–µ–ª–µ–Ω–∏–µ–º –Ω–∞ –¥–ª–∏–Ω—É –º—ã –º–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å –±–æ–ª–µ–µ
–ø–æ–¥—Ö–æ–¥—è—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è `v`.

    // –ø–æ–≤–æ—Ä–æ—Ç –≤–æ–∫—Ä—É–≥ –æ—Å–∏ Y
    function lathePoints(points,
                         startAngle,   // –Ω–∞—á–∞–ª—å–Ω—ã–π —É–≥–æ–ª (—Ä–∞–≤–µ–Ω 0)
                         endAngle,     // –∫–æ–Ω–µ—á–Ω—ã–π —É–≥–æ–ª (—Ä–∞–≤–µ–Ω Math.PI * 2)
                         numDivisions, // —Å–∫–æ–ª—å–∫–æ —á–∞—Å—Ç–µ–π –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–æ –ø—Ä–∏ –≤—Ä–∞—â–µ–Ω–∏–∏
                         capStart,     // true, —á—Ç–æ–±—ã –∑–∞–º—ã–∫–∞—Ç—å –Ω–∞—á–∞–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏
                         capEnd) {     // true, —á—Ç–æ–±—ã –∑–∞–º—ã–∫–∞—Ç—å –∫–æ–Ω–µ—á–Ω—ã–µ —Ç–æ—á–∫–∏
      const positions = [];
      const texcoords = [];
      const indices = [];

      const vOffset = capStart ? 1 : 0;
      const pointsPerColumn = points.length + vOffset + (capEnd ? 1 : 0);
      const quadsDown = pointsPerColumn - 1;

    +  // —Å–æ–∑–¥–∞—ë–º v-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
    +  let vcoords = [];
    +
    +  // –≤—ã—á–∏—Å–ª—è–µ–º –æ–±—â—É—é –¥–ª–∏–Ω—É –∏ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –∫–∞–∂–¥–æ–π —Ç–æ—á–∫–∏
    +  let length = 0;
    +  for (let i = 0; i < points.length - 1; ++i) {
    +    vcoords.push(length);
    +    length += v2.distance(points[i], points[i + 1]);
    +  }
    +  vcoords.push(length);  // –ø–æ—Å–ª–µ–¥–Ω—è—è —Ç–æ—á–∫–∞
    +
    +  // –¥–µ–ª–∏–º –∫–∞–∂–¥–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ –æ–±—â—É—é –¥–ª–∏–Ω—É
    +  vcoords = vcoords.map(v => v / length);

      // —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ—á–µ–∫
      for (let division = 0; division <= numDivisions; ++division) {
        const u = division / numDivisions;
        const angle = lerp(startAngle, endAngle, u) % (Math.PI * 2);
        const mat = m4.yRotation(angle);
        if (capStart) {
          // –¥–æ–±–∞–≤–ª—è–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ –ø–æ –æ—Å–∏ Y
          positions.push(0, points[0][1], 0);
          texcoords.push(u, 0);
        }
        points.forEach((p, ndx) => {
          const tp = m4.transformPoint(mat, [...p, 0]);
          positions.push(tp[0], tp[1], tp[2]);
    *      texcoords.push(u, vcoords[ndx]);
        });
        if (capEnd) {
          // –¥–æ–±–∞–≤–ª—è–µ–º –∫–æ–Ω–µ—á–Ω—ã–µ —Ç–æ—á–∫–∏ –ø–æ –æ—Å–∏ Y
          positions.push(0, points[points.length - 1][1], 0);
          texcoords.push(u, 1);
        }
      }

      // —Å–æ–∑–¥–∞—ë–º –∏–Ω–¥–µ–∫—Å—ã
      for (let division = 0; division < numDivisions; ++division) {
        const column1Offset = division * pointsPerColumn;
        const column2Offset = column1Offset + pointsPerColumn;
        for (let quad = 0; quad < quadsDown; ++quad) {
          indices.push(column1Offset + quad, column1Offset + quad + 1, column2Offset + quad);
          indices.push(column1Offset + quad + 1, column2Offset + quad + 1, column2Offset + quad);
        }
      }

      return {
        position: positions,
        texcoord: texcoords,
        indices: indices,
      };
    }

–ü–æ–ª—É—á–∏–ª–æ—Å—å –ø–æ–ª—É—á—à–µ

{{{example url="../webgl-3d-lathe-step-02.html" }}}

–ù–æ —Ç–µ–∫—Å—Ç—É—Ä–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –Ω–µ –∏–¥–µ–∞–ª—å–Ω—ã. –ú—ã –Ω–µ —Ä–µ—à–∏–ª–∏, —á—Ç–æ –¥–µ–ª–∞—Ç—å —Å –∑–∞–∫—Ä—ã–≤–∞—é—â–∏–º–∏ —Ç–æ—á–∫–∞–º–∏.
–≠—Ç–æ –µ—â—ë –æ–¥–Ω–∞ –ø—Ä–∏—á–∏–Ω–∞, –ø–æ—á–µ–º—É –≤–∞–º —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è. –ú—ã –º–æ–≥–ª–∏ –±—ã
–ø—Ä–æ–±–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –∏–¥–µ–∏ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è uv-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –¥–ª—è –∑–∞–∫—Ä—ã–≤–∞—é—â–∏—Ö —Ç–æ—á–µ–∫, –Ω–æ –≤—Ä—è–¥ –ª–∏ –æ–Ω–∏ –Ω–∞–º
—Å–∏–ª—å–Ω–æ –ø–æ–º–æ–≥–ª–∏. –ï—Å–ª–∏ –≤—ã –ø–æ–∏—â–µ—Ç–µ [—Ç–µ–∫—Å—Ç—É—Ä–Ω—É—é –∫–∞—Ä—Ç—É –±–æ—á–∫–∏](https://www.google.com/search?q=uv+map+a+barrel),
–≤—ã —É–≤–∏–¥–∏—Ç–µ, —á—Ç–æ –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–¥–µ–∞–ª—å–Ω—ã—Ö UV-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –Ω–µ —Å—Ç–æ–ª—å–∫–æ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞, —Å–∫–æ–ª—å–∫–æ
–ø—Ä–æ–±–ª–µ–º–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –∏ –≤–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è —Ö–æ—Ä–æ—à–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∑–∞–¥–∞–Ω–∏—è —ç—Ç–∏—Ö –¥–∞–Ω–Ω—ã—Ö.

–ò—Ç–∞–∫, –∏–¥—ë–º –¥–∞–ª—å—à–µ. –î–æ —ç—Ç–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –º—ã –≤—ã–ø—É—Å–∫–∞–ª–∏ –∏–∑ –≤–∏–¥—É –æ–¥–Ω—É –≤–µ—â—å - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª–∏.

–ú—ã –º–æ–≥–ª–∏ –±—ã –≤—ã—á–∏—Å–ª–∏—Ç—å –Ω–æ—Ä–º–∞–ª—å –¥–ª—è –∫–∞–∂–¥–æ–π —Ç–æ—á–∫–∏ –∫—Ä–∏–≤–æ–π. –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ, –µ—Å–ª–∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫
—Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–º –≤—ã—à–µ –ø—Ä–∏–º–µ—Ä–∞–º, –º—ã —É–≤–∏–¥–∏–º, —á—Ç–æ –ª–∏–Ω–∏—è –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏ `R1` –∏ `R2` —è–≤–ª—è–µ—Ç—Å—è
–∫–∞—Å–∞—Ç–µ–ª—å–Ω–æ–π –∫ –∫—Ä–∏–≤–æ–π.

<img class="webgl_center" src="resources/tangent-to-curve.png" width="50%" />

–ê –Ω–æ—Ä–º–∞–ª—å - —ç—Ç–æ –ø–µ—Ä–ø–µ–Ω–¥–∏–∫—É–ª—è—Ä –∫ –∫–∞—Å–∞—Ç–µ–ª—å–Ω–æ–π, –ø–æ—ç—Ç–æ–º—É, –∏—Å–ø–æ–ª—å–∑—É—è –∫–∞—Å–∞—Ç–µ–ª—å–Ω—ã–µ,
–º–æ–∂–Ω–æ –ª–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –Ω–æ—Ä–º–∞–ª–∏.

–ù–æ –¥–∞–≤–∞–π—Ç–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–¥–µ–ª–∞—Ç—å –ø–æ–¥—Å–≤–µ—á–Ω–∏–∫ —Å –ø–æ–¥–æ–±–Ω—ã–º –∫–æ–Ω—Ç—É—Ä–æ–º:

<img class="webgl_center" src="resources/candle-holder.svg" width="50%" />

–ù–∞—Ä—è–¥—É —Å–æ –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –≥–ª–∞–¥–∫–∏—Ö —É—á–∞—Å—Ç–∫–æ–≤ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –∏ –æ—Å—Ç—Ä—ã–µ —É–≥–ª—ã. –ö–∞–∫ –ø–æ–Ω—è—Ç—å, –∫–∞–∫–∏–µ
–Ω–æ—Ä–º–∞–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å? –î–µ–ª–æ —É—Å—É–≥—É–±–ª—è–µ—Ç—Å—è —Ç–µ–º, —á—Ç–æ –¥–ª—è –æ—Å—Ç—Ä—ã—Ö —É–≥–ª–æ–≤ –Ω—É–∂–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ
–≤–µ—Ä—à–∏–Ω—ã. –í–µ—Ä—à–∏–Ω—ã –≤–∫–ª—é—á–∞—é—Ç –≤ —Å–µ–±—è –∫–∞–∫ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—É, —Ç–∞–∫ –∏ –Ω–æ—Ä–º–∞–ª—å, –ø–æ—ç—Ç–æ–º—É –µ—Å–ª–∏ –Ω–∞–º
–Ω—É–∂–Ω–∞ –µ—â—ë –æ–¥–Ω–∞ –Ω–æ—Ä–º–∞–ª—å, —Ç–æ –Ω–∞–º –Ω—É–∂–Ω–∞ –µ—â—ë –æ–¥–Ω–∞ –≤–µ—Ä—à–∏–Ω–∞. –ò–º–µ–Ω–Ω–æ –ø–æ—ç—Ç–æ–º—É –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏
–∫—É–±–∞ –Ω—É–∂–Ω–æ –∫–∞–∫ –º–∏–Ω–∏–º—É–º 24 –≤–µ—Ä—à–∏–Ω—ã. –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ —É –∫—É–±–∞ –≤—Å–µ–≥–æ 8 —É–≥–ª–æ–≤, –∫–∞–∂–¥–∞—è
–≥—Ä–∞–Ω—å –Ω—É–∂–¥–∞–µ—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –Ω–æ—Ä–º–∞–ª–∏ –≤ –∫–∞–∂–¥–æ–º —É–≥–ª—É –∫—É–±–∞.

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫—É–±–∞ –∑–∞–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –Ω–æ—Ä–º–∞–ª–∏ –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ, –Ω–æ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Ñ–∏–≥—É—Ä
–ø—Ä–æ—Å—Ç–æ–≥–æ —Å–ø–æ—Å–æ–±–∞ –Ω–µ –Ω–∞–π—Ç–∏.

–í—Å–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–¥–µ—Ä–∂–∞—Ç —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ—Ä–º–∞–ª–µ–π. –û–±—ã—á–Ω–æ
–¥–ª—è –∫–∞–∂–¥–æ–π –≤–µ—Ä—à–∏–Ω—ã –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —É—Å—Ä–µ–¥–Ω—ë–Ω–Ω–∞—è –Ω–æ—Ä–º–∞–ª—å –º–µ–∂–¥—É –≤—Å–µ–º–∏ –ø–æ–ª–∏–≥–æ–Ω–∞–º–∏, –≤ –∫–æ—Ç–æ—Ä—ã–µ –≤—Ö–æ–¥–∏—Ç
–¥–∞–Ω–Ω–∞—è –≤–µ—Ä—à–∏–Ω–∞. –ù–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∑–∞–¥–∞—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É–≥–æ–ª. –ï—Å–ª–∏ —É–≥–æ–ª –º–µ–∂–¥—É –ø–æ–ª–∏–≥–æ–Ω–∞–º–∏
—Å –æ–±—â–µ–π –≤–µ—Ä—à–∏–Ω–æ–π –±–æ–ª—å—à–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ, —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤–∞—è –≤–µ—Ä—à–∏–Ω–∞.

–†–µ–∞–ª–∏–∑—É–µ–º –¥–∞–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º.

    function generateNormals(arrays, maxAngle) {
      const positions = arrays.position;
      const texcoords = arrays.texcoord;

      // —Å–Ω–∞—á–∞–ª–∞ –≤—ã—á–∏—Å–ª—è–µ–º –Ω–æ—Ä–º–∞–ª—å –¥–ª—è –∫–∞–∂–¥–æ–π –≥—Ä–∞–Ω–∏
      let getNextIndex = makeIndiceIterator(arrays);
      const numFaceVerts = getNextIndex.numElements;
      const numVerts = arrays.position.length;
      const numFaces = numFaceVerts / 3;
      const faceNormals = [];

      // –í—ã—á–∏—Å–ª—è–µ–º –Ω–æ—Ä–º–∞–ª—å –¥–ª—è –∫–∞–∂–¥–æ–π –≥—Ä–∞–Ω–∏.
      // –ü—Ä–∏ —ç—Ç–æ–º —Å–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –≤–µ—Ä—à–∏–Ω—É –¥–ª—è –∫–∞–∂–¥–æ–π –≥—Ä–∞–Ω–∏
      for (let i = 0; i < numFaces; ++i) {
        const n1 = getNextIndex() * 3;
        const n2 = getNextIndex() * 3;
        const n3 = getNextIndex() * 3;

        const v1 = positions.slice(n1, n1 + 3);
        const v2 = positions.slice(n2, n2 + 3);
        const v3 = positions.slice(n3, n3 + 3);

        faceNormals.push(m4.normalize(m4.cross(m4.subtractVectors(v1, v2), m4.subtractVectors(v3, v2))));
      }

      let tempVerts = {};
      let tempVertNdx = 0;

      // –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤–µ—Ä—à–∏–Ω —Ç–æ—á–Ω–æ —Å–æ–≤–ø–∞–¥–∞—é—Ç –º–µ–∂–¥—É —Å–æ–±–æ–π

      function getVertIndex(x, y, z) {

        const vertId = x + "," + y + "," + z;
        const ndx = tempVerts[vertId];
        if (ndx !== undefined) {
          return ndx;
        }
        const newNdx = tempVertNdx++;
        tempVerts[vertId] = newNdx;
        return newNdx;
      }

      // –ù–∞—Ö–æ–¥–∏–º –≤–µ—Ä—à–∏–Ω—ã, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –≥—Ä–∞–Ω—è–º.
      // –ü—Ä–∏ —ç—Ç–æ–º –Ω–µ–ª—å–∑—è –æ–±—Ä–∞—â–∞—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –Ω–∞ –≥—Ä–∞–Ω–∏ (—Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∏)
      // —Ç–∞–∫ –∫–∞–∫, –Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ —É –Ω–∞—Å –µ—Å—Ç—å –æ–±—ã–∫–Ω–æ–≤–µ–Ω–Ω—ã–π —Ü–∏–ª–∏–Ω–¥—Ä,
      //
      //
      //      3-4
      //     /   \
      //    2     5   –ï—Å–ª–∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ —Ü–∏–ª–∏–Ω–¥—Ä, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è
      //    |     |   –≤ —Ç–æ—á–∫–µ S –∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –≤ E, —Ç–æ—á–∫–∏ E –∏ S –Ω–µ
      //    1     6   —è–≤–ª—è—é—Ç—Å—è –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ —Ç–æ—á–∫–æ–π —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è
      //     \   /    –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —Ç–∞–∫ –∫–∞–∫ —É –Ω–∏—Ö —Ä–∞–∑–Ω—ã–µ UV-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã.
      //      S/E
      //
      // –≤–µ—Ä—à–∏–Ω—ã –≤ –Ω–∞—á–∞–ª–µ –∏ –≤ –∫–æ–Ω—Ü–µ –Ω–µ –±—É–¥—É—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç—å –æ–¥–Ω–æ–π —Ç–æ—á–∫–µ
      // —Ç–∞–∫ –∫–∞–∫ —É –Ω–∏—Ö —Ä–∞–∑–Ω—ã–µ UV-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, –Ω–æ –µ—Å–ª–∏ –º—ã –±—É–¥–µ–º —Ç–∞–∫
      // —Å—á–∏—Ç–∞—Ç—å, –º—ã –ø–æ–ª—É—á–∏–º –Ω–µ–≤–µ—Ä–Ω—ã–µ –Ω–æ—Ä–º–∞–ª–∏.

      const vertIndices = [];
      for (let i = 0; i < numVerts; ++i) {
        const offset = i * 3;
        const vert = positions.slice(offset, offset + 3);
        vertIndices.push(getVertIndex(vert));
      }

      // –ø—Ä–æ—Ö–æ–¥–∏–º –ø–æ –∫–∞–∂–¥–æ–π –≤–µ—Ä—à–∏–Ω–µ –∏ –∑–∞–ø–æ–º–∏–Ω–∞–µ–º, –∫–∞–∫–∏–º –≥—Ä–∞–Ω—è–º –æ–Ω–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç
      const vertFaces = [];
      getNextIndex.reset();
      for (let i = 0; i < numFaces; ++i) {
        for (let j = 0; j < 3; ++j) {
          const ndx = getNextIndex();
          const sharedNdx = vertIndices[ndx];
          let faces = vertFaces[sharedNdx];
          if (!faces) {
            faces = [];
            vertFaces[sharedNdx] = faces;
          }
          faces.push(i);
        }
      }

      // —Ç–µ–ø–µ—Ä—å –ø—Ä–æ—Ö–æ–¥–∏–º –ø–æ –∫–∞–∂–¥–æ–π –≥—Ä–∞–Ω–∏ –∏ –≤—ã—á–∏—Å–ª—è–µ–º –Ω–æ—Ä–º–∞–ª—å –¥–ª—è –∫–∞–∂–¥–æ–π
      // –≤–µ—Ä—à–∏–Ω—ã –≥—Ä–∞–Ω–∏. –£—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ç–µ –≥—Ä–∞–Ω–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö
      // maxAngle. –†–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –±—É–¥—É—Ç –º–∞—Å—Å–∏–≤—ã newPositions, newTexcoords
      // –∏ newNormals, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –≤–µ—Ä—à–∏–Ω.
      tempVerts = {};
      tempVertNdx = 0;
      const newPositions = [];
      const newTexcoords = [];
      const newNormals = [];

      function getNewVertIndex(x, y, z, nx, ny, nz, u, v) {
        const vertId =
            x + "," + y + "," + z + "," +
            nx + "," + ny + "," + nz + "," +
            u + "," + v;

        const ndx = tempVerts[vertId];
        if (ndx !== undefined) {
          return ndx;
        }
        const newNdx = tempVertNdx++;
        tempVerts[vertId] = newNdx;
        newPositions.push(x, y, z);
        newNormals.push(nx, ny, nz);
        newTexcoords.push(u, v);
        return newNdx;
      }

      const newVertIndices = [];
      getNextIndex.reset();
      const maxAngleCos = Math.cos(maxAngle);
      // –¥–ª—è –∫–∞–∂–¥–æ–π –≥—Ä–∞–Ω–∏
      for (let i = 0; i < numFaces; ++i) {
        // –ø–æ–ª—É—á–∞–µ–º –Ω–æ—Ä–º–∞–ª—å —Ç–µ–∫—É—â–µ–π –≥—Ä–∞–Ω–∏
        const thisFaceNormal = faceNormals[i];
        // –¥–ª—è –∫–∞–∂–¥–æ–π –≤–µ—Ä—à–∏–Ω—ã –≥—Ä–∞–Ω–∏
        for (let j = 0; j < 3; ++j) {
          const ndx = getNextIndex();
          const sharedNdx = vertIndices[ndx];
          const faces = vertFaces[sharedNdx];
          const norm = [0, 0, 0];
          faces.forEach(faceNdx => {
            // –≥—Ä–∞–Ω—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ —Ç—É –∂–µ —Å—Ç–æ—Ä–æ–Ω—É?
            const otherFaceNormal = faceNormals[faceNdx];
            const dot = m4.dot(thisFaceNormal, otherFaceNormal);
            if (dot > maxAngleCos) {
              m4.addVectors(norm, otherFaceNormal, norm);
            }
          });
          m4.normalize(norm, norm);
          const poffset = ndx * 3;
          const toffset = ndx * 2;
          newVertIndices.push(getNewVertIndex(
              positions[poffset + 0], positions[poffset + 1], positions[poffset + 2],
              norm[0], norm[1], norm[2],
              texcoords[toffset + 0], texcoords[toffset + 1]));
        }
      }

      return {
        position: newPositions,
        texcoord: newTexcoords,
        normal: newNormals,
        indices: newVertIndices,
      };

    }

    function makeIndexedIndicesFn(arrays) {
      const indices = arrays.indices;
      let ndx = 0;
      const fn = function() {
        return indices[ndx++];
      };
      fn.reset = function() {
        ndx = 0;
      };
      fn.numElements = indices.length;
      return fn;
    }

    function makeUnindexedIndicesFn(arrays) {
      let ndx = 0;
      const fn = function() {
        return ndx++;
      };
      fn.reset = function() {
        ndx = 0;
      }
      fn.numElements = arrays.positions.length / 3;
      return fn;
    }

    function makeIndiceIterator(arrays) {
      return arrays.indices
          ? makeIndexedIndicesFn(arrays)
          : makeUnindexedIndicesFn(arrays);
    }

–í —ç—Ç–æ–º –∫–æ–¥–µ –º—ã —Å–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞—ë–º –Ω–æ—Ä–º–∞–ª–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –≥—Ä–∞–Ω–∏ (–∫–∞–∂–¥–æ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞) –∏–∑ –∏—Å—Ö–æ–¥–Ω—ã—Ö —Ç–æ—á–µ–∫.
–ó–∞—Ç–µ–º –º—ã –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–∞–±–æ—Ä –∏–Ω–¥–µ–∫—Å–æ–≤ –≤–µ—Ä—à–∏–Ω –¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Ç–æ—á–µ–∫. –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–≤–æ—Ä–æ—Ç–∞
–ø–µ—Ä–≤–∞—è –∏ –ø–æ—Å–ª–µ–¥–Ω—è—è —Ç–æ—á–∫–∞ –¥–æ–ª–∂–Ω—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å, –æ–¥–Ω–∞–∫–æ, –æ–Ω–∏ –∏–º–µ—é—Ç —Ä–∞–∑–Ω—ã–µ UV-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ,
–Ω–µ —Å—á–∏—Ç–∞—é—Ç—Å—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ —Ç–æ—á–∫–∞–º–∏ - –∏–º–µ–Ω–Ω–æ –ø–æ—ç—Ç–æ–º—É –Ω–∞–º –Ω—É–∂–µ–Ω –Ω–∞–±–æ—Ä, –≥–¥–µ –º—ã –Ω–∞—Ö–æ–¥–∏–º –ø–æ–¥–æ–±–Ω—ã–µ —Ç–æ—á–∫–∏.
–î–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –Ω–æ—Ä–º–∞–ª–µ–π –Ω–∞–º –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –ø–µ—Ä–≤–∞—è –∏ –ø–æ—Å–ª–µ–¥–Ω—è—è —Ç–æ—á–∫–∞ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–ª–∏—Å—å –∫–∞–∫ –æ–¥–Ω–∞ –∏ —Ç–∞ –∂–µ —Ç–æ—á–∫–∞.

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –¥–ª—è –∫–∞–∂–¥–æ–π –≤–µ—Ä—à–∏–Ω—ã –º—ã –Ω–∞—Ö–æ–¥–∏–º –≤—Å–µ –≥—Ä–∞–Ω–∏, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –æ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.

–ò, –Ω–∞–∫–æ–Ω–µ—Ü, –º—ã —É—Å—Ä–µ–¥–Ω—è–µ–º –Ω–æ—Ä–º–∞–ª–∏ –≤—Å–µ—Ö –≥—Ä–∞–Ω–µ–π –¥–ª—è –∫–∞–∂–¥–æ–π –≤–µ—Ä—à–∏–Ω—ã, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —Ç–µ—Ö, –∫–æ—Ç–æ—Ä—ã–µ
–ø—Ä–µ–≤—ã—à–∞—é—Ç –ø–æ—Ä–æ–≥ `maxAngle` - –¥–ª—è —Ç–∞–∫–∏—Ö –º—ã —Å–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π –Ω–∞–±–æ—Ä –≤–µ—Ä—à–∏–Ω.

–†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç —Å–ª–µ–¥—É—é—â–∏–º:

{{{example url="../webgl-3d-lathe-step-03.html"}}}

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –º—ã –ø–æ–ª—É—á–∏–ª–∏ –æ—Å—Ç—Ä—ã–µ —É–≥–ª—ã –≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –Ω–∞–º –º–µ—Å—Ç–∞—Ö. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —É–≤–µ–ª–∏—á–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ
`maxAngle` –∏ –≤—ã —É–≤–∏–¥–∏—Ç–µ, –∫–∞–∫ –æ—Å—Ç—Ä—ã–µ —É–≥–ª—ã —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –ø–ª–∞–≤–Ω—ã–º–∏, –∫–∞–∫ —Ç–æ–ª—å–∫–æ —Å–æ—Å–µ–¥–Ω–∏–µ –≥—Ä–∞–Ω–∏ –ø–æ–ª—É—á–∞—é—Ç
—É—Å—Ä–µ–¥–Ω—ë–Ω–Ω—É—é –Ω–æ—Ä–º–∞–ª—å –≤–º–µ—Å—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –Ω–∞–±–æ—Ä–æ–≤. –¢–∞–∫–∂–µ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å `divisions` –¥–æ –∑–Ω–∞—á–µ–Ω–∏—è 5 –∏–ª–∏
6, –∞ –∑–∞—Ç–µ–º —É–≤–µ–ª–∏—á—å—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ `maxAngle` —Ç–∞–∫, —á—Ç–æ–±—ã –¥–∞–∂–µ –æ—Å—Ç—Ä—ã–µ —É–≥–ª—ã –ø–æ–ª—É—á–∏–ª–∏ –ø–ª–∞–≤–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –æ—Å–≤–µ—â–µ–Ω–∏—è.
–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–µ–∂–∏–º–∞ `mode` –≤ –∑–Ω–∞—á–µ–Ω–∏–µ `lit` –º—ã —É–≤–∏–¥–∏–º, –∫–∞–∫ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –æ–±—ä–µ–∫—Ç –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏
–æ—Å–≤–µ—â–µ–Ω–∏—è - –∏–º–µ–Ω–Ω–æ –æ—Å–≤–µ—â–µ–Ω–∏–µ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏—á–∏–Ω–æ–π, –ø–æ –∫–æ—Ç–æ—Ä–æ–π –º—ã —Ç–∞–∫ –º–Ω–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è —É–¥–µ–ª–∏–ª–∏ –Ω–æ—Ä–º–∞–ª—è–º.

## –ò—Ç–∞–∫, —á—Ç–æ –∂–µ –º—ã —É–∑–Ω–∞–ª–∏?

–ú—ã —É–∑–Ω–∞–ª–∏, —á—Ç–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è 3D-–¥–∞–Ω–Ω—ã—Ö **–ù–£–ñ–ù–û –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨ –ü–†–û–ì–†–ê–ú–ú–£ –î–õ–Ø 3D-–ú–û–î–ï–õ–ò–†–û–í–ê–ù–ò–Ø!!!** üòù

–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —á–µ–≥–æ-—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø–æ–ª–µ–∑–Ω–æ–≥–æ –≤–∞–º, –≤–µ—Ä–æ—è—Ç–Ω–µ–π –≤—Å–µ–≥–æ, –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –∫–∞–∫–æ–π-–Ω–∏–±—É–¥—å
[UV-—Ä–µ–¥–∞–∫—Ç–æ—Ä](https://www.google.com/search?q=uv+editor). –¢–∞–∫–æ–π —Ä–µ–¥–∞–∫—Ç–æ—Ä —Ç–∞–∫–∂–µ –ø–æ–º–æ–∂–µ—Ç –≤ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏
–∫–æ–Ω–µ—á–Ω—ã—Ö —Ç–æ—á–µ–∫. –í–º–µ—Å—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–∏ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–∏ –≤—ã –±—É–¥–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏
—Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω–µ—á–Ω—ã—Ö —Ç–æ—á–µ–∫ –∏ –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è UV-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –¥–ª—è –Ω–∏—Ö. –ö—Ä–æ–º–µ —Ç–æ–≥–æ,
—Ä–µ–¥–∞–∫—Ç–æ—Ä—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç [–≤—ã—Ç—è–≥–∏–≤–∞–Ω–∏–µ –≥—Ä–∞–Ω–µ–π](https://www.google.com/search?q=extruding+model) –∏
[–≤—ã—Ç—è–≥–∏–≤–∞–Ω–∏–µ –ø–æ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏](https://www.google.com/search?q=extruding+along+a+path),
—Ä–∞–±–æ—Ç–∞ –∫–æ—Ç–æ—Ä—ã—Ö –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –¥–æ–≤–æ–ª—å–Ω–æ –æ—á–µ–≤–∏–¥–Ω–æ–π –Ω–∞ –≤—ã—à–µ–ø—Ä–∏–≤–µ–¥—ë–Ω–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è.

## –°—Å—ã–ª–∫–∏

–í –∑–∞–∫–ª—é—á–µ–Ω–∏–∏ —Ö–æ—Ç–µ–ª —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ –Ω–µ –Ω–∞–ø–∏—Å–∞–ª –±—ã —ç—Ç—É —Å—Ç–∞—Ç—å—é –±–µ–∑ [–∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω–æ–π —Å—Ç–∞—Ç—å–∏ –æ –∫—Ä–∏–≤—ã—Ö –ë–µ–∑—å–µ](https://pomax.github.io/bezierinfo/).

<div class="webgl_bottombar">
<h3>–ß—Ç–æ –∑–¥–µ—Å—å –¥–µ–ª–∞–µ—Ç –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–µ –æ—Å—Ç–∞—Ç–∫–∞ –¥–µ–ª–µ–Ω–∏—è?</h3>
<p>–ï—Å–ª–∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é <code>lathePoints</code>, –≤—ã –∑–∞–º–µ—Ç–∏—Ç–µ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–µ
–æ—Å—Ç–∞—Ç–∫–∞ –æ—Ç –¥–µ–ª–µ–Ω–∏—è –ø—Ä–∏ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–∏ —É–≥–ª–∞.</p>
<pre class="prettyprint showlinemods">
for (let division = 0; division <= numDivisions; ++division) {
  const u = division / numDivisions;
*  const angle = lerp(startAngle, endAngle, u) % (Math.PI * 2);
</pre>
<p>–ó–∞—á–µ–º –æ–Ω–∞ –∑–¥–µ—Å—å –Ω—É–∂–Ω–∞?</p>
<p>–ü—Ä–∏ –ø–æ–≤–æ—Ä–æ—Ç–µ —Ç–æ—á–µ–∫ –≤–æ–∫—Ä—É–≥ —Å–≤–æ–µ–π –æ—Å–∏ –Ω–∞–º –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –ø–µ—Ä–≤–∞—è –∏ –ø–æ—Å–ª–µ–¥–Ω—è—è —Ç–æ—á–∫–∞ —Å–æ–≤–ø–∞–¥–∞–ª–∏.
<code>Math.sin(0)</code> –∏ <code>Math.sin(Math.PI * 2)</code> –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–¥–Ω–∏–º –∏ —Ç–µ–º
–∂–µ –∑–Ω–∞—á–µ–Ω–∏–µ–º, –Ω–æ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π –Ω–µ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω—ã, –∏ –¥–∞–∂–µ –∫–æ–≥–¥–∞ –∑–Ω–∞—á–µ–Ω–∏—è –æ—á–µ–Ω—å –±–ª–∏–∑–∫–∏,
–æ–Ω–∏ –≤—Å—ë –∂–µ –Ω–µ –Ω–µ —è–≤–ª—è—é—Ç—Å—è –Ω–∞ 100% –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏.</p>
<p>–≠—Ç–æ –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –æ—Ç–ª–∏—á–∏–µ –ø–æ–≤–ª–∏—è–µ—Ç –Ω–∞ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –Ω–æ—Ä–º–∞–ª–µ–π. –ù–∞–º –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å –≤—Å–µ –≥—Ä–∞–Ω–∏,
–≤ –∫–æ—Ç–æ—Ä—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–∞–Ω–Ω–∞—è –≤–µ—Ä—à–∏–Ω–∞. –ù–∞—Ö–æ–∂–¥–µ–Ω–∏–µ —ç—Ç–∏—Ö –≥—Ä–∞–Ω–µ–π –æ—Å–Ω–æ–≤—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏
–≤–µ—Ä—à–∏–Ω. –ï—Å–ª–∏ –¥–≤–µ –≤–µ—Ä—à–∏–Ω—ã —Ä–∞–≤–Ω—ã, —Ç–æ –¥–ª—è –Ω–∞—Å —ç—Ç–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –æ–¥–Ω–æ–π –≤–µ—Ä—à–∏–Ω–æ–π. –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é,
–∏–∑-–∑–∞ –æ—Ç–ª–∏—á–∏–π –≤ –∑–Ω–∞—á–µ–Ω–∏—è—Ö <code>Math.sin(0)</code> –∏ <code>Math.sin(Math.PI * 2)</code>
–≤–µ—Ä—à–∏–Ω—ã –Ω–µ –±—É–¥—É—Ç —Ä–∞–≤–Ω—ã –∏ –Ω–µ —Å–æ–ª—å—é—Ç—Å—è –≤ –æ–¥–Ω—É –≤–µ—Ä—à–∏–Ω—É. –ê –∑–Ω–∞—á–∏—Ç, –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ –Ω–æ—Ä–º–∞–ª–µ–π
–Ω–µ –≤—Å–µ –≥—Ä–∞–Ω–∏ –ø–æ–ø–∞–¥—É—Ç –≤ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ, —á—Ç–æ –ø—Ä–∏–≤–µ–¥—ë—Ç –∫ –Ω–µ–≤–µ—Ä–Ω—ã–º –Ω–æ—Ä–º–∞–ª—è–º.</p>
<p>–í–æ—Ç –Ω–∞–≥–ª—è–¥–Ω—ã–π –ø—Ä–∏–º–µ—Ä, —á—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç</p>
<img class="webgl_center" src="resources/lathe-normal-seam.png" width="50%" />
<p>–ù–∞ –º–µ—Å—Ç–µ –∑–∞–º—ã–∫–∞–Ω–∏—è –∫–æ–Ω—Ç—É—Ä–∞ –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å —à–æ–≤, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∏–∑-–∑–∞ –µ–¥–≤–∞ –∑–∞–º–µ—Ç–Ω—ã—Ö
–æ—Ç–ª–∏—á–∏–π –≤ –∑–Ω–∞—á–µ–Ω–∏—è—Ö –ø–µ—Ä–≤–æ–π –∏ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—à–∏–Ω—ã.</p>
<p>–ü–µ—Ä–≤–æ–π –º–æ–µ–π –º—ã—Å–ª—å—é –±—ã–ª–æ –∏–∑–º–µ–Ω–∏—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä—è—Ç—å –≤–µ—Ä—à–∏–Ω—ã –Ω–∞
—Ä–∞–≤–µ–Ω—Å—Ç–≤–æ —Å –∫–∞–∫–æ–π-—Ç–æ –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å—é. –ï—Å–ª–∏ –≤–µ—Ä—à–∏–Ω—ã —Ä–∞–≤–Ω—ã –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –¥–æ–ø—É—Å—Ç–∏–º–æ–π –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–∏,
—Ç–æ —ç—Ç–æ –æ–¥–Ω–∞ –∏ —Ç–∞ –∂–µ –≤–µ—Ä—à–∏–Ω–∞. –ß—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ —Ç–∞–∫–æ–≥–æ:</p>
<pre class="prettyprint">
const epsilon = 0.0001;
const tempVerts = [];
function getVertIndex(position) {
  if (tempVerts.length) {
    // –Ω–∞—Ö–æ–¥–∏–º –±–ª–∏–∂–∞–π—à—É—é –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –≤–µ—Ä—à–∏–Ω
    let closestNdx = 0;
    let closestDistSq = v2.distanceSq(position, tempVerts[0]);
    for (let i = 1; i < tempVerts.length; ++i) {
      let distSq = v2.distanceSq(position, tempVerts[i]);
      if (distSq < closestDistSq) {
        closestDistSq = distSq;
        closestNdx = i;
      }
    }
    // –¥–∞–Ω–Ω–∞—è –≤–µ—Ä—à–∏–Ω–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–ª–∏–∑–∫–æ?
    if (closestDistSq < epsilon) {
      // –¥–∞, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∏–Ω–¥–µ–∫—Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –≤–µ—Ä—à–∏–Ω—ã
      return closestNdx;
    }
  }
  // –æ–¥–∏–Ω–∞–∫–æ–≤–∞—è –≤–µ—Ä—à–∏–Ω–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, —Å–æ–∑–¥–∞—ë–º –µ—ë –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –µ—ë –∏–Ω–¥–µ–∫—Å
  tempVerts.push(position);
  return tempVerts.length - 1;
}
</pre>
<p>–ò —ç—Ç–æ —Å—Ä–∞–±–æ—Ç–∞–ª–æ! –®–æ–≤ –∏—Å—á–µ–∑. –ù–æ, –∫ —Å–æ–∂–∞–ª–µ–Ω–∏—é, –¥–∞–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –≤—ã–ø–æ–ª–Ω—è–ª—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥
–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º —Å—Ç–∞–ª–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è. –¢–∞–∫ –∫–∞–∫ —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –≤–æ–∑–≤—Ä–æ—Å–ª–∞ –¥–æ O^2.
–ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —Å–ª–∞–π–¥–µ—Ä—ã –Ω–∞ –º–∞–∫—Å–∏–º—É–º, –º—ã –º–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å –æ–∫–æ–ª–æ 20000 –≤–µ—Ä—à–∏–Ω. –î–ª—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
O^2 –ø–æ–ª—É—á–∏—Ç—Å—è –ø–æ–¥ 300 –º–∏–ª–ª–∏–æ–Ω–æ–≤ –∏—Ç–µ—Ä–∞—Ü–∏–π.</p>
<p>–Ø –æ–±—ã—Å–∫–∞–ª –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –≤ –ø–æ–∏—Å–∫–∞—Ö –ø—Ä–æ—Å—Ç–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è –∏ –Ω–µ –Ω–∞—à—ë–ª –µ–≥–æ. –Ø –¥—É–º–∞–ª –ø–æ–º–µ—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–æ—á–∫–∏ –≤
<a href="https://ru.wikipedia.org/wiki/–û–∫—Ç–æ–¥–µ—Ä–µ–≤–æ">–æ–∫—Ç–æ–¥–µ—Ä–µ–≤–æ</a> –¥–ª—è –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
—Å–æ–≤–ø–∞–¥–∞—é—â–∏—Ö —Ç–æ—á–µ–∫, –Ω–æ –¥–ª—è –æ–¥–Ω–æ–π —Å—Ç–∞—Ç—å–∏ –ø–æ–ª—É—á–∞–ª–æ—Å—å –º–Ω–æ–≥–æ–≤–∞—Ç–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞.</p>
<p>–ò–º–µ–Ω–Ω–æ —Ç–æ–≥–¥–∞ —è –ø–æ–Ω—è–ª, —á—Ç–æ –µ—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –∫–æ–Ω–µ—á–Ω—ã—Ö —Ç–æ—á–∫–∞—Ö, –º–Ω–µ –º–æ–∂–µ—Ç
–ø–æ–º–æ—á—å –æ—Å—Ç–∞—Ç–æ–∫ –æ—Ç –¥–µ–ª–µ–Ω–∏—è. –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ –∫–æ–¥ –≤—ã–≥–ª—è–¥–µ–ª —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:</p>
<pre class="prettyprint">
  const angle = lerp(startAngle, endAngle, u);
</pre>
–ó–∞—Ç–µ–º —è –µ–≥–æ –ø–µ—Ä–µ–ø–∏—Å–∞–ª –Ω–∞ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
<pre class="prettyprint">
  const angle = lerp(startAngle, endAngle, u) % (Math.PI * 2);
</pre>
<p>–ò–∑-–∑–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏ –æ—Å—Ç–∞—Ç–∫–∞ –æ—Ç –¥–µ–ª–µ–Ω–∏—è –¥–ª—è `angle`, –∑–Ω–∞—á–µ–Ω–∏–µ `endAngle`
—Ä–∞–≤–Ω–æ–≥–æ `Math.PI * 2` —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω—É–ª—ë–º, –∞ —ç—Ç–æ —Ç–æ –∂–µ –∑–Ω–∞—á–µ–Ω–∏–µ, —á—Ç–æ –∏ –Ω–∞—á–∞–ª—å–Ω—ã–π
—É–≥–æ–ª. –®–æ–≤ —É—à—ë–ª –∏ –ø—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ —Ä–µ—à–µ–Ω–∞!</p>
<p>–ò –¥–∞–∂–µ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ `distance` –≤ –∑–Ω–∞—á–µ–Ω–∏–µ 0.001 –∏ `divisions` –≤ –∑–Ω–∞—á–µ–Ω–∏–µ 60,
–Ω–∞ –º–æ—ë–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –ø–µ—Ä–µ—Å—á—ë—Ç —Ñ–∏–≥—É—Ä—ã –∑–∞–Ω–∏–º–∞–µ—Ç –æ–∫–æ–ª–æ —Å–µ–∫—É–Ω–¥—ã. –ò —Ö–æ—Ç—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–ø–æ—Å–æ–±—ã
–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –º–æ–µ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞, —è –¥—É–º–∞—é, —á—Ç–æ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–ª–æ–∂–Ω—ã—Ö —Ñ–∏–≥—É—Ä - —ç—Ç–æ –º–µ–¥–ª–µ–Ω–Ω–∞—è
–æ–ø–µ—Ä–∞—Ü–∏—è –≤ —Ü–µ–ª–æ–º. –≠—Ç–æ –ª–∏—à—å –æ–¥–∏–Ω –ø—Ä–∏–º–µ—Ä, –ø–æ—á–µ–º—É 3D-–∏–≥—Ä—ã –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –Ω–∞ —á–∞—Å—Ç–æ—Ç–µ
60fps, –∞ 3D-—Ä–µ–¥–∞–∫—Ç–æ—Ä—ã –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ –æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ–π —á–∞—Å—Ç–æ—Ç–µ –∫–∞–¥—Ä–æ–≤.</p>
</div>

<div class="webgl_bottombar">
<h3>–¢–∞–∫ –ª–∏ —É–∂ –Ω—É–∂–Ω—ã –∑–¥–µ—Å—å –º–∞—Ç—Ä–∏—Ü—ã?</h3>
<p>–ü—Ä–∏ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–∏ –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥ –¥–ª—è –ø–æ–≤–æ—Ä–æ—Ç–∞ —Ç–æ—á–µ–∫:</p>
<pre class="prettyprint">
const mat = m4.yRotation(angle);
...
points.forEach((p, ndx) => {
  const tp = m4.transformPoint(mat, [...p, 0]);
  ...
</pre>
<p>–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ª—é–±–æ–π 3D-—Ç–æ—á–∫–∏ –º–∞—Ç—Ä–∏—Ü–µ–π 4—Ö4 —Ç—Ä–µ–±—É–µ—Ç 16 —É–º–Ω–æ–∂–µ–Ω–∏–π, 12 —Å–ª–æ–∂–µ–Ω–∏–π –∏ 3 –¥–µ–ª–µ–Ω–∏–π. –ú—ã –º–æ–≥–ª–∏ –±—ã
—É–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π —á–µ—Ä–µ–∑ <a href="webgl-2d-rotation.html">–º–∞—Ç–µ–º–∞—Ç–∏–∫—É –ø–æ–≤–æ—Ä–æ—Ç–∞ –µ–¥–∏–Ω–∏—á–Ω–æ–π –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–∏</a>.</p>
<pre class="prettyprint">
const s = Math.sin(angle);
const c = Math.cos(angle);
...
points.forEach((p, ndx) => {
  const x = p[0];
  const y = p[1];
  const z = p[2];
  const tp = [
    x * c - z * s,
    y,
    x * s + z * c,
  ];
  ...
</pre>
<p>–ó–¥–µ—Å—å —Ç–æ–ª—å–∫–æ 4 —É–º–Ω–æ–∂–µ–Ω–∏—è –∏ 2 —Å–ª–æ–∂–µ–Ω–∏—è, –∫ —Ç–æ–º—É –∂–µ –º—ã –æ–±–æ—à–ª–∏—Å—å –±–µ–∑ –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏,
—á—Ç–æ, –≤–µ—Ä–æ—è—Ç–Ω–æ, —Ä–∞–∑ –≤ 6 –±—ã—Å—Ç—Ä–µ–µ.</p>
<p>–°—Ç–æ–∏—Ç –ª–∏ —Ç–æ–≥–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è? –ù—É, –¥–ª—è —ç—Ç–æ–≥–æ —á–∞—Å—Ç–Ω–æ–≥–æ —Å–ª—É—á–∞—è —è –Ω–µ –¥—É–º–∞—é, —á—Ç–æ —ç—Ç–æ —Ç–∞–∫ —É–∂
–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ. –Ø –∑–∞–¥—É–º—ã–≤–∞–ª—Å—è, —á—Ç–æ –≤—ã, –≤–æ–∑–º–æ–∂–Ω–æ, –∑–∞—Ö–æ—Ç–∏—Ç–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤—ã–±–æ—Ä
–æ—Å–∏, –≤–æ–∫—Ä—É–≥ –∫–æ—Ç–æ—Ä–æ–π –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–æ–≤–æ—Ä–æ—Ç. –° –ø–æ–º–æ—â—å—é –º–∞—Ç—Ä–∏—Ü –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã –ª–µ–≥–∫–æ –¥–∞—Ç—å
–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–µ—Ä–µ–¥–∞—Ç—å –æ—Å—å - –ø—Ä–∏–º–µ—Ä–Ω–æ —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:</p>
<pre class="prettyprint">
   const mat = m4.axisRotation(userSuppliedAxis, angle);
</pre>
<p>–ö–∞–∫–æ–π –ø—É—Ç—å –≤—ã–±—Ä–∞—Ç—å - –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–∞—à–∏—Ö –Ω—É–∂–¥. –ù–∞ –º–æ–π –≤–∑–≥–ª—è–¥, –Ω–∞ –ø–µ—Ä–≤–æ–º –º–µ—Å—Ç–µ
–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≥–∏–±–∫–æ—Å—Ç—å, –∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —É–∂–µ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–∞–∫–æ–≥–æ-–ª–∏–±–æ —É—á–∞—Å—Ç–∫–∞
–∫–æ–¥–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω—ã–º.</p>
</div>

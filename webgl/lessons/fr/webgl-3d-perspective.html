<!DOCTYPE html>
<!-- this file is auto-generated from webgl/lessons/fr/webgl-3d-perspective.md. Do not edited directly -->
<!--
Copyright 2012, Gregg Tavares.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are
met:

*   Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.

*   Redistributions in binary form must reproduce the above
    copyright notice, this list of conditions and the following disclaimer
    in the documentation and/or other materials provided with the
    distribution.

*   Neither the name of Gregg Tavares. nor the names of his
    contributors may be used to endorse or promote products derived from
    this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-->
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="How to display perspective in 3D in WebGL">
<meta name="keywords" content="webgl graphics">
<meta name="thumbnail" content="https://webglfundamentals.org/webgl/lessons/screenshots/webgl-3d-perspective_fr.jpg">

<meta property="og:title" content="WebGL - La perspective">
<meta property="og:type" content="website">
<meta property="og:image" content="https://webglfundamentals.org/webgl/lessons/screenshots/webgl-3d-perspective_fr.jpg">
<meta property="og:description" content="How to display perspective in 3D in WebGL">
<meta property="og:url" content="https://webglfundamentals.org/webgl/lessons/fr/webgl-3d-perspective.html">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@greggman">
<meta name="twitter:creator" content="@greggman">
<meta name="twitter:domain" content="webglfundamentals.org">
<meta name="twitter:title" content="WebGL - La perspective">
<meta name="twitter:url" content="https://webglfundamentals.org/webgl/lessons/fr/webgl-3d-perspective.html">
<meta name="twitter:description" content="How to display perspective in 3D in WebGL">
<meta name="twitter:image:src" content="https://webglfundamentals.org/webgl/lessons/screenshots/webgl-3d-perspective_fr.jpg">

<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@graph":[
    {
      "@type":"WebSite",
      "@id":"https://webglfundamentals.org/#website",
      "url":"https://webglfundamentals.org/",
      "name":"WebglFundamentals"
    },
    {
      "@type":"ImageObject",
      "@id":"https://webglfundamentals.org/webgl/lessons/fr/webgl-3d-perspective.html#primaryimage",
      "url":"https://webglfundamentals.org/webgl/lessons/screenshots/webgl-3d-perspective_fr.jpg",
      "width":1200,
      "height":630
    },
    {
      "@type":"WebPage",
      "@id":"https://webglfundamentals.org/webgl/lessons/fr/webgl-3d-perspective.html#webpage",
      "url":"https://webglfundamentals.org/webgl/lessons/fr/webgl-3d-perspective.html",
      "inLanguage":"fr",
      "name":"WebGL - La perspective",
      "keywords":"webgl graphics programming",
      "isPartOf":{
        "@id":"https://webglfundamentals.org/#website"
      },
      "primaryImageOfPage":{
        "@id":"https://webglfundamentals.org/webgl/lessons/fr/webgl-3d-perspective.html#primaryimage"
      }
    }
  ]
}
</script>


<title>WebGL - La perspective</title>
<link href="/webgl/lessons/resources/webglfundamentals-icon.png" rel="shortcut icon" type="image/png">
<link rel="stylesheet" href="/webgl/lessons/lang.css">
<link rel="stylesheet" href="/webgl/lessons/resources/lesson.css">

  <link rel="alternate" hreflang="en" href="https://webglfundamentals.org/webgl/lessons/webgl-3d-perspective.html">
  <link rel="alternate" hreflang="fr" href="https://webglfundamentals.org/webgl/lessons/fr/webgl-3d-perspective.html">
  <link rel="alternate" hreflang="ja" href="https://webglfundamentals.org/webgl/lessons/ja/webgl-3d-perspective.html">
  <link rel="alternate" hreflang="ko" href="https://webglfundamentals.org/webgl/lessons/ko/webgl-3d-perspective.html">
  <link rel="alternate" hreflang="pl" href="https://webglfundamentals.org/webgl/lessons/pl/webgl-3d-perspective.html">
  <link rel="alternate" hreflang="pt-br" href="https://webglfundamentals.org/webgl/lessons/pt-br/webgl-3d-perspective.html">
  <link rel="alternate" hreflang="ru" href="https://webglfundamentals.org/webgl/lessons/ru/webgl-3d-perspective.html">
  <link rel="alternate" hreflang="zh_cn" href="https://webglfundamentals.org/webgl/lessons/zh_cn/webgl-3d-perspective.html">




</head>
<body>
<div class="webgl_navbar">
  <div>
    <select class="language">
    <option value="/webgl/lessons/webgl-3d-perspective.html" >English</a>
    <option value="/webgl/lessons/fr/webgl-3d-perspective.html" selected>Français</a>
    <option value="/webgl/lessons/ja/webgl-3d-perspective.html" >日本語</a>
    <option value="/webgl/lessons/ko/webgl-3d-perspective.html" >한국어</a>
    <option value="/webgl/lessons/pl/webgl-3d-perspective.html" >Polski</a>
    <option value="/webgl/lessons/pt-br/webgl-3d-perspective.html" >Portuguese</a>
    <option value="/webgl/lessons/ru/webgl-3d-perspective.html" >Русский</a>
    <option value="/webgl/lessons/zh_cn/webgl-3d-perspective.html" >简体中文</a>
</select>


    <a href="#toc">Table des Matières</a>
  </div>
</div>
<div class="webgl_header">
  <h1><a href="/webgl/lessons/fr/">WebGLFundamentals.org</a></h1>
<style>
#forkongithub a {
    background: #000;
    color: #fff;
    text-decoration: none;
    font-family: arial,sans-serif;
    text-align: center;
    font-weight: bold;
    padding: 5px 40px;
    font-size: 0.9rem;
    line-height: 2rem;
    position: relative;
    transition: 0.5s;
    display: block;
    width: 300px;
    position: absolute;
    top: 0;
    right: 0;
    transform: translateX(150px) rotate(45deg) translate(10px,70px);
    box-shadow: 4px 4px 10px rgba(0,0,0,0.8);
    pointer-events: auto;
}
#forkongithub a:hover {
    background: #c11;
    color: #fff;
}
#forkongithub a::before,#forkongithub a::after {
    content: "";
    width: 100%;
    display: block;
    position: absolute;
    top: 1px;
    left: 0;
    height: 1px;
    background: #fff;
}
#forkongithub a::after {
    bottom: 1px;
    top: auto;
}

#forkongithub{
    z-index: 9999;
    /* needed for firefox */
    overflow: hidden;
    width: 300px;
    height: 300px;
    position: absolute;
    right: 0;
    top: 0;
    pointer-events: none;
}
#forkongithub svg{
  width: 1em;
  height: 1em;
  vertical-align: middle;
}
@media (max-width: 900px) {
    #forkongithub a{
        line-height: 1.2rem;
    }
}
@media (max-width: 700px) {
  #forkongithub {
    display: none;
  }
}
@media (max-width: 410px) {
    #forkongithub a{
        font-size: 0.7rem;
        transform: translateX(150px) rotate(45deg) translate(20px,40px);
    }
}

</style>
<div id="forkongithub"><a href="https://github.com/gfxfundamentals/webgl-fundamentals">Fix, Fork, Contribute <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 136 133" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(3.92891,0,0,3.92891,67.867,129.125)">
        <path d="M0,-31.904C-8.995,-31.904 -16.288,-24.611 -16.288,-15.614C-16.288,-8.417 -11.621,-2.312 -5.148,-0.157C-4.333,-0.008 -4.036,-0.511 -4.036,-0.943C-4.036,-1.329 -4.05,-2.354 -4.058,-3.713C-8.589,-2.729 -9.545,-5.897 -9.545,-5.897C-10.286,-7.779 -11.354,-8.28 -11.354,-8.28C-12.833,-9.29 -11.242,-9.27 -11.242,-9.27C-9.607,-9.155 -8.747,-7.591 -8.747,-7.591C-7.294,-5.102 -4.934,-5.821 -4.006,-6.238C-3.858,-7.29 -3.438,-8.008 -2.972,-8.415C-6.589,-8.826 -10.392,-10.224 -10.392,-16.466C-10.392,-18.244 -9.757,-19.698 -8.715,-20.837C-8.883,-21.249 -9.442,-22.905 -8.556,-25.148C-8.556,-25.148 -7.188,-25.586 -4.076,-23.478C-2.777,-23.84 -1.383,-24.02 0.002,-24.026C1.385,-24.02 2.779,-23.84 4.08,-23.478C7.19,-25.586 8.555,-25.148 8.555,-25.148C9.444,-22.905 8.885,-21.249 8.717,-20.837C9.761,-19.698 10.392,-18.244 10.392,-16.466C10.392,-10.208 6.583,-8.831 2.954,-8.428C3.539,-7.925 4.06,-6.931 4.06,-5.411C4.06,-3.234 4.04,-1.477 4.04,-0.943C4.04,-0.507 4.333,0 5.16,-0.159C11.628,-2.318 16.291,-8.419 16.291,-15.614C16.291,-24.611 8.997,-31.904 0,-31.904" style="fill:white;"/>
    </g>
</svg>
</a></div>

</div>


<div class="container">
  <div class="lesson-title">
    <h1>WebGL - La perspective</h1>
  </div>
  <div class="lesson">
    <div class="lesson-main">
      <p>Cet article est la suite d&#39;une série de posts consacrés à WebGL. Le premier 
<a href="webgl-fundamentals.html">démarrait avec les bases</a> et le précédent nous faisait entrer dans 
les <a href="webgl-3d-orthographic.html">projections 3D orthographiques</a>.
Si vous ne les avez pas lus vous voulez peut-être y jeter un oeil d&#39;abord.</p>
<p>Dans l&#39;article précédent on a vu comment faire de la 3D mais cette 3D n&#39;avait pas de perspective. 
C&#39;était ce qu&#39;on appelle des vues &quot;orthographiques&quot; qui ont leur utilité mais n&#39;est pas ce que les gens 
veulent en général quand on dit &quot;3D&quot;.</p>
<p>Pour ça on a besoin de perspective. Qu&#39;est-ce que la perspective ? C&#39;est ce qui fait que ce qui est loin
 apparaît plus petit.</p>
<p><img class="webgl_center noinvertdark" width="500" src="../resources/perspective-example.svg" /></p>
<p>En voyant cet exemple on voit que ce qui est à plus grande distance est dessiné en plus petit. Avec notre exemple 
habituel, une façon simple d&#39;implémenter ceci serait de diviser les composantes X et Y de l&#39;espace de projection, par Z.</p>
<p>Pensez-y comme ça : si on a une ligne de (10,15) à (20,15) elle a 10 unités de long. 
Dans notre exemple elle serait dessinée avec 10 pixels de long. Mais si on divise par Z :</p>
<p>Avec Z = 1 :</p>
<pre class="webgl_center">
10 / 1 = 10
20 / 1 = 20
abs(10-20) = 10
</pre>

<p>Toujours 10 pixels de long. Si Z = 2 :</p>
<pre class="webgl_center">
10 / 2 = 5
20 / 2 = 10
abs(5 - 10) = 5
</pre>

<p>5 pixels long.  Z = 3 :</p>
<pre class="webgl_center">
10 / 3 = 3.333
20 / 3 = 6.666
abs(3.333 - 6.666) = 3.333
</pre>

<p>Quand Z augmente, notre dessin deviendrait plus petit. Si on divise dans l&#39;espace de projection 
on aura de meilleurs résultats parce que Z sera un nombre plus petit (-1 à 1). Si on avait 
un facteurDeFuite avec lequel multiplier Z avant de diviser X et Y, on pourrait ajuster cette réduction avec la distance...</p>
<p>Essayons ça. Changeons notre shader de vertex pour diviser par Z après avoir multiplié par notre facteurDeFuite.</p>
<pre class="prettyprint showlinemods">
&lt;script id="shader-de-vertex-2d" type="x-shader/x-vertex"&gt;
...
uniform float u_facteurDeFuite;
...
void main() {
  // Multiplie la position par la matrice
  vec4 position = u_matrice * a_position;

  // ajuste le z avec le facteur
  float zDeDivision = 1.0 + position.z * u_facteurDeFuite;

  // Divise x et y par z.
  gl_Position = vec4(position.xy / zDeDivision, position.zw);
}
&lt;/script&gt;
</pre>

<p>Le Z de l&#39;espace de projection va de -1 à +1. J&#39;ai ajouté 1 pour que <code class="notranslate" translate="no">zDeDivision</code> aille de 0 à +2 * facteurDeFuite</p>
<p>On doit aussi renseigner ce facteurDeFuite dans le programme javascript</p>
<pre class="prettyprint showlinemods">
  ...
  var emplacementFacteur = gl.getUniformLocation(programme, "u_facteurDeFuite");

  ...
  var facteurDeFuite = 1;
  ...
  function rendreScene() {
    ...
    // Transmets la valeur du facteurDeFuite au programme en cours
    gl.uniform1f(emplacementFacteur, facteurDeFuite);

    // Appel de rendu
    gl.drawArrays(gl.TRIANGLES, 0, 16 * 6);
</pre>

<p>Résultat :</p>
<p><div class="webgl_example_container">
  <iframe class="webgl_example" style=" " src="/webgl/resources/editor.html?url=/webgl/lessons/..%2Fwebgl-3d-perspective.html"></iframe>
  <a class="webgl_center" href="/webgl/lessons/../webgl-3d-perspective.html" target="_blank">Cliquer ici pour ouvrir dans une nouvelle fenêtre</a>
</div>

</p>
<p>Si ce n&#39;est pas clair la valeur du &quot;facteurDeFuite&quot; peut être changée entre 1 et 0 sur le slider pour voir comment les choses étaient avant d&#39;appliquer notre division par Z, c&#39;est-à-dire en orthographique.</p>
<p><img class="webgl_center" src="../resources/orthographic-vs-perspective.png" /></p>
<div class="webgl_center">orthographique vs perspective</div>

<p>Il se trouve que WebGL prend les valeurs x, y, z, w assignées à gl_Position dans notre shader de vertex 
et divise par w automatiquement. </p>
<p>On peut le constater facilement en changeant le shader, et au lieu de faire la division nous-même, mettre 
<code class="notranslate" translate="no">zDeDivision</code> dans <code class="notranslate" translate="no">gl_Position.w</code>.</p>
<pre class="prettyprint showlinemods">
&lt;script id="shader-de-vertex-2d" type="x-shader/x-vertex"&gt;
...
uniform float u_facteurDeFuite;
...
void main() {
  // Multiplie la position par la matrice
  vec4 position = u_matrice * a_position;

  // Adjust the z to divide by
  float zDeDivision = 1.0 + position.z * u_facteurDeFuite;

  // Divise x, y et z par zDeDivision
  gl_Position = vec4(position.xyz,  zDeDivision);
}
&lt;/script&gt;
</pre>

<p>et c&#39;est exactement pareil</p>
<p><div class="webgl_example_container">
  <iframe class="webgl_example" style=" " src="/webgl/resources/editor.html?url=/webgl/lessons/..%2Fwebgl-3d-perspective-w.html"></iframe>
  <a class="webgl_center" href="/webgl/lessons/../webgl-3d-perspective-w.html" target="_blank">Cliquer ici pour ouvrir dans une nouvelle fenêtre</a>
</div>

</p>
<p>Pourquoi WebGL divise automatiquement par w ? Parce que maintenant, avec un peu plus de magie des matrices, 
on peut utiliser une autre matrice pour copier z dans w. Une matrice comme ça :</p>
<div class="webgl_math_center"><pre class="webgl_math">
1, 0, 0, 0,
0, 1, 0, 0,
0, 0, 1, 1,
0, 0, 0, 0,
</pre></div>

<p>Chaque colonne peut être vue comme :</p>
<div class="webgl_math_center"><pre class="webgl_math">
nouveauX = x * 1 +
           y * 0 +
           z * 0 +
           w * 0 ;

nouveauY = x * 0 +
           y * 1 +
           z * 0 +
           w * 0 ;

nouveauZ = x * 0 +
           y * 0 +
           z * 1 +
           w * 0 ;

nouveauW = x * 0 +
           y * 0 +
           z * 1 +
           w * 0 ;
</pre></div>

<p>ce qui simplifié, donne :</p>
<div class="webgl_math_center"><pre class="webgl_math">
nouveauX = x;
nouveauY = y;
nouveauZ = z;
nouveauW = z;
</pre></div>

<p>On peut ajouter le &#39;plus 1&#39; qu&#39;on avait avant dans cette matrice puisqu&#39;on sait que le w est toujours 1</p>
<div class="webgl_math_center"><pre class="webgl_math">
1, 0, 0, 0,
0, 1, 0, 0,
0, 0, 1, 1,
0, 0, 0, 1,
</pre></div>

<p>ce qui change nouveauW</p>
<div class="webgl_math_center"><pre class="webgl_math">
nouveauW = x * 0 +
           y * 0 +
           z * 1 +
           w * 1 ;
</pre></div>

<p>et puisque <code class="notranslate" translate="no">w</code> = 1 c&#39;est en fait</p>
<div class="webgl_math_center"><pre class="webgl_math">
nouveauW = z + 1;
</pre></div>

<p>Finalement on peut ramener notre facteurDeFuite dans la matrice</p>
<div class="webgl_math_center"><pre class="webgl_math">
1, 0, 0, 0,
0, 1, 0, 0,
0, 0, 1, facteurDeFuite,
0, 0, 0, 1,
</pre></div>

<p>ce qui donne</p>
<div class="webgl_math_center"><pre class="webgl_math">
nouveauW = x * 0 +
           y * 0 +
           z * facteurDeFuite +
           w * 1 ;
</pre></div>

<p>c&#39;est-à-dire</p>
<div class="webgl_math_center"><pre class="webgl_math">
nouveauW = z * facteurDeFuite + 1;
</pre></div>

<p>Modifions le programme pour utiliser ces matrices.</p>
<p>Ramenons le shader de vertex. C&#39;est toujours la version simple</p>
<pre class="prettyprint showlinemods">
&lt;script id="shader-de-vertex-2d" type="x-shader/x-vertex"&gt;
uniform mat4 u_matrice;

void main() {
  // Multiplie la position par la matrice
  gl_Position = u_matrice * a_position;
  ...
}
&lt;/script&gt;
</pre>

<p>Maintenant écrivons la fonction qui retourne une matrice où notre facteur passe dans W. </p>
<pre class="prettyprint showlinemods">
function matriceZversW(facteurDeFuite) {
  return [
    1, 0, 0, 0,
    0, 1, 0, 0,
    0, 0, 1, facteurDeFuite,
    0, 0, 0, 1,
  ];
}
</pre>

<p>et on change le code pour l&#39;utiliser</p>
<pre class="prettyprint showlinemods">
    ...
    // Calcule les matrices
    var matriceFuite =
        matriceZversW(facteurDeFuite);

    ...

    // Multiplie les matrices
    var matrice = multiplierMatrices(matriceEchelle, rotationZMatrix);
    matrice = multiplierMatrices(matrice, matriceRotationY);
    matrice = multiplierMatrices(matrice, matriceRotationX);
    matrice = multiplierMatrices(matrice, matriceDeplacement);
    matrice = multiplierMatrices(matrice, matriceProjection);
    matrice = multiplierMatrices(matrice, matriceFuite);

    ...
</pre>

<p>Le résultat est toujours identique</p>
<p><div class="webgl_example_container">
  <iframe class="webgl_example" style=" " src="/webgl/resources/editor.html?url=/webgl/lessons/..%2Fwebgl-3d-perspective-w-matrix.html"></iframe>
  <a class="webgl_center" href="/webgl/lessons/../webgl-3d-perspective-w-matrix.html" target="_blank">Cliquer ici pour ouvrir dans une nouvelle fenêtre</a>
</div>

</p>
<p>Tout ça pour montrer que diviser par Z donne la perspective et que WebGL fait ça automatiquement.</p>
<p>Mais il reste quelques soucis. Si on met Z à -100 on se retrouve avec quelque chose comme l&#39;animation ci-dessous</p>
<p><img class="webgl_center" src="../resources/z-clipping.gif" style="border: 1px solid black;" /></p>
<p>Quest-ce qu&#39;il se passe ? Pourquoi le F disparaît ? Tout comme WebGL tronque le X et le Y au-delà de -1 et +1 il tronque aussi le Z. 
Ce qu&#39;on voit c&#39;est le Z &lt; -1. </p>
<p>Je pourrais entrer dans les détails pour résoudre ça mais <a href="https://stackoverflow.com/a/28301213/128511">vous pouvez déduire la solution</a> comme on l&#39;a fait dans les projections 2D. On a besoin de prendre Z, ajouter du déplacement et du changement d&#39;échelle, et on peut ajuster tout ce qu&#39;on veut entre -1 et +1. </p>
<p>Ce qui est génial c&#39;est que tout ça peut être fusionné dans une seule matrice ! Mieux, plutôt qu&#39;un &#39;facteur de fuite&#39; on va plutôt prendre en entrée l&#39;angle du champ de vision désiré et calculer le reste à partir de ça. </p>
<p>Voilà la fonction (champ de vision se dit field of view en anglais et son abréviation FOV est assez répendue dans le langage technique de différents domaines).</p>
<pre class="prettyprint showlinemods">
function projeterPerspective(FOVenRadians, aspect, limiteProche, limiteLoin) {
  var f = Math.tan(Math.PI * 0.5 - 0.5 * FOVenRadians);
  var portee = 1.0 / (limiteProche - limiteLoin);

  return [
    f / aspect, 0, 0, 0,
    0, f, 0, 0,
    0, 0, (limiteProche + limiteLoin) * portee, -1,
    0, 0, limiteProche * limiteLoin * portee * 2, 0
  ];
};
</pre>

<p>Cette matrice va faire les conversions pour nous. Elle va ajuster les coordonnées dans l&#39;espace de projection, elle va faire les opérations pour qu&#39;on choisisse le FOV qu&#39;on veut, et nous laisse choisir nos limites proche et lointaine. C&#39;est comme s&#39;il y avait un <em>oeil</em> ou une <em>caméra</em> à l&#39;origine (0,0,0) et à partir des valeurs d&#39;entrée elle calculait la matrice nécessaire pour que ce qui est proche du plan proche soit à <code class="notranslate" translate="no">z = -1</code> dans l&#39;espace de projection, que ce qui est proche du plan lointain se retrouve à <code class="notranslate" translate="no">z = 1</code>, et que ce qui est sur la plan proche à la moitié de la valeur FOV au-dessus ou au-dessous du centre se retrouve à <code class="notranslate" translate="no">Y = -1</code> et <code class="notranslate" translate="no">Y = 1</code> respectivement. Elle déduit la valeur de X en multipliant par la valeur <code class="notranslate" translate="no">aspect</code>. L&#39;aspect est généralement trouvé par le rapport <code class="notranslate" translate="no">largeur / hauteur</code> de la zone d&#39;affichage. Finalement, elle déduit comment changer l&#39;échelle des objets avec Z pour que les objets loitains finissent à <code class="notranslate" translate="no">Z = 1</code>.</p>
<p>Voilà un diagramme de la matrice en action</p>
<p><div class="webgl_example_container">
  <iframe class="webgl_example" style="width:  400px; height: 600px;" src="/webgl/resources/editor.html?url=/webgl/lessons/..%2Ffrustum-diagram.html"></iframe>
  <a class="webgl_center" href="/webgl/lessons/../frustum-diagram.html" target="_blank">Cliquer ici pour ouvrir dans une nouvelle fenêtre</a>
</div>

</p>
<p>Cette forme qui ressemble à un cône à quatre faces, dans lequel les cubes tournent, s&#39;appelle un &quot;frustum&quot; (en géométrie et en français la traduction est &quot;tronc&quot;, mais elle n&#39;est pas utilisée dans le langage de la 3D). C&#39;est en fait ce volume qui forme l&#39;espace de projection et à partir duquel la matrice fait ses calculs. Le plan proche définit la distance avec la caméra en-dessous de laquelle les objets seront tronqués, le plan loitain définit la distance au-delà de laquelle ils seront également tronqués (pratique car notre tampon de profondeur ne peut pas prendre de valeurs infinies). Mettez &#39;23&#39; pour la limite proche (zNear) et vous verrez le devant des cubes tronqué. Mettez &#39;24&#39; à la limite lointaine (zFar) et vous verrez l&#39;arrière des cubes disparaître.</p>
<p>Il reste un dernier problème. Cette matrice suppose qu&#39;il y a un observateur à (0,0,0) qui regarde dans la direction négative de l&#39;axe Z, et que l&#39;axe Y pointe vers le haut. Jusque là nos matrices ont fait des choses différentes. Pour que ça marche on doit placer les objets devant l&#39;observateur. </p>
<p>On pourrait faire ça en déplaçant le F. On le dessinait à (45,150,0). Déplaçons-le à (-150,0,-360).</p>
<p>Maintenant on doit juste remplacer notre appel à projection2D par un appel à projeterPerspective</p>
<pre class="prettyprint showlinemods">
    var aspect = canvas.clientWidth / canvas.clientHeight;
    var matriceProjection =
        projeterPerspective(FOVenRadians, aspect, 1, 2000);
    var matriceDeplacement =
        deplacer(deplacement[0], deplacement[1], deplacement[2]);
    var matriceRotationX = tournerX(rotation[0]);
    var matriceRotationY = tournerY(rotation[1]);
    var matriceRotationZ = tournerZ(rotation[2]);
    var matriceEchelle = changerEchelle(echelle[0], echelle[1], echelle[2]);
</pre>

<p>Voilà !</p>
<p><div class="webgl_example_container">
  <iframe class="webgl_example" style=" " src="/webgl/resources/editor.html?url=/webgl/lessons/..%2Fwebgl-3d-perspective-matrix.html"></iframe>
  <a class="webgl_center" href="/webgl/lessons/../webgl-3d-perspective-matrix.html" target="_blank">Cliquer ici pour ouvrir dans une nouvelle fenêtre</a>
</div>

</p>
<p>Reste à multiplier les matrices et on a de quoi choisir la taille de notre champ de vision et nos limites de profondeur. 
On n&#39;en a pas encore fini mais cet article devient long. La suite : <a href="webgl-3d-camera.html">les caméras</a>.</p>
<div class="webgl_bottombar">
<h3>Pourquoi est-ce qu'on a mis le F si loin en Z (-360) ?</h3>
<p>
Dans les autres exemples le F était à (45, 150, 0) mais dans le dernier il a été placé à (-150, 0, -360).
Pourquoi ? </p>
<p>La raison est que jusqu'à notre dernier exemple notre fonction `projeter2D` permettait de passer de l'espace de pixel à l'espace de projection. Ca signifie que l'aire d'affichage était de 400x300 pixels. Mais utiliser cette taille en pixel n'a pas de sens en 3D. La nouvelle fonction utilise un frustum dont le plan proche à `zNear` est de 2 unités de haut et 2 * aspect unités de large. Puisque notre 'F' fait 150 unités et que vers le plan proche on ne peut voir qu'environ 2 unités de large, il fallait le placer beaucoup plus loin de l'origine pour le voir entièrement.</p>
<p>De même on a bougé 'X' de 45 à -150 : la vue précédente allait de 0 à 400. Maintenant elle va de -1 à +1.
</p>
</div>



    </div>
    <div class="lesson-sidebar">
        <select class="language">
    <option value="/webgl/lessons/webgl-3d-perspective.html" >English</a>
    <option value="/webgl/lessons/fr/webgl-3d-perspective.html" selected>Français</a>
    <option value="/webgl/lessons/ja/webgl-3d-perspective.html" >日本語</a>
    <option value="/webgl/lessons/ko/webgl-3d-perspective.html" >한국어</a>
    <option value="/webgl/lessons/pl/webgl-3d-perspective.html" >Polski</a>
    <option value="/webgl/lessons/pt-br/webgl-3d-perspective.html" >Portuguese</a>
    <option value="/webgl/lessons/ru/webgl-3d-perspective.html" >Русский</a>
    <option value="/webgl/lessons/zh_cn/webgl-3d-perspective.html" >简体中文</a>
</select>


        <div id="toc">
          <ul>  <li>Les bases</li>
        <ul>
          <li><a href="/webgl/lessons/fr/webgl-fundamentals.html">WebGL - Les bases</a></li>
<li><a href="/webgl/lessons/fr/webgl-how-it-works.html">WebGL - Comment ça marche</a></li>
<li><a href="/webgl/lessons/fr/webgl-shaders-and-glsl.html">WebGL - Shaders et GLSL</a></li>
<li><a href="/webgl/lessons/resources/webgl-state-diagram.html">WebGL State Diagram</a></li>
        </ul>
  <li>Traitement d'image</li>
        <ul>
          <li><a href="/webgl/lessons/fr/webgl-image-processing.html">Image Processing</a></li>
<li><a href="/webgl/lessons/fr/webgl-image-processing-continued.html">Image Processing Continued</a></li>
        </ul>
  <li>2D : translation, rotation, échelle, matrices</li>
        <ul>
          <li><a href="/webgl/lessons/fr/webgl-2d-translation.html">WebGL 2D - Translation</a></li>
<li><a href="/webgl/lessons/fr/webgl-2d-rotation.html">WebGL 2D - Rotation</a></li>
<li><a href="/webgl/lessons/fr/webgl-2d-scale.html">WebGL 2D - Echelle</a></li>
<li><a href="/webgl/lessons/fr/webgl-2d-matrices.html">WebGL 2D - Matrices</a></li>
        </ul>
  <li>3D</li>
        <ul>
          <li><a href="/webgl/lessons/fr/webgl-3d-orthographic.html">WebGL 3D - Projection orthographique</a></li>
<li><a href="/webgl/lessons/fr/webgl-3d-perspective.html">WebGL 3D - La perspective</a></li>
<li><a href="/webgl/lessons/fr/webgl-3d-camera.html">WebGL 3D - Les caméras</a></li>
        </ul>
  <li>Lumières</li>
        <ul>
          <li><a href="/webgl/lessons/fr/webgl-3d-lighting-directional.html">WebGL 3D - Lumière directionnelle</a></li>
<li><a href="/webgl/lessons/fr/webgl-3d-lighting-point.html">WebGL 3D - Lumière-point</a></li>
<li><a href="/webgl/lessons/fr/webgl-3d-lighting-spot.html">Spot Lighting</a></li>
        </ul>
  <li>Structure et Organisation</li>
        <ul>
          <li><a href="/webgl/lessons/fr/webgl-less-code-more-fun.html">Less Code, More Fun</a></li>
<li><a href="/webgl/lessons/fr/webgl-drawing-multiple-things.html">Drawing Multiple Things</a></li>
<li><a href="/webgl/lessons/fr/webgl-scene-graph.html">WebGL - Graphes de scène</a></li>
        </ul>
  <li>Geometry</li>
        <ul>
          <li><a href="/webgl/lessons/fr/webgl-3d-geometry-lathe.html">Geometry - Lathe</a></li>
<li><a href="/webgl/lessons/fr/webgl-load-obj.html">Loading .obj files</a></li>
<li><a href="/webgl/lessons/fr/webgl-load-obj-w-mtl.html">Loading .obj w .mtl files</a></li>
        </ul>
  <li>Divers</li>
        <ul>
          <li><a href="/webgl/lessons/fr/webgl-3d-textures.html">Textures</a></li>
<li><a href="/webgl/lessons/fr/webgl-data-textures.html">Data Textures</a></li>
<li><a href="/webgl/lessons/fr/webgl-2-textures.html">Using 2 or More Textures</a></li>
<li><a href="/webgl/lessons/fr/webgl-cors-permission.html">Cross Origin Images</a></li>
<li><a href="/webgl/lessons/fr/webgl-3d-perspective-correct-texturemapping.html">Perspective Correct Texture Mapping</a></li>
<li><a href="/webgl/lessons/fr/webgl-planar-projection-mapping.html">Planar and Perspective Projection Mapping</a></li>
        </ul>
  <li>Rendering To A Texture</li>
        <ul>
          <li><a href="/webgl/lessons/fr/webgl-render-to-texture.html">Render to Texture</a></li>
        </ul>
  <li>Shadows</li>
        <ul>
          <li><a href="/webgl/lessons/fr/webgl-shadows.html">Shadows</a></li>
        </ul>
  <li>Techniques</li>
        <ul>
            <li>2D</li>
        <ul>
          <li><a href="/webgl/lessons/fr/webgl-2d-drawimage.html">2D - DrawImage</a></li>
<li><a href="/webgl/lessons/fr/webgl-2d-matrix-stack.html">2D - Matrix Stack</a></li>
<li><a href="/webgl/lessons/fr/webgl-sprites.html">Sprites</a></li>
        </ul>
  <li>3D</li>
        <ul>
          <li><a href="/webgl/lessons/fr/webgl-cube-maps.html">Cubemaps</a></li>
<li><a href="/webgl/lessons/fr/webgl-environment-maps.html">Environment maps</a></li>
<li><a href="/webgl/lessons/fr/webgl-skybox.html">Skyboxes</a></li>
<li><a href="/webgl/lessons/fr/webgl-skinning.html">Skinning</a></li>
<li><a href="/webgl/lessons/fr/webgl-fog.html">Fog</a></li>
<li><a href="/webgl/lessons/fr/webgl-picking.html">Picking (clicking on stuff)</a></li>
        </ul>
  <li>Texte</li>
        <ul>
          <li><a href="/webgl/lessons/fr/webgl-text-html.html">Text - HTML</a></li>
<li><a href="/webgl/lessons/fr/webgl-text-canvas2d.html">Text - Canvas 2D</a></li>
<li><a href="/webgl/lessons/fr/webgl-text-texture.html">Text - Using a Texture</a></li>
<li><a href="/webgl/lessons/fr/webgl-text-glyphs.html">Text - Using a Glyph Texture</a></li>
        </ul>
  <li>Divers</li>
        <ul>
          <li><a href="/webgl/lessons/fr/webgl-ramp-textures.html">Ramp Textures (Toon Shading)</a></li>
        </ul>
  <li>GPGPU</li>
        <ul>
          <li><a href="/webgl/lessons/fr/webgl-gpgpu.html">GPGPU</a></li>
        </ul>
        </ul>
  <li>Tips</li>
        <ul>
          <li><a href="/webgl/lessons/fr/webgl-smallest-programs.html">Smallest Programs</a></li>
<li><a href="/webgl/lessons/fr/webgl-drawing-without-data.html">Drawing Without Data</a></li>
<li><a href="/webgl/lessons/fr/webgl-shadertoy.html">Shadertoy</a></li>
<li><a href="/webgl/lessons/fr/webgl-pulling-vertices.html">Pulling Vertices</a></li>
        </ul>
  <li>Optimization</li>
        <ul>
          <li><a href="/webgl/lessons/fr/webgl-indexed-vertices.html">Indexed Vertices (gl.drawElements)</a></li>
<li><a href="/webgl/lessons/fr/webgl-instanced-drawing.html">Instanced Drawing</a></li>
        </ul>
  <li>Divers</li>
        <ul>
          <li><a href="/webgl/lessons/fr/webgl-setup-and-installation.html">Setup And Installation</a></li>
<li><a href="/webgl/lessons/fr/webgl-boilerplate.html">Boilerplate</a></li>
<li><a href="/webgl/lessons/fr/webgl-resizing-the-canvas.html">Resizing the Canvas</a></li>
<li><a href="/webgl/lessons/fr/webgl-animation.html">Animation</a></li>
<li><a href="/webgl/lessons/fr/webgl-points-lines-triangles.html">Points, Lines, and Triangles</a></li>
<li><a href="/webgl/lessons/fr/webgl-multiple-views.html">Multiple Views, Multiple Canvases</a></li>
<li><a href="/webgl/lessons/fr/webgl-visualizing-the-camera.html">Visualizing the Camera</a></li>
<li><a href="/webgl/lessons/fr/webgl-and-alpha.html">WebGL and Alpha</a></li>
<li><a href="/webgl/lessons/fr/webgl-2d-vs-3d-library.html">2D vs 3D libraries</a></li>
<li><a href="/webgl/lessons/fr/webgl-anti-patterns.html">Anti-Patterns</a></li>
<li><a href="/webgl/lessons/fr/webgl-matrix-vs-math.html">WebGL Matrices vs Math Matrices</a></li>
<li><a href="/webgl/lessons/fr/webgl-precision-issues.html">Precision Issues</a></li>
<li><a href="/webgl/lessons/fr/webgl-tips.html#screenshot">Taking a screenshot</a></li>
<li><a href="/webgl/lessons/fr/webgl-tips.html#preservedrawingbuffer">Prevent the Canvas Being Cleared</a></li>
<li><a href="/webgl/lessons/fr/webgl-tips.html#tabindex">Get Keyboard Input From a Canvas</a></li>
<li><a href="/webgl/lessons/fr/webgl-tips.html#html-background">Use WebGL as Background in HTML</a></li>
<li><a href="/webgl/lessons/fr/webgl-cross-platform-issues.html">Cross Platform Issues</a></li>
<li><a href="/webgl/lessons/fr/webgl-qna.html">Questions and Answers</a></li>
        </ul>
  <li>Reference</li>
        <ul>
          <li><a href="/webgl/lessons/fr/webgl-attributes.html">Attributes</a></li>
<li><a href="/webgl/lessons/fr/webgl-texture-units.html">Texture Units</a></li>
<li><a href="/webgl/lessons/fr/webgl-readpixels.html">readPixels</a></li>
<li><a href="/webgl/lessons/fr/webgl-references.html">References</a></li>
        </ul></ul>
<ul>
  <li><a href="/docs/">Aide pour la doc de l'API</a></li>
  <li><a href="https://twgljs.org">TWGL, une librairie de base pour WebGL</a></li>
  <li><a href="https://github.com/gfxfundamentals/webgl-fundamentals">Github</a></li>
</ul>
        </div>
    </div>
    <div class="lesson-comments">
        <div>Une question ? <a href="https://stackoverflow.com/questions/tagged/webgl">Demander sur stackoverflow</a>.</div>
        <div>Un problème ? <a href="https://github.com/vinci-mz/webgl-fundamentals/issues">Signaler sur github</a>.</div>

        <div id="disqus_thread"></div>
        <script>
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'webglfundamentals'; // required: replace example with your forum shortname
            var disqus_identifier = 'WebGL - La perspective';
            var disqus_title = 'WebGL - La perspective';

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                if (window.location.hostname.indexOf("webglfundamentals.org") < 0) {
                    return;
                }
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
  </div>
</div>
</body>
<script src="/3rdparty/jquery-1.11.2.min.js"></script>
<script src="/webgl/lessons/resources/prettify.js"></script>
<script src="/webgl/lessons/resources/lesson.js"></script>
<script>
(function() {
  if (window.location.hostname.indexOf("webglfundamentals.org") < 0) {
      return;
  }

  function addScript(src, fn) {
    const script = document.createElement('script');
    const firstScript = document.getElementsByTagName('script')[0];
    script.async = true;
    script.defer = true;
    if (fn) {
      script.addEventListener('load', fn);
    }
    script.src = src;
    firstScript.parentNode.insertBefore(script, firstScript);
  }

  addScript('//cdn.webglstats.com/stat.js');

  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59804936-1', 'auto');
  ga('send', 'pageview');
}());
</script>


</html>



